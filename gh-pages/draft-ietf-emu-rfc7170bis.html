<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Tunnel Extensible Authentication Protocol (TEAP) Version 1</title>
<meta content="Alan DeKok" name="author">
<meta content="Hao Zhou" name="author">
<meta content="Joseph Salowey" name="author">
<meta content="Nancy Cam-Winget" name="author">
<meta content="Stephen Hanna" name="author">
<meta content="
       This document defines the Tunnel Extensible Authentication Protocol
(TEAP) version 1.  TEAP is a tunnel-based EAP method that enables
secure communication between a peer and a server by using the
Transport Layer Security (TLS) protocol to establish a mutually
authenticated tunnel.  Within the tunnel, TLV objects are used to
convey authentication-related data between the EAP peer and the EAP
server.  This document obsoletes RFC 7170. 
    " name="description">
<meta content="xml2rfc 3.15.3" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-emu-rfc7170bis-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.15.3
    Python 3.10.9
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.2
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.1
    setuptools 65.6.0
    six 1.16.0
    wcwidth 0.2.5
-->
<link href="draft-ietf-emu-rfc7170bis.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl > dt {
  float: left;
  margin-right: 1em;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: 14.5px;
}
.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 8em !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">TEAP</td>
<td class="right">January 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">DeKok (Ed), et al.</td>
<td class="center">Expires 21 July 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">EMU working group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-emu-rfc7170bis-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-01-17" class="published">17 January 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-07-21">21 July 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. DeKok (Ed)</div>
</div>
<div class="author">
      <div class="author-name">H. Zhou</div>
</div>
<div class="author">
      <div class="author-name">J. Salowey</div>
</div>
<div class="author">
      <div class="author-name">N. Cam-Winget</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">S. Hanna</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Tunnel Extensible Authentication Protocol (TEAP) Version 1</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines the Tunnel Extensible Authentication Protocol
(TEAP) version 1.  TEAP is a tunnel-based EAP method that enables
secure communication between a peer and a server by using the
Transport Layer Security (TLS) protocol to establish a mutually
authenticated tunnel.  Within the tunnel, TLV objects are used to
convey authentication-related data between the EAP peer and the EAP
server.  This document obsoletes RFC 7170.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-emu-rfc7170bis/">https://datatracker.ietf.org/doc/draft-ietf-emu-rfc7170bis/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        EMU Working Group mailing list (<span><a href="mailto:emu@ietf.org">mailto:emu@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/emu/">https://mailarchive.ietf.org/arch/browse/emu/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/emu/">https://www.ietf.org/mailman/listinfo/emu/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/emu-wg/rfc7170bis.git">https://github.com/emu-wg/rfc7170bis.git</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 21 July 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-specification-requirements" class="internal xref">Specification Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-architectural-model" class="internal xref">Architectural Model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-protocol-layering-model" class="internal xref">Protocol-Layering Model</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-teap-protocol" class="internal xref">TEAP Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-version-negotiation" class="internal xref">Version Negotiation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-teap-authentication-phase-1" class="internal xref">TEAP Authentication Phase 1: Tunnel Establishment</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-tls-session-resume-using-se" class="internal xref">TLS Session Resume Using Server State</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-tls-session-resume-using-a-" class="internal xref">TLS Session Resume Using a PAC</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="auto internal xref">3.2.3</a>.  <a href="#name-transition-between-abbrevia" class="internal xref">Transition between Abbreviated and Full TLS Handshake</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-teap-authentication-phase-2" class="internal xref">TEAP Authentication Phase 2: Tunneled Authentication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-inner-eap-authentication" class="internal xref">Inner EAP Authentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-inner-password-authenticati" class="internal xref">Inner Password Authentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#section-3.3.3" class="auto internal xref">3.3.3</a>.  <a href="#name-eap-mschapv2" class="internal xref">EAP-MSCHAPv2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.4">
                    <p id="section-toc.1-1.3.2.3.2.4.1"><a href="#section-3.3.4" class="auto internal xref">3.3.4</a>.  <a href="#name-protected-termination-and-a" class="internal xref">Protected Termination and Acknowledged Result Indication</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-determining-peer-id-and-ser" class="internal xref">Determining Peer-Id and Server-Id</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-teap-session-identifier" class="internal xref">TEAP Session Identifier</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-error-handling" class="internal xref">Error Handling</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.1">
                    <p id="section-toc.1-1.3.2.6.2.1.1"><a href="#section-3.6.1" class="auto internal xref">3.6.1</a>.  <a href="#name-outer-layer-errors" class="internal xref">Outer-Layer Errors</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.2">
                    <p id="section-toc.1-1.3.2.6.2.2.1"><a href="#section-3.6.2" class="auto internal xref">3.6.2</a>.  <a href="#name-tls-layer-errors" class="internal xref">TLS Layer Errors</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.3">
                    <p id="section-toc.1-1.3.2.6.2.3.1"><a href="#section-3.6.3" class="auto internal xref">3.6.3</a>.  <a href="#name-phase-2-errors" class="internal xref">Phase 2 Errors</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="auto internal xref">3.7</a>.  <a href="#name-fragmentation" class="internal xref">Fragmentation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="auto internal xref">3.8</a>.  <a href="#name-peer-services" class="internal xref">Peer Services</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8.2.1">
                    <p id="section-toc.1-1.3.2.8.2.1.1"><a href="#section-3.8.1" class="auto internal xref">3.8.1</a>.  <a href="#name-pac-provisioning" class="internal xref">PAC Provisioning</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8.2.2">
                    <p id="section-toc.1-1.3.2.8.2.2.1"><a href="#section-3.8.2" class="auto internal xref">3.8.2</a>.  <a href="#name-certificate-provisioning-wi" class="internal xref">Certificate Provisioning within the Tunnel</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8.2.3">
                    <p id="section-toc.1-1.3.2.8.2.3.1"><a href="#section-3.8.3" class="auto internal xref">3.8.3</a>.  <a href="#name-server-unauthenticated-prov" class="internal xref">Server Unauthenticated Provisioning Mode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8.2.4">
                    <p id="section-toc.1-1.3.2.8.2.4.1"><a href="#section-3.8.4" class="auto internal xref">3.8.4</a>.  <a href="#name-channel-binding" class="internal xref">Channel Binding</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-message-formats" class="internal xref">Message Formats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-teap-message-format" class="internal xref">TEAP Message Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-teap-tlv-format-and-support" class="internal xref">TEAP TLV Format and Support</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-general-tlv-format" class="internal xref">General TLV Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-authority-id-tlv" class="internal xref">Authority-ID TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="auto internal xref">4.2.3</a>.  <a href="#name-identity-type-tlv" class="internal xref">Identity-Type TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.4">
                    <p id="section-toc.1-1.4.2.2.2.4.1"><a href="#section-4.2.4" class="auto internal xref">4.2.4</a>.  <a href="#name-result-tlv" class="internal xref">Result TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.5">
                    <p id="section-toc.1-1.4.2.2.2.5.1"><a href="#section-4.2.5" class="auto internal xref">4.2.5</a>.  <a href="#name-nak-tlv" class="internal xref">NAK TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.6">
                    <p id="section-toc.1-1.4.2.2.2.6.1"><a href="#section-4.2.6" class="auto internal xref">4.2.6</a>.  <a href="#name-error-tlv" class="internal xref">Error TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.7">
                    <p id="section-toc.1-1.4.2.2.2.7.1"><a href="#section-4.2.7" class="auto internal xref">4.2.7</a>.  <a href="#name-channel-binding-tlv" class="internal xref">Channel-Binding TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.8">
                    <p id="section-toc.1-1.4.2.2.2.8.1"><a href="#section-4.2.8" class="auto internal xref">4.2.8</a>.  <a href="#name-vendor-specific-tlv" class="internal xref">Vendor-Specific TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.9">
                    <p id="section-toc.1-1.4.2.2.2.9.1"><a href="#section-4.2.9" class="auto internal xref">4.2.9</a>.  <a href="#name-request-action-tlv" class="internal xref">Request-Action TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.10">
                    <p id="section-toc.1-1.4.2.2.2.10.1"><a href="#section-4.2.10" class="auto internal xref">4.2.10</a>. <a href="#name-eap-payload-tlv" class="internal xref">EAP-Payload TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.11">
                    <p id="section-toc.1-1.4.2.2.2.11.1"><a href="#section-4.2.11" class="auto internal xref">4.2.11</a>. <a href="#name-intermediate-result-tlv" class="internal xref">Intermediate-Result TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.12">
                    <p id="section-toc.1-1.4.2.2.2.12.1"><a href="#section-4.2.12" class="auto internal xref">4.2.12</a>. <a href="#name-pac-tlv-format" class="internal xref">PAC TLV Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.13">
                    <p id="section-toc.1-1.4.2.2.2.13.1"><a href="#section-4.2.13" class="auto internal xref">4.2.13</a>. <a href="#name-crypto-binding-tlv" class="internal xref">Crypto-Binding TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.14">
                    <p id="section-toc.1-1.4.2.2.2.14.1"><a href="#section-4.2.14" class="auto internal xref">4.2.14</a>. <a href="#name-basic-password-auth-req-tlv" class="internal xref">Basic-Password-Auth-Req TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.15">
                    <p id="section-toc.1-1.4.2.2.2.15.1"><a href="#section-4.2.15" class="auto internal xref">4.2.15</a>. <a href="#name-basic-password-auth-resp-tl" class="internal xref">Basic-Password-Auth-Resp TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.16">
                    <p id="section-toc.1-1.4.2.2.2.16.1"><a href="#section-4.2.16" class="auto internal xref">4.2.16</a>. <a href="#name-pkcs7-tlv" class="internal xref">PKCS#7 TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.17">
                    <p id="section-toc.1-1.4.2.2.2.17.1"><a href="#section-4.2.17" class="auto internal xref">4.2.17</a>. <a href="#name-pkcs10-tlv" class="internal xref">PKCS#10 TLV</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.18">
                    <p id="section-toc.1-1.4.2.2.2.18.1"><a href="#section-4.2.18" class="auto internal xref">4.2.18</a>. <a href="#name-trusted-server-root-tlv" class="internal xref">Trusted-Server-Root TLV</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-tlv-rules" class="internal xref">TLV Rules</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-outer-tlvs" class="internal xref">Outer TLVs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="auto internal xref">4.3.2</a>.  <a href="#name-inner-tlvs" class="internal xref">Inner TLVs</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-cryptographic-calculations" class="internal xref">Cryptographic Calculations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-teap-authentication-phase-1-" class="internal xref">TEAP Authentication Phase 1: Key Derivations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-intermediate-compound-key-d" class="internal xref">Intermediate Compound Key Derivations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-computing-the-compound-mac" class="internal xref">Computing the Compound MAC</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-eap-master-session-key-gene" class="internal xref">EAP Master Session Key Generation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-mutual-authentication-and-i" class="internal xref">Mutual Authentication and Integrity Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-method-negotiation" class="internal xref">Method Negotiation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-separation-of-phase-1-and-p" class="internal xref">Separation of Phase 1 and Phase 2 Servers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-mitigation-of-known-vulnera" class="internal xref">Mitigation of Known Vulnerabilities and Protocol Deficiencies</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.1">
                    <p id="section-toc.1-1.7.2.4.2.1.1"><a href="#section-7.4.1" class="auto internal xref">7.4.1</a>.  <a href="#name-user-identity-protection-an" class="internal xref">User Identity Protection and Verification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.2">
                    <p id="section-toc.1-1.7.2.4.2.2.1"><a href="#section-7.4.2" class="auto internal xref">7.4.2</a>.  <a href="#name-dictionary-attack-resistanc" class="internal xref">Dictionary Attack Resistance</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.3">
                    <p id="section-toc.1-1.7.2.4.2.3.1"><a href="#section-7.4.3" class="auto internal xref">7.4.3</a>.  <a href="#name-protection-against-man-in-t" class="internal xref">Protection against Man-in-the-Middle Attacks</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.4">
                    <p id="section-toc.1-1.7.2.4.2.4.1"><a href="#section-7.4.4" class="auto internal xref">7.4.4</a>.  <a href="#name-pac-binding-to-user-identit" class="internal xref">PAC Binding to User Identity</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-protecting-against-forged-c" class="internal xref">Protecting against Forged Cleartext EAP Packets</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-server-certificate-validati" class="internal xref">Server Certificate Validation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="auto internal xref">7.7</a>.  <a href="#name-tunnel-pac-considerations" class="internal xref">Tunnel PAC Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8">
                <p id="section-toc.1-1.7.2.8.1"><a href="#section-7.8" class="auto internal xref">7.8</a>.  <a href="#name-security-claims" class="internal xref">Security Claims</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-changes-from-rfc-7170" class="internal xref">Changes from RFC 7170</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref"></a><a href="#name-appendix-a-evaluation-again" class="internal xref">Appendix A Evaluation against Tunnel-Based EAP Method Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref"></a><a href="#name-a1-requirement-411-rfc-comp" class="internal xref">A.1.  Requirement 4.1.1: RFC Compliance</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref"></a><a href="#name-a2-requirement-421-tls-requ" class="internal xref">A.2.  Requirement 4.2.1: TLS Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref"></a><a href="#name-a3-requirement-42111-cipher" class="internal xref">A.3.  Requirement 4.2.1.1.1: Ciphersuite Negotiation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="auto internal xref"></a><a href="#name-a4-requirement-42112-tunnel" class="internal xref">A.4.  Requirement 4.2.1.1.2: Tunnel Data Protection Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="auto internal xref"></a><a href="#name-a5-requirement-42113-tunnel" class="internal xref">A.5.  Requirement 4.2.1.1.3: Tunnel Authentication and Key Establishment</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.6">
                <p id="section-toc.1-1.10.2.6.1"><a href="#section-10.6" class="auto internal xref"></a><a href="#name-a6-requirement-4212-tunnel-" class="internal xref">A.6.  Requirement 4.2.1.2: Tunnel Replay Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.7">
                <p id="section-toc.1-1.10.2.7.1"><a href="#section-10.7" class="auto internal xref"></a><a href="#name-a7-requirement-4213-tls-ext" class="internal xref">A.7.  Requirement 4.2.1.3: TLS Extensions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.8">
                <p id="section-toc.1-1.10.2.8.1"><a href="#section-10.8" class="auto internal xref"></a><a href="#name-a8-requirement-4214-peer-id" class="internal xref">A.8.  Requirement 4.2.1.4: Peer Identity Privacy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.9">
                <p id="section-toc.1-1.10.2.9.1"><a href="#section-10.9" class="auto internal xref"></a><a href="#name-a9-requirement-4215-session" class="internal xref">A.9.  Requirement 4.2.1.5: Session Resumption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.10">
                <p id="section-toc.1-1.10.2.10.1"><a href="#section-10.10" class="auto internal xref"></a><a href="#name-a10-requirement-422-fragmen" class="internal xref">A.10.  Requirement 4.2.2: Fragmentation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.11">
                <p id="section-toc.1-1.10.2.11.1"><a href="#section-10.11" class="auto internal xref"></a><a href="#name-a11-requirement-423-protect" class="internal xref">A.11.  Requirement 4.2.3: Protection of Data External to Tunnel</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.12">
                <p id="section-toc.1-1.10.2.12.1"><a href="#section-10.12" class="auto internal xref"></a><a href="#name-a12-requirement-431-extensi" class="internal xref">A.12.  Requirement 4.3.1: Extensible Attribute Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.13">
                <p id="section-toc.1-1.10.2.13.1"><a href="#section-10.13" class="auto internal xref"></a><a href="#name-a13-requirement-432-request" class="internal xref">A.13.  Requirement 4.3.2: Request/Challenge Response Operation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.14">
                <p id="section-toc.1-1.10.2.14.1"><a href="#section-10.14" class="auto internal xref"></a><a href="#name-a14-requirement-433-indicat" class="internal xref">A.14.  Requirement 4.3.3: Indicating Criticality of Attributes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.15">
                <p id="section-toc.1-1.10.2.15.1"><a href="#section-10.15" class="auto internal xref"></a><a href="#name-a15-requirement-434-vendor-" class="internal xref">A.15.  Requirement 4.3.4: Vendor-Specific Support</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.16">
                <p id="section-toc.1-1.10.2.16.1"><a href="#section-10.16" class="auto internal xref"></a><a href="#name-a16-requirement-435-result-" class="internal xref">A.16.  Requirement 4.3.5: Result Indication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.17">
                <p id="section-toc.1-1.10.2.17.1"><a href="#section-10.17" class="auto internal xref"></a><a href="#name-a17-requirement-436-interna" class="internal xref">A.17.  Requirement 4.3.6: Internationalization of Display Strings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.18">
                <p id="section-toc.1-1.10.2.18.1"><a href="#section-10.18" class="auto internal xref"></a><a href="#name-a18-requirement-44-eap-chan" class="internal xref">A.18.  Requirement 4.4: EAP Channel-Binding Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.19">
                <p id="section-toc.1-1.10.2.19.1"><a href="#section-10.19" class="auto internal xref"></a><a href="#name-a19-requirement-4511-confid" class="internal xref">A.19.  Requirement 4.5.1.1: Confidentiality and Integrity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.20">
                <p id="section-toc.1-1.10.2.20.1"><a href="#section-10.20" class="auto internal xref"></a><a href="#name-a20-requirement-4512-authen" class="internal xref">A.20.  Requirement 4.5.1.2: Authentication of Server</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.21">
                <p id="section-toc.1-1.10.2.21.1"><a href="#section-10.21" class="auto internal xref"></a><a href="#name-a21-requirement-4513-server" class="internal xref">A.21.  Requirement 4.5.1.3: Server Certificate Revocation Checking</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.22">
                <p id="section-toc.1-1.10.2.22.1"><a href="#section-10.22" class="auto internal xref"></a><a href="#name-a22-requirement-452-interna" class="internal xref">A.22.  Requirement 4.5.2: Internationalization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.23">
                <p id="section-toc.1-1.10.2.23.1"><a href="#section-10.23" class="auto internal xref"></a><a href="#name-a23-requirement-453-metadat" class="internal xref">A.23.  Requirement 4.5.3: Metadata</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.24">
                <p id="section-toc.1-1.10.2.24.1"><a href="#section-10.24" class="auto internal xref"></a><a href="#name-a24-requirement-454-passwor" class="internal xref">A.24.  Requirement 4.5.4: Password Change</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.25">
                <p id="section-toc.1-1.10.2.25.1"><a href="#section-10.25" class="auto internal xref"></a><a href="#name-a25-requirement-461-method-" class="internal xref">A.25.  Requirement 4.6.1: Method Negotiation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.26">
                <p id="section-toc.1-1.10.2.26.1"><a href="#section-10.26" class="auto internal xref"></a><a href="#name-a26-requirement-462-chained" class="internal xref">A.26.  Requirement 4.6.2: Chained Methods</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.27">
                <p id="section-toc.1-1.10.2.27.1"><a href="#section-10.27" class="auto internal xref"></a><a href="#name-a27-requirement-463-cryptog" class="internal xref">A.27.  Requirement 4.6.3: Cryptographic Binding with the TLS Tunnel</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.28">
                <p id="section-toc.1-1.10.2.28.1"><a href="#section-10.28" class="auto internal xref"></a><a href="#name-a28-requirement-464-peer-in" class="internal xref">A.28.  Requirement 4.6.4: Peer-Initiated EAP Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.29">
                <p id="section-toc.1-1.10.2.29.1"><a href="#section-10.29" class="auto internal xref"></a><a href="#name-a29-requirement-465-method-" class="internal xref">A.29.  Requirement 4.6.5: Method Metadata</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref"></a><a href="#name-appendix-b-major-difference" class="internal xref">Appendix B.  Major Differences from EAP-FAST</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref"></a><a href="#name-appendix-c-examples" class="internal xref">Appendix C.  Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref"></a><a href="#name-c1-successful-authenticatio" class="internal xref">C.1.  Successful Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref"></a><a href="#name-c2-failed-authentication" class="internal xref">C.2.  Failed Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref"></a><a href="#name-c3-full-tls-handshake-using" class="internal xref">C.3.  Full TLS Handshake Using Certificate-Based Ciphersuite</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#section-12.4" class="auto internal xref"></a><a href="#name-c4-client-authentication-du" class="internal xref">C.4.  Client Authentication during Phase 1 with Identity Privacy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#section-12.5" class="auto internal xref"></a><a href="#name-c5-fragmentation-and-reasse" class="internal xref">C.5.  Fragmentation and Reassembly</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.6">
                <p id="section-toc.1-1.12.2.6.1"><a href="#section-12.6" class="auto internal xref"></a><a href="#name-c6-sequence-of-eap-methods" class="internal xref">C.6.  Sequence of EAP Methods</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.7">
                <p id="section-toc.1-1.12.2.7.1"><a href="#section-12.7" class="auto internal xref"></a><a href="#name-c7-failed-crypto-binding" class="internal xref">C.7.  Failed Crypto-Binding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.8">
                <p id="section-toc.1-1.12.2.8.1"><a href="#section-12.8" class="auto internal xref"></a><a href="#name-c8-sequence-of-eap-method-w" class="internal xref">C.8.  Sequence of EAP Method with Vendor-Specific TLV Exchange</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.9">
                <p id="section-toc.1-1.12.2.9.1"><a href="#section-12.9" class="auto internal xref"></a><a href="#name-c9-peer-requests-inner-meth" class="internal xref">C.9.  Peer Requests Inner Method after Server Sends Result TLV</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.10">
                <p id="section-toc.1-1.12.2.10.1"><a href="#section-12.10" class="auto internal xref"></a><a href="#name-c10-channel-binding" class="internal xref">C.10.  Channel Binding</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref"></a><a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref"></a><a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref"></a><a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">A tunnel-based Extensible Authentication Protocol (EAP) method is an
EAP method that establishes a secure tunnel and executes other EAP
methods under the protection of that secure tunnel.  A tunnel-based
EAP method can be used in any lower-layer protocol that supports EAP
authentication.  There are several existing tunnel-based EAP methods
that use Transport Layer Security (TLS) <span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span> to establish the
secure tunnel.  EAP methods supporting this include Protected EAP
(PEAP) <span>[<a href="#PEAP" class="cite xref">PEAP</a>]</span>, EAP Tunneled Transport Layer Security (EAP-TTLS)
<span>[<a href="#RFC5281" class="cite xref">RFC5281</a>]</span>, and EAP Flexible Authentication via Secure Tunneling (EAP-
FAST) <span>[<a href="#RFC4851" class="cite xref">RFC4851</a>]</span>.  However, they all are either vendor-specific or
informational, and the industry calls for a Standards Track tunnel-
based EAP method.  <span>[<a href="#RFC6678" class="cite xref">RFC6678</a>]</span> outlines the list of requirements for a
standard tunnel-based EAP method.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Since its introduction, EAP-FAST <span>[<a href="#RFC4851" class="cite xref">RFC4851</a>]</span> has been widely adopted in
a variety of devices and platforms.  It has been adopted by the EMU
working group as the basis for the standard tunnel-based EAP method.
This document describes the Tunnel Extensible Authentication Protocol
(TEAP) version 1, based on EAP-FAST <span>[<a href="#RFC4851" class="cite xref">RFC4851</a>]</span> with some minor changes
to meet the requirements outlined in <span>[<a href="#RFC6678" class="cite xref">RFC6678</a>]</span> for a standard tunnel-
based EAP method.<a href="#section-1-2" class="pilcrow">¶</a></p>
<div id="specification-requirements">
<section id="section-1.1">
        <h3 id="name-specification-requirements">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-specification-requirements" class="section-name selfRef">Specification Requirements</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 [RFC2119] [RFC8174] when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">Much of the terminology in this document comes from <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span>.
Additional terms are defined below:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">ToDO: Remove PAC?<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">Protected Access Credential (PAC)<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.2-4.1">
            <p id="section-1.2-4.1.1">Credentials distributed to a peer for future optimized network
authentication.  The PAC consists of a minimum of two components:
a shared secret and an opaque element.  The shared secret
component contains the pre-shared key between the peer and the
authentication server.  The opaque part is provided to the peer
and is presented to the authentication server when the peer wishes
to obtain access to network resources.  The opaque element and
shared secret are used with TLS stateless session resumption
defined in <span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span> to establish a protected TLS session.  The
secret key and opaque part may be distributed using <span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span>
messages or using TLVs within the TEAP tunnel.  Finally, a PAC may
optionally include other information that may be useful to the
peer.<a href="#section-1.2-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.2-5">Type-Length-Value (TLV)<a href="#section-1.2-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.2-6.1">
            <p id="section-1.2-6.1.1">The TEAP protocol utilizes objects in TLV format.  The TLV format
is defined in <a href="#teap-tlv-format" class="auto internal xref">Section 4.2</a>.<a href="#section-1.2-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.2-7">Inner method<a href="#section-1.2-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1.2-8.1">
            <p id="section-1.2-8.1.1">An authentication method which is sent as application data inside
of a TLS exchange which is carried over TEAP.  The inner method
can be an EAP authentication method, a username / password
authentication, or a vendor-specific authentication method.<a href="#section-1.2-8.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="protocol-overview">
<section id="section-2">
      <h2 id="name-protocol-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-2-1">TEAP authentication occurs in two phases after the initial EAP
Identity request/response exchange.  In the first phase, TEAP employs
the TLS <span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span> handshake to provide an authenticated key exchange
and to establish a protected tunnel.  Once the tunnel is established,
the second phase begins with the peer and server engaging in further
conversations to establish the required authentication and
authorization policies.  TEAP makes use of TLV objects to carry out
the inner authentication, results, and other information, such as
channel-binding information.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">TEAP makes use of the TLS SessionTicket extension <span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span>, which
supports TLS session resumption without requiring session-specific
state stored at the server.  In this document, the SessionTicket is
referred to as the Protected Access Credential opaque data (or PAC-
Opaque).  The PAC-Opaque may be distributed through the use of the
NewSessionTicket message or through a mechanism that uses TLVs within
Phase 2 of TEAP.  The secret key used to resume the session in TEAP
is referred to as the Protected Access Credential key (or PAC-Key).
When the NewSessionTicket message is used to distribute the PAC-
Opaque, the PAC-Key is the master secret for the session.  If TEAP
Phase 2 is used to distribute the PAC-Opaque, then the PAC-Key is
distributed along with the PAC-Opaque.  TEAP implementations MUST
support the <span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span> mechanism for distributing a PAC-Opaque, and it
is RECOMMENDED that implementations support the capability to
distribute the ticket and secret key within the TEAP tunnel.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The TEAP conversation is used to establish or resume an existing
session to typically establish network connectivity between a peer
and the network.  Upon successful execution of TEAP, the EAP peer and
EAP server both derive strong session key material that can then be
communicated to the network access server (NAS) for use in
establishing a link-layer security association.<a href="#section-2-3" class="pilcrow">¶</a></p>
<div id="architectural-model">
<section id="section-2.1">
        <h3 id="name-architectural-model">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-architectural-model" class="section-name selfRef">Architectural Model</a>
        </h3>
<p id="section-2.1-1">The network architectural model for TEAP usage is shown below:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span id="name-teap-architectural-model"></span><figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-2.1-2.1">
<pre>
 +----------+      +----------+      +----------+      +----------+
 |          |      |          |      |          |      |  Inner   |
 |   Peer   |&lt;----&gt;|  Authen- |&lt;----&gt;|   TEAP   |&lt;----&gt;|  Method  |
 |          |      |  ticator |      |  server  |      |  server  |
 |          |      |          |      |          |      |          |
 +----------+      +----------+      +----------+      +----------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-teap-architectural-model" class="selfRef">TEAP Architectural Model</a>
          </figcaption></figure>
<p id="section-2.1-3">The Peer and Authenticator are defined in Section 1.2 of <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span>.
The TEAP server is the "backend authentication server" defined in
Section 1.2 of <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span>.  The "Inner Method server" is usually part of the
TEAP server, and handles the iapplication data (inner methods, EAP, passwords, etc.)
inside of the TLS tunnel.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">The entities depicted above are logical entities and may or may not
correspond to separate network components.  For example, the TEAP
server and Inner Method server might be a single entity; the
authenticator and TEAP server might be a single entity; or the
functions of the authenticator, TEAP server, and Inner Method server
might be combined into a single physical device.  For example,
typical IEEE 802.11 deployments place the authenticator in an access
point (AP) while a RADIUS server may provide the TEAP and inner
method server components.  The above diagram illustrates the division
of labor among entities in a general manner and shows how a
distributed system might be constructed; however, actual systems
might be realized more simply.  The security considerations in
<a href="#separation-p1-p2" class="auto internal xref">Section 7.3</a> provide an additional discussion of the implications of
separating the TEAP server from the Inner Method server.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol-layering-model">
<section id="section-2.2">
        <h3 id="name-protocol-layering-model">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-protocol-layering-model" class="section-name selfRef">Protocol-Layering Model</a>
        </h3>
<p id="section-2.2-1">TEAP packets are encapsulated within EAP; EAP in turn requires a
transport protocol.  TEAP packets encapsulate TLS, which is then used
to encapsulate user authentication information.  Thus, TEAP messaging
can be described using a layered model, where each layer encapsulates
the layer above it.  The following diagram clarifies the relationship
between protocols:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<span id="name-protocol-layering-model-2"></span><figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-2.2-2.1">
<pre>
 +---------------------------------------------------------------+
 |         Inner method       |     Other TLV information        |
 |---------------------------------------------------------------|
 |                 TLV Encapsulation (TLVs)                      |
 |---------------------------------------------------------------|
 |                TLS         |     Optional Outer TLVs          |
 |---------------------------------------------------------------|
 |                         TEAP                                  |
 |---------------------------------------------------------------|
 |                         EAP                                   |
 |---------------------------------------------------------------|
 |    Carrier Protocol (EAP over LAN, RADIUS, Diameter, etc.)    |
 +---------------------------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-protocol-layering-model-2" class="selfRef">Protocol-Layering Model</a>
          </figcaption></figure>
<p id="section-2.2-3">The TLV layer is a payload with TLV objects as defined in
<a href="#teap-tlv-format" class="auto internal xref">Section 4.2</a>.  The TLV objects are used to carry arbitrary parameters
between an EAP peer and an EAP server.  All conversations in the TEAP
protected tunnel are encapsulated in a TLV layer.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">TEAP packets may include TLVs both inside and outside the TLS tunnel.
The term "Outer TLVs" is used to refer to optional TLVs outside the
TLS tunnel, which are only allowed in the first two messages in the
TEAP protocol.  That is the first EAP-server-to-peer message and
first peer-to-EAP-server message.  If the message is fragmented, the
whole set of messages is counted as one message.  The term "Inner
TLVs" is used to refer to TLVs sent within the TLS tunnel.  In TEAP
Phase 1, Outer TLVs are used to help establish the TLS tunnel, but no
Inner TLVs are used.  In Phase 2 of the TEAP conversation, TLS
records may encapsulate zero or more Inner TLVs, but no Outer TLVs.<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<p id="section-2.2-5">Methods for encapsulating EAP within carrier protocols are already
defined.  For example, IEEE 802.1X <span>[<a href="#IEEE.802-1X.2013" class="cite xref">IEEE.802-1X.2013</a>]</span> may be used to
transport EAP between the peer and the authenticator; RADIUS
<span>[<a href="#RFC3579" class="cite xref">RFC3579</a>]</span> or Diameter <span>[<a href="#RFC4072" class="cite xref">RFC4072</a>]</span> may be used to transport EAP between
the authenticator and the EAP server.<a href="#section-2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="teap-protocol">
<section id="section-3">
      <h2 id="name-teap-protocol">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-teap-protocol" class="section-name selfRef">TEAP Protocol</a>
      </h2>
<p id="section-3-1">The operation of the protocol, including Phase 1 and Phase 2, is the
topic of this section.  The format of TEAP messages is given in
<a href="#message-formats" class="auto internal xref">Section 4</a>, and the cryptographic calculations are given in <a href="#cryptographic-calculations" class="auto internal xref">Section 5</a>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="version-negotiation">
<section id="section-3.1">
        <h3 id="name-version-negotiation">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-version-negotiation" class="section-name selfRef">Version Negotiation</a>
        </h3>
<p id="section-3.1-1">TEAP packets contain a 3-bit Version field, following the TLS Flags
field, which enables future TEAP implementations to be backward
compatible with previous versions of the protocol.  This
specification documents the TEAP version 1 protocol; implementations
of this specification MUST use a Version field set to 1.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Version negotiation proceeds as follows:<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1-3">
<li id="section-3.1-3.1">In the first EAP-Request sent with EAP type=TEAP, the EAP server
MUST set the Version field to the highest version it supports.<a href="#section-3.1-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-3.2">If the EAP peer supports this version of the protocol, it responds
with an EAP-Response of EAP type=TEAP, including the version number
proposed by the TEAP server.<a href="#section-3.1-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-3.3">If the TEAP peer does not support the proposed version but supports
a lower version, it responds with an EAP-Response of EAP type=TEAP and
sets the Version field to its highest supported version.<a href="#section-3.1-3.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-3.4">If the TEAP peer only supports versions higher than the version
proposed by the TEAP server, then use of TEAP will not be possible.
In this case, the TEAP peer sends back an EAP-Nak either to negotiate
a different EAP type or to indicate no other EAP types are available.<a href="#section-3.1-3.4" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-3.5">If the TEAP server does not support the version number proposed by
the TEAP peer, it MUST either terminate the conversation with an EAP
Failure or negotiate a new EAP type.<a href="#section-3.1-3.5" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-3.6">If the TEAP server does support the version proposed by the TEAP
peer, then the conversation continues using the version proposed by
the TEAP peer.<a href="#section-3.1-3.6" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.1-4">The version negotiation procedure guarantees that the TEAP peer and
server will agree to the latest version supported by both parties.
If version negotiation fails, then use of TEAP will not be possible,
and another mutually acceptable EAP method will need to be negotiated
if authentication is to proceed.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">The TEAP version is not protected by TLS and hence can be modified in
transit.  In order to detect a modification of the TEAP version, the
peers MUST exchange the TEAP version number received during version
negotiation using the Crypto-Binding TLV described in <a href="#crypto-binding-tlv" class="auto internal xref">Section 4.2.13</a>.
The receiver of the Crypto-Binding TLV MUST verify that the version
received in the Crypto-Binding TLV matches the version sent by the
receiver in the TEAP version negotiation.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">The Crypto-Binding TLV MUST be validated before any Intermediate-Result TLV
or Result TLV is examined.  If the Crypto-Binding TLV fails to be
validated for any reason, then it is a fatal error and is handled as
described in <a href="#phase-2-errors" class="auto internal xref">Section 3.6.3</a>.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="teap-authentication-phase-1-tunnel-establishment">
<section id="section-3.2">
        <h3 id="name-teap-authentication-phase-1">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-teap-authentication-phase-1" class="section-name selfRef">TEAP Authentication Phase 1: Tunnel Establishment</a>
        </h3>
<p id="section-3.2-1">TEAP relies on the TLS handshake <span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span> to establish an
authenticated and protected tunnel.  The TLS version offered by the
peer and server MUST be TLS version 1.2 <span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span> or later.  This
version of the TEAP implementation MUST support the following TLS
ciphersuites:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2-2.1">
            <p id="section-3.2-2.1.1">TLS_RSA_WITH_AES_128_CBC_SHA <span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span><a href="#section-3.2-2.1.1" class="pilcrow">¶</a></p>
<p id="section-3.2-2.1.2">TLS_DHE_RSA_WITH_AES_128_CBC_SHA <span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span><a href="#section-3.2-2.1.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-3">This version of the TEAP implementation SHOULD support the following
TLS ciphersuite:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.2-4.1">
            <p id="section-3.2-4.1.1">TLS_RSA_WITH_AES_256_CBC_SHA <span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span><a href="#section-3.2-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-5">Other ciphersuites MAY be supported.  It is REQUIRED that anonymous
ciphersuites such as TLS_DH_anon_WITH_AES_128_CBC_SHA <span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span> only
be used in the case when the inner method provides
mutual authentication, key generation, and resistance to man-in-the-middle
and dictionary attacks.  TLS ciphersuites that do not provide
confidentiality MUST NOT be used.  During the TEAP Phase 1
conversation, the TEAP endpoints MAY negotiate TLS compression.
During TLS tunnel establishment, TLS extensions MAY be used.  For
instance, the Certificate Status Request extension <span>[<a href="#RFC6066" class="cite xref">RFC6066</a>]</span> and the
Multiple Certificate Status Request extension <span>[<a href="#RFC6961" class="cite xref">RFC6961</a>]</span> can be used
to leverage a certificate-status protocol such as Online Certificate
Status Protocol (OCSP) <span>[<a href="#RFC6960" class="cite xref">RFC6960</a>]</span> to check the validity of server
certificates.  TLS renegotiation indications defined in RFC 5746
<span>[<a href="#RFC5746" class="cite xref">RFC5746</a>]</span> MUST be supported.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">The EAP server initiates the TEAP conversation with an EAP request
containing a TEAP/Start packet.  This packet includes a set Start (S)
bit, the TEAP version as specified in <a href="#version-negotiation" class="auto internal xref">Section 3.1</a>, and an authority
identity TLV.  The TLS payload in the initial packet is empty.  The
authority identity TLV (Authority-ID TLV) is used to provide the peer
a hint of the server's identity that may be useful in helping the
peer select the appropriate credential to use.  Assuming that the
peer supports TEAP, the conversation continues with the peer sending
an EAP-Response packet with EAP type of TEAP with the Start (S) bit
clear and the version as specified in <a href="#version-negotiation" class="auto internal xref">Section 3.1</a>.  This message
encapsulates one or more TLS handshake messages.  If the TEAP version
negotiation is successful, then the TEAP conversation continues until
the EAP server and EAP peer are ready to enter Phase 2.  When the
full TLS handshake is performed, then the first payload of TEAP Phase
2 MAY be sent along with a server-finished handshake message to
reduce the number of round trips.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<p id="section-3.2-7">TEAP implementations MUST support mutual peer authentication during
tunnel establishment using the TLS ciphersuites specified in this
section.  The TEAP peer does not need to authenticate as part of the
TLS exchange but can alternatively be authenticated through
additional exchanges carried out in Phase 2.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<p id="section-3.2-8">The TEAP tunnel protects peer identity information exchanged during
Phase 2 from disclosure outside the tunnel.  Implementations that
wish to provide identity privacy for the peer identity need to
carefully consider what information is disclosed outside the tunnel
prior to Phase 2.  TEAP implementations SHOULD support the immediate
renegotiation of a TLS session to initiate a new handshake message
exchange under the protection of the current ciphersuite.  This
allows support for protection of the peer's identity when using TLS
client authentication.  An example of the exchanges using TLS
renegotiation to protect privacy is shown in Appendix C.<a href="#section-3.2-8" class="pilcrow">¶</a></p>
<p id="section-3.2-9">The following sections describe resuming a TLS session based on
server-side or client-side state.<a href="#section-3.2-9" class="pilcrow">¶</a></p>
<div id="resume-server-state">
<section id="section-3.2.1">
          <h4 id="name-tls-session-resume-using-se">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-tls-session-resume-using-se" class="section-name selfRef">TLS Session Resume Using Server State</a>
          </h4>
<p id="section-3.2.1-1">TEAP session resumption is achieved in the same manner TLS achieves
session resume.  To support session resumption, the server and peer
minimally cache the Session ID, master secret, and ciphersuite.  The
peer attempts to resume a session by including a valid Session ID
from a previous TLS handshake in its ClientHello message.  If the
server finds a match for the Session ID and is willing to establish a
new connection using the specified session state, the server will
respond with the same Session ID and proceed with the TEAP Phase 1
tunnel establishment based on a TLS abbreviated handshake.  After a
successful conclusion of the TEAP Phase 1 conversation, the
conversation then continues on to Phase 2.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="resume-pac">
<section id="section-3.2.2">
          <h4 id="name-tls-session-resume-using-a-">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-tls-session-resume-using-a-" class="section-name selfRef">TLS Session Resume Using a PAC</a>
          </h4>
<p id="section-3.2.2-1">TEAP supports the resumption of sessions based on server state being
stored on the client side using the TLS SessionTicket extension
techniques described in <span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span>.  This version of TEAP supports the
provisioning of a ticket called a Protected Access Credential (PAC)
through the use of the NewSessionTicket handshake described in
<span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span>, as well as provisioning of a PAC inside the protected
tunnel.  Implementations MUST support the TLS Ticket extension
<span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span> mechanism for distributing a PAC and may provide additional
ways to provision the PAC, such as manual configuration.  Since the
PAC mentioned here is used for establishing the TLS tunnel, it is
more specifically referred to as the Tunnel PAC.  The Tunnel PAC is a
security credential provided by the EAP server to a peer and
comprised of:<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2.2-2">
<li id="section-3.2.2-2.1">PAC-Key: this is the key used by the peer as the TLS master
secret to establish the TEAP Phase 1 tunnel.  The PAC-Key is a
strong, high-entropy, at minimum 48-octet key and is typically
the master secret from a previous TLS session.  The PAC-Key is a
secret and MUST be treated accordingly.  Otherwise, if leaked, it
could lead to user credentials being compromised if sent within
the tunnel established using the PAC-Key.  In the case that a
PAC-Key is provisioned to the peer through another means, it MUST
have its confidentiality and integrity protected by a mechanism,
such as the TEAP Phase 2 tunnel.  The PAC-Key MUST be stored
securely by the peer.<a href="#section-3.2.2-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-3.2.2-2.2">PAC-Opaque: this is a variable-length field containing the ticket
that is sent to the EAP server during the TEAP Phase 1 tunnel
establishment based on <span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span>.  The PAC-Opaque can only be
interpreted by the EAP server to recover the required information
for the server to validate the peer's identity and
authentication.  The PAC-Opaque includes the PAC-Key and other
TLS session parameters.  It may contain the PAC's peer identity.
The PAC-Opaque format and contents are specific to the PAC
issuing server.  The PAC-Opaque may be presented in the clear, so
an attacker MUST NOT be able to gain useful information from the
PAC-Opaque itself.  The server issuing the PAC-Opaque needs to
ensure it is protected with strong cryptographic keys and
algorithms.  The PAC-Opaque may be distributed using the
NewSessionTicket message defined in <span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span>, or it may be
distributed through another mechanism such as the Phase 2 TLVs
defined in this document.<a href="#section-3.2.2-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-3.2.2-2.3">PAC-Info: this is an optional variable-length field used to
provide, at a minimum, the authority identity of the PAC issuer.
Other useful but not mandatory information, such as the PAC-Key
lifetime, may also be conveyed by the PAC-issuing server to the
peer during PAC provisioning or refreshment.  PAC-Info is not
included if the NewSessionTicket message is used to provision the
PAC.<a href="#section-3.2.2-2.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-3.2.2-3">The use of the PAC is based on the SessionTicket extension defined in
<span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span>.  The EAP server initiates the TEAP conversation as normal.
Upon receiving the Authority-ID TLV from the server, the peer checks
to see if it has an existing valid PAC-Key and PAC-Opaque for the
server.  If it does, then it obtains the PAC-Opaque and puts it in
the SessionTicket extension in the ClientHello.  It is RECOMMENDED in
TEAP that the peer include an empty Session ID in a ClientHello
containing a PAC-Opaque.  This version of TEAP supports the
NewSessionTicket Handshake message as described in <span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span> for
distribution of a new PAC, as well as the provisioning of PAC inside
the protected tunnel.  If the PAC-Opaque included in the
SessionTicket extension is valid and the EAP server permits the
abbreviated TLS handshake, it will select the ciphersuite from
information within the PAC-Opaque and finish with the abbreviated TLS
handshake.  If the server receives a Session ID and a PAC-Opaque in
the SessionTicket extension in a ClientHello, it should place the
same Session ID in the ServerHello if it is resuming a session based
on the PAC-Opaque.  The conversation then proceeds as described in
<span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span> until the handshake completes or a fatal error occurs.
After the abbreviated handshake completes, the peer and the server
are ready to commence Phase 2.<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="transition-between-abbreviated-and-full-tls-handshake">
<section id="section-3.2.3">
          <h4 id="name-transition-between-abbrevia">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-transition-between-abbrevia" class="section-name selfRef">Transition between Abbreviated and Full TLS Handshake</a>
          </h4>
<p id="section-3.2.3-1">If session resumption based on server-side or client-side state
fails, the server can gracefully fall back to a full TLS handshake.
If the ServerHello received by the peer contains an empty Session ID
or a Session ID that is different than in the ClientHello, the server
may fall back to a full handshake.  The peer can distinguish the
server's intent to negotiate a full or abbreviated TLS handshake by
checking the next TLS handshake messages in the server response to
the ClientHello.  If ChangeCipherSpec follows the ServerHello in
response to the ClientHello, then the server has accepted the session
resumption and intends to negotiate the abbreviated handshake.
Otherwise, the server intends to negotiate the full TLS handshake.  A
peer can request that a new PAC be provisioned after the full TLS
handshake and mutual authentication of the peer and the server.  A
peer SHOULD NOT request that a new PAC be provisioned after the
abbreviated handshake, as requesting a new session ticket based on
resumed session is not permitted.  In order to facilitate the
fallback to a full handshake, the peer SHOULD include ciphersuites
that allow for a full handshake and possibly PAC provisioning so the
server can select one of these in case session resumption fails.  An
example of the transition is shown in Appendix C.<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="teap-authentication-phase-2-tunneled-authentication">
<section id="section-3.3">
        <h3 id="name-teap-authentication-phase-2">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-teap-authentication-phase-2" class="section-name selfRef">TEAP Authentication Phase 2: Tunneled Authentication</a>
        </h3>
<p id="section-3.3-1">The second portion of the TEAP authentication occurs immediately
after successful completion of Phase 1.  Phase 2 occurs even if both
peer and authenticator are authenticated in the Phase 1 TLS
negotiation.  Phase 2 MUST NOT occur if the Phase 1 TLS handshake
fails, as that will compromise the security as the tunnel has not
been established successfully.  Phase 2 consists of a series of
requests and responses encapsulated in TLV objects defined in
<a href="#teap-tlv-format" class="auto internal xref">Section 4.2</a>.  Phase 2 MUST always end with a Crypto-Binding TLV
exchange described in <a href="#crypto-binding-tlv" class="auto internal xref">Section 4.2.13</a> and a protected termination
exchange described in <a href="#protected-termination" class="auto internal xref">Section 3.3.4</a>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">The TLV exchange includes the execution of zero or more inner
methods within the protected tunnel as described in <a href="#inner-eap" class="auto internal xref">Section 3.3.1</a>
and <span><a href="inner-password">inner-password</a></span>.  A server MAY proceed directly to the
protected termination exchange, without performing any inner
authentication if it does not wish to request further authentication
from the peer.  A server MAY request one or more authentications
within the protected tunnel.  After completion of each inner method,
the server decides whether or not to begin another inner method, or
to send a Result TLV.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">Implementations MUST support at least two sequential inner methods,
which allows both Machine and User authentication to be performed.
Implementations SHOULD also limit the number of sequential inner
authentications, as there is no reason to perform a large number of inner
authentications in one TEAP conversation.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">Implementations wishing to use their own proprietary authentication
method, may substitute the EAP-Payload or Basic-Password-Auth-Req TLV
for the Vendor-Specific TLV which carries another authentication
method.  Any proprietary authentication method MUST support
calculation of the Crypto-Binding TLV, and MUST use
Intermediate-Result TLV and Result TLV as is done with other
authentication methods.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">Implementations SHOULD support both inner EAP authentication methods
and inner password authentication.  Implementations which support
multiple authentication methods MUST support those methods in any
order or combination.  That is, it is explicitly permitted to "mix
and match" inner methods.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6">However, the peer and server MUST NOT assume that either will skip
inner methods or other TLV exchanges, as the other peer might have
a different security policy.  The peer may have roamed to a network
that requires conformance with a different authentication policy, or
the peer may request the server take additional action (e.g., channel
binding) through the use of the Request-Action TLV as defined in
<a href="#request-action-tlv" class="auto internal xref">Section 4.2.9</a>.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<p id="section-3.3-7">The completion of each inner method is signalled by an
Intermediate-Result TLV.  Where the Intermediate-Result TLV indicates
failure, an Error TLV SHOULD also be included.  The
Intermediate-Result TLV may be accompanied by another TLV indicating
that the server wishes to perform a subsequent authentication.  When
the authentication sequence completes, the server MUST send a Result
TLV indicating success or failure instead of a TLV which carries an
inner method.<a href="#section-3.3-7" class="pilcrow">¶</a></p>
<div id="inner-eap">
<section id="section-3.3.1">
          <h4 id="name-inner-eap-authentication">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-inner-eap-authentication" class="section-name selfRef">Inner EAP Authentication</a>
          </h4>
<p id="section-3.3.1-1">EAP <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span> prohibits use of multiple authentication methods within
a single EAP conversation in order to limit vulnerabilities to man-
in-the-middle attacks.  TEAP addresses man-in-the-middle attacks
through support for cryptographic protection of the inner EAP
exchange and cryptographic binding of the inner EAP
method(s) to the protected tunnel.  Inner EAP methods are executed serially
in a sequence.  This version of TEAP does not support initiating
multiple inner EAP methods simultaneously in parallel.  The inner EAP methods need
not be distinct.  For example, EAP-TLS could be run twice as an inner
method, first using machine credentials followed by a second instance
using user credentials.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">Inner EAP method messages are carried within EAP-Payload TLVs defined in
<a href="#eap-payload-tlv" class="auto internal xref">Section 4.2.10</a>.  Note that in this use-case, TEAP is simply a
carrier for EAP, much as RADIUS is a carrier for EAP.  The full EAP
state machine is run as normal, and is carried over the EAP-Payload
TLV.  Each distinct EAP authentication MUST be managed as a separate
EAP state machine.<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.3.1-3">A TEAP server therefore MUST begin an EAP authentication with an
EAP-Request/Identity (carried in an EAP-Payload TLV).  However, a TEAP
server MUST NOT finish the EAP conversation with an EAP Success or EAP
Failure packet, the Intermediate-Result TLV is used instead.<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-4">Upon completion of each EAP authentication in the tunnel, the server MUST send
an Intermediate-Result TLV indicating the result of that authentication.  The peer MUST
respond to the Intermediate-Result TLV indicating its result.  If the
result indicates success, the servers Intermediate-Result TLV MUST be
accompanied by a Crypto-Binding TLV.  The Crypto-Binding TLV is
further discussed in <a href="#crypto-binding-tlv" class="auto internal xref">Section 4.2.13</a> and
<a href="#computing-compound-mac" class="auto internal xref">Section 5.3</a>.  The Intermediate-Result TLVs can be
included with other TLVs which indicate a subsequent authentication,
or with the Result TLV used in the protected termination
exchange.<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.3.1-5">If both peer and server indicate success, then the authentication is
considered successful.  If either indicates failure, then the authentication is
considered failed.  The result of failure of an EAP authentication does not
always imply a failure of the overall authentication.  If one
authentication method fails, the server may attempt to authenticate
the peer with a different method (EAP or password).<a href="#section-3.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="inner-password">
<section id="section-3.3.2">
          <h4 id="name-inner-password-authenticati">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-inner-password-authenticati" class="section-name selfRef">Inner Password Authentication</a>
          </h4>
<p id="section-3.3.2-1">The authentication server initiates password
authentication by sending a Basic-Password-Auth-Req TLV defined in
<a href="#bp-auth-req-tlv" class="auto internal xref">Section 4.2.14</a>.  If the peer wishes to participate in password
authentication, then it responds with a Basic-Password-Auth-Resp TLV
as defined in Section 4.2.15 that contains the username and password.
If it does not wish to perform password authentication, then it
responds with a NAK TLV indicating the rejection of the Basic-Password-Auth-Req TLV.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-2">The use of EAP-FAST-GTC as defined in RFC 5421 <span>[<a href="#RFC5421" class="cite xref">RFC5421</a>]</span> is NOT
RECOMMENDED with TEAPv1 because EAP-FAST-GTC is not compliant with
EAP-GTC defined in <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span>.  Implementations should instead make
use of the password authentication TLVs defined in this
specification.<a href="#section-3.3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.3.2-3">Upon completion of password authentication in
the tunnel, the server MUST send an Intermediate-Result TLV
indicating the result.  The peer MUST respond
to the Intermediate-Result TLV indicating its result.  If the result
indicates success, the Intermediate-Result TLV MUST be accompanied by
a Crypto-Binding TLV.  The Crypto-Binding TLV is further discussed in
<a href="#crypto-binding-tlv" class="auto internal xref">Section 4.2.13</a> and <a href="#computing-compound-mac" class="auto internal xref">Section 5.3</a>.  The Intermediate-Result TLVs can be
included with other TLVs which indicate a subsequent authentication,
or with the Result TLV used in the protected termination
exchange.<a href="#section-3.3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.3.2-4">Multiple round trips of password
authentication requests and responses MAY be used to support some
"housecleaning" functions such as a password or pin change before a
user is authenticated.<a href="#section-3.3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="eap-mschapv2">
<section id="section-3.3.3">
          <h4 id="name-eap-mschapv2">
<a href="#section-3.3.3" class="section-number selfRef">3.3.3. </a><a href="#name-eap-mschapv2" class="section-name selfRef">EAP-MSCHAPv2</a>
          </h4>
<p id="section-3.3.3-1">If using EAP-MSCHAPv2 <span>[<a href="#KAMATH" class="cite xref">KAMATH</a>]</span> as an inner EAP method, the EAP-FAST-MSCHAPv2
variant defined in Section 3.2.3 of <span>[<a href="#RFC5422" class="cite xref">RFC5422</a>]</span> MUST be used, instead of the derivation defined in <span>[<a href="#MSCHAP" class="cite xref">MSCHAP</a>]</span>.<a href="#section-3.3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3.3-2">The difference between EAP-MSCHAPv2 and EAP-FAST-MSCHAPv2 is that the
first and the second 16 octets of EAP-MSCHAPv2 MSK are swapped when it
is used as the IMSK for TEAP.<a href="#section-3.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protected-termination">
<section id="section-3.3.4">
          <h4 id="name-protected-termination-and-a">
<a href="#section-3.3.4" class="section-number selfRef">3.3.4. </a><a href="#name-protected-termination-and-a" class="section-name selfRef">Protected Termination and Acknowledged Result Indication</a>
          </h4>
<p id="section-3.3.4-1">A successful TEAP Phase 2 conversation MUST always end in a
successful Crypto-Binding TLV and Result TLV exchange.  A TEAP server
may initiate the Crypto-Binding TLV and Result TLV exchange without
initiating any EAP conversation in TEAP Phase 2.  After the final
Result TLV exchange, the TLS tunnel is terminated, and a cleartext
EAP Success or EAP Failure is sent by the server.  Peers implementing
TEAP MUST NOT accept a cleartext EAP Success or failure packet prior
to the peer and server reaching synchronized protected result
indication.<a href="#section-3.3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.3.4-2">The Crypto-Binding TLV exchange is used to prove that both the peer
and server participated in the tunnel establishment and sequence of
authentications.  It also provides verification of the TEAP type,
version negotiated, and Outer TLVs exchanged before the TLS tunnel
establishment.  Except as noted below, the Crypto-Binding TLV MUST be exchanged and verified
before the final Result TLV exchange, regardless of whether or not
there is an inner EAP authentication method.  The Crypto-Binding TLV
and Intermediate-Result TLV MUST be included to perform cryptographic
binding after each successful authentication in a sequence of one or more
inner methods.  The server may send the final Result TLV along with an
Intermediate-Result TLV and a Crypto-Binding TLV to indicate its
intention to end the conversation.  If the peer requires nothing more
from the server, it will respond with a Result TLV indicating success
accompanied by a Crypto-Binding TLV and Intermediate-Result TLV if
necessary.  The server then tears down the tunnel and sends a
cleartext EAP Success or EAP Failure.<a href="#section-3.3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.3.4-3">If the peer receives a Result TLV indicating success from the server,
but its authentication policies are not satisfied (for example, it
requires a particular authentication mechanism be run or it wants to
request a PAC), it may request further action from the server using
the Request-Action TLV.  The Request-Action TLV is sent with a Status
field indicating what EAP Success/Failure result the peer would
expect if the requested action is not granted.  The value of the
Action field indicates what the peer would like to do next.  The
format and values for the Request-Action TLV are defined in
<a href="#request-action-tlv" class="auto internal xref">Section 4.2.9</a>.<a href="#section-3.3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.3.4-4">Upon receiving the Request-Action TLV, the server may process the
request or ignore it, based on its policy.  If the server ignores the
request, it proceeds with termination of the tunnel and sends the
cleartext EAP Success or Failure message based on the Status field of
the peer's Request-Action TLV.  If the server honors and processes
the request, it continues with the requested action.  The
conversation completes with a Result TLV exchange.  The Result TLV
may be included with the TLV that completes the requested action.<a href="#section-3.3.4-4" class="pilcrow">¶</a></p>
<p id="section-3.3.4-5">Error handling for Phase 2 is discussed in <a href="#phase-2-errors" class="auto internal xref">Section 3.6.3</a>.<a href="#section-3.3.4-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="determining-peer-id-and-server-id">
<section id="section-3.4">
        <h3 id="name-determining-peer-id-and-ser">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-determining-peer-id-and-ser" class="section-name selfRef">Determining Peer-Id and Server-Id</a>
        </h3>
<p id="section-3.4-1">The Peer-Id and Server-Id <span>[<a href="#RFC5247" class="cite xref">RFC5247</a>]</span> may be determined based on the
types of credentials used during either the TEAP tunnel creation or
authentication.  In the case of multiple peer authentications, all
authenticated peer identities and their corresponding identity types
(<a href="#identity-type-tlv" class="auto internal xref">Section 4.2.3</a>) need to be exported.  In the case of multiple server
authentications, all authenticated server identities need to be
exported.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">When X.509 certificates are used for peer authentication, the Peer-Id
is determined by the subject and subjectAltName fields in the peer
certificate.  As noted in <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>:<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4-3">
<pre>
  The subject field identifies the entity associated with the public
  key stored in the subject public key field.  The subject name MAY
  be carried in the subject field and/or the subjectAltName
  extension. . . . If subject naming information is present only in
  the subjectAltName extension (e.g., a key bound only to an email
  address or URI), then the subject name MUST be an empty sequence
  and the subjectAltName extension MUST be critical.

  Where it is non-empty, the subject field MUST contain an X.500
  distinguished name (DN).
</pre><a href="#section-3.4-3" class="pilcrow">¶</a>
</div>
<p id="section-3.4-4">If an inner EAP authentication method is run, then the Peer-Id is obtained from that
inner EAP authentication method.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4-5">When the server uses an X.509 certificate to establish the TLS
tunnel, the Server-Id is determined in a similar fashion as stated
above for the Peer-Id, e.g., the subject and subjectAltName fields in
the server certificate define the Server-Id.<a href="#section-3.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="teap-session-identifier">
<section id="section-3.5">
        <h3 id="name-teap-session-identifier">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-teap-session-identifier" class="section-name selfRef">TEAP Session Identifier</a>
        </h3>
<p id="section-3.5-1">The EAP session identifier <span>[<a href="#RFC5247" class="cite xref">RFC5247</a>]</span> is constructed using the tls-
unique from the Phase 1 outer tunnel at the beginning of Phase 2 as
defined by Section 3.1 of <span>[<a href="#RFC5929" class="cite xref">RFC5929</a>]</span>.  The Session-Id is defined as
follows:<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5-2">
<pre>
   Session-Id = teap_type \| tls-unique
</pre><a href="#section-3.5-2" class="pilcrow">¶</a>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.5-3.1">
            <p id="section-3.5-3.1.1">where | denotes concatenation, and teap_type is the EAP Type assigned to TEAP<a href="#section-3.5-3.1.1" class="pilcrow">¶</a></p>
<p id="section-3.5-3.1.2">tls-unique = tls-unique from the Phase 1 outer tunnel at the
beginning of Phase 2 as defined by Section 3.1 of <span>[<a href="#RFC5929" class="cite xref">RFC5929</a>]</span><a href="#section-3.5-3.1.2" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="error-handling">
<section id="section-3.6">
        <h3 id="name-error-handling">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-error-handling" class="section-name selfRef">Error Handling</a>
        </h3>
<p id="section-3.6-1">TEAP uses the error-handling rules summarized below:<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.6-2">
<li id="section-3.6-2.1">Errors in the outer EAP packet layer are handled as defined in
<a href="#outer-layer-errors" class="auto internal xref">Section 3.6.1</a>.<a href="#section-3.6-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.6-2.2">Errors in the TLS layer are communicated via TLS alert messages
in all phases of TEAP.<a href="#section-3.6-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.6-2.3">The Intermediate-Result TLVs carry success or failure indications
of the individual inner methods in TEAP Phase 2.  Errors within the
EAP conversation in Phase 2 are expected to be handled by
individual EAP authentication methods.<a href="#section-3.6-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.6-2.4">Violations of the Inner TLV rules are handled using Result TLVs
together with Error TLVs.<a href="#section-3.6-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-3.6-2.5">Tunnel-compromised errors (errors caused by a failed or missing
Crypto-Binding) are handled using Result TLVs and Error TLVs.<a href="#section-3.6-2.5" class="pilcrow">¶</a>
</li>
        </ol>
<div id="outer-layer-errors">
<section id="section-3.6.1">
          <h4 id="name-outer-layer-errors">
<a href="#section-3.6.1" class="section-number selfRef">3.6.1. </a><a href="#name-outer-layer-errors" class="section-name selfRef">Outer-Layer Errors</a>
          </h4>
<p id="section-3.6.1-1">Errors on the TEAP outer-packet layer are handled in the following
ways:<a href="#section-3.6.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.6.1-2">
<li id="section-3.6.1-2.1">If Outer TLVs are invalid or contain unknown values, they will be
ignored.<a href="#section-3.6.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-3.6.1-2.2">The entire TEAP packet will be ignored if other fields (version,
length, flags, etc.) are inconsistent with this specification.<a href="#section-3.6.1-2.2" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="tls-layer-errors">
<section id="section-3.6.2">
          <h4 id="name-tls-layer-errors">
<a href="#section-3.6.2" class="section-number selfRef">3.6.2. </a><a href="#name-tls-layer-errors" class="section-name selfRef">TLS Layer Errors</a>
          </h4>
<p id="section-3.6.2-1">If the TEAP server detects an error at any point in the TLS handshake
or the TLS layer, the server SHOULD send a TEAP request encapsulating
a TLS record containing the appropriate TLS alert message rather than
immediately terminating the conversation so as to allow the peer to
inform the user of the cause of the failure and possibly allow for a
restart of the conversation.  The peer MUST send a TEAP response to
an alert message.  The EAP-Response packet sent by the peer may
encapsulate a TLS ClientHello handshake message, in which case the
TEAP server MAY allow the TEAP conversation to be restarted, or it
MAY contain a TEAP response with a zero-length message, in which case
the server MUST terminate the conversation with an EAP Failure
packet.  It is up to the TEAP server whether or not to allow
restarts, and, if allowed, how many times the conversation can be
restarted.  Per TLS <span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span>, TLS restart is only allowed for non-
fatal alerts.  A TEAP server implementing restart capability SHOULD
impose a limit on the number of restarts, so as to protect against
denial-of-service attacks.  If the TEAP server does not allow
restarts, it MUST terminate the conversation with an EAP Failure
packet.<a href="#section-3.6.2-1" class="pilcrow">¶</a></p>
<p id="section-3.6.2-2">If the TEAP peer detects an error at any point in the TLS layer, the
TEAP peer SHOULD send a TEAP response encapsulating a TLS record
containing the appropriate TLS alert message.  The server may restart
the conversation by sending a TEAP request packet encapsulating the
TLS HelloRequest handshake message.  The peer may allow the TEAP
conversation to be restarted, or it may terminate the conversation by
sending a TEAP response with a zero-length message.<a href="#section-3.6.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="phase-2-errors">
<section id="section-3.6.3">
          <h4 id="name-phase-2-errors">
<a href="#section-3.6.3" class="section-number selfRef">3.6.3. </a><a href="#name-phase-2-errors" class="section-name selfRef">Phase 2 Errors</a>
          </h4>
<p id="section-3.6.3-1">Any time the peer or the server finds a fatal error outside of the
TLS layer during Phase 2 TLV processing, it MUST send a Result TLV of
failure and an Error TLV with the appropriate error code.  For errors
involving the processing of the sequence of exchanges, such as a
violation of TLV rules (e.g., multiple EAP-Payload TLVs), the error
code is Unexpected TLVs Exchanged.  For errors involving a tunnel
compromise, the error code is Tunnel Compromise Error.  Upon sending
a Result TLV with a fatal Error TLV, the sender terminates the TLS
tunnel.  Note that a server will still wait for a message from the
peer after it sends a failure; however, the server does not need to
process the contents of the response message.<a href="#section-3.6.3-1" class="pilcrow">¶</a></p>
<p id="section-3.6.3-2">For the inner method, retransmission is not needed and SHOULD NOT be
attempted, as the Outer TLS tunnel can be considered a reliable
transport.  If there is a non-fatal error handling the inner method,
instead of silently dropping the inner method exchange and
not responding, the receiving side SHOULD use an Error TLV with error
code Inner Method Error to indicate an error processing the current
inner method.  The side receiving a non-fatal Error TLV MAY decide to start a
new inner method instead or to send back a Result TLV to terminate the
TEAP authentication session.<a href="#section-3.6.3-2" class="pilcrow">¶</a></p>
<p id="section-3.6.3-3">If a server receives a Result TLV of failure with a fatal Error TLV,
it MUST send a cleartext EAP Failure.  If a peer receives a Result
TLV of failure, it MUST respond with a Result TLV indicating failure.
If the server has sent a Result TLV of failure, it ignores the peer
response, and it MUST send a cleartext EAP Failure.<a href="#section-3.6.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="fragmentation">
<section id="section-3.7">
        <h3 id="name-fragmentation">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-fragmentation" class="section-name selfRef">Fragmentation</a>
        </h3>
<p id="section-3.7-1">A single TLS record may be up to 16384 octets in length, but a TLS
message may span multiple TLS records, and a TLS certificate message
may, in principle, be as long as 16 MB.  This is larger than the
maximum size for a message on most media types; therefore, it is
desirable to support fragmentation.  Note that in order to protect
against reassembly lockup and denial-of-service attacks, it may be
desirable for an implementation to set a maximum size for one such
group of TLS messages.  Since a typical certificate chain is rarely
longer than a few thousand octets, and no other field is likely to be
anywhere near as long, a reasonable choice of maximum acceptable
message length might be 64 KB.  This is still a fairly large message
packet size so a TEAP implementation MUST provide its own support for
fragmentation and reassembly.  Section 3.1 of <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span> discusses
determining the MTU usable by EAP, and <a href="#tlv-rules" class="auto internal xref">Section 4.3</a> discusses
retransmissions in EAP.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<p id="section-3.7-2">Since EAP is a lock-step protocol, fragmentation support can be added
in a simple manner.  In EAP, fragments that are lost or damaged in
transit will be retransmitted, and since sequencing information is
provided by the Identifier field in EAP, there is no need for a
fragment offset field.<a href="#section-3.7-2" class="pilcrow">¶</a></p>
<p id="section-3.7-3">TEAP fragmentation support is provided through the addition of flag
bits within the EAP-Response and EAP-Request packets, as well as a
Message Length field of four octets.  Flags include the Length
included (L), More fragments (M), and TEAP Start (S) bits.  The L
flag is set to indicate the presence of the four-octet Message Length
field and MUST be set for the first fragment of a fragmented TLS
message or set of messages.  It MUST NOT be present for any other
message.  The M flag is set on all but the last fragment.  The S flag
is set only within the TEAP start message sent from the EAP server to
the peer.  The Message Length field is four octets and provides the
total length of the message that may be fragmented over the data
fields of multiple packets; this simplifies buffer allocation.<a href="#section-3.7-3" class="pilcrow">¶</a></p>
<p id="section-3.7-4">When a TEAP peer receives an EAP-Request packet with the M bit set,
it MUST respond with an EAP-Response with EAP Type of TEAP and no
data.  This serves as a fragment ACK.  The EAP server MUST wait until
it receives the EAP-Response before sending another fragment.  In
order to prevent errors in processing of fragments, the EAP server
MUST increment the Identifier field for each fragment contained
within an EAP-Request, and the peer MUST include this Identifier
value in the fragment ACK contained within the EAP-Response.
Retransmitted fragments will contain the same Identifier value.<a href="#section-3.7-4" class="pilcrow">¶</a></p>
<p id="section-3.7-5">Similarly, when the TEAP server receives an EAP-Response with the M
bit set, it responds with an EAP-Request with EAP Type of TEAP and no
data.  This serves as a fragment ACK.  The EAP peer MUST wait until
it receives the EAP-Request before sending another fragment.  In
order to prevent errors in the processing of fragments, the EAP
server MUST increment the Identifier value for each fragment ACK
contained within an EAP-Request, and the peer MUST include this
Identifier value in the subsequent fragment contained within an EAP-
Response.<a href="#section-3.7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="peer-services">
<section id="section-3.8">
        <h3 id="name-peer-services">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-peer-services" class="section-name selfRef">Peer Services</a>
        </h3>
<p id="section-3.8-1">Several TEAP services, including server unauthenticated provisioning,
PAC provisioning, certificate provisioning, and channel binding,
depend on the peer trusting the TEAP server.  Peers MUST authenticate
the server before these peer services are used.  TEAP peer
implementations MUST have a configuration where authentication fails
if server authentication cannot be achieved.  In many cases, the
server will want to authenticate the peer before providing these
services as well.<a href="#section-3.8-1" class="pilcrow">¶</a></p>
<p id="section-3.8-2">TEAP peers MUST track whether or not server authentication has taken
place.  Server authentication results if the peer trusts the provided
server certificate.  Typically, this involves both validating the
certificate to a trust anchor and confirming the entity named by the
certificate is the intended server.  Server authentication also
results when the procedures in <a href="#phase1" class="auto internal xref">Section 5.1</a> are used to resume a
session in which the peer and server were previously mutually
authenticated.  Alternatively, peer services can be used if an inner
EAP method providing mutual authentication and an Master Session Key
(MSK) and/or Extended Master Session Key (EMSK) that is executed and
cryptographic binding with the Compound Message Authentication Code
(MAC) which is correctly validated (<a href="#crypto-binding-tlv" class="auto internal xref">Section 4.2.13</a>).  This is further described in
<a href="#unauth-provisioning" class="auto internal xref">Section 3.8.3</a>.<a href="#section-3.8-2" class="pilcrow">¶</a></p>
<p id="section-3.8-3">An additional complication arises when an inner method authenticates
multiple parties such as authenticating both the peer machine and the
peer user to the EAP server.  Depending on how authentication is
achieved, only some of these parties may have confidence in it.  For
example, if a strong shared secret is used to mutually authenticate
the user and the EAP server, the machine may not have confidence that
the EAP server is the authenticated party if the machine cannot trust
the user not to disclose the shared secret to an attacker.  In these
cases, the parties who participate in the authentication need to be
considered when evaluating whether to use peer services.<a href="#section-3.8-3" class="pilcrow">¶</a></p>
<div id="pac-provisioning">
<section id="section-3.8.1">
          <h4 id="name-pac-provisioning">
<a href="#section-3.8.1" class="section-number selfRef">3.8.1. </a><a href="#name-pac-provisioning" class="section-name selfRef">PAC Provisioning</a>
          </h4>
<p id="section-3.8.1-1">To request provisioning of a PAC, a peer sends a PAC TLV as defined
in <a href="#pac-tlv-format" class="auto internal xref">Section 4.2.12</a> containing a PAC Attribute as defined in
<a href="#pac-attr-format" class="auto internal xref">Section 4.2.12.1</a> of PAC-Type set to the appropriate value.  The peer
MUST successfully authenticate the EAP server and validate the
Crypto-Binding TLV as defined in <a href="#crypto-binding-tlv" class="auto internal xref">Section 4.2.13</a> before issuing the
request.<a href="#section-3.8.1-1" class="pilcrow">¶</a></p>
<p id="section-3.8.1-2">The peer MAY only request a single Tunnel PAC it wants to be
provisioned. Additional PAC TLVs MUST be ignored by the server. The
EAP server will send the PAC after its internal policy has been
satisfied, or it MAY ignore the request or request additional
authentications if its policy dictates.  The server MAY cache the
request and provision the PACs requested after all of its internal
policies have been satisfied.  If a peer receives a PAC with an
unknown type, it MUST ignore it.  A PAC TLV containing a
PAC-Acknowledge attribute MUST be sent by the peer to acknowledge the
receipt of the Tunnel PAC.  A PAC TLV containing a PAC-Acknowledge
attribute MUST NOT be used by the peer to acknowledge the receipt of
other types of PACs.  If the peer receives a PAC TLV with an unknown
attribute, it SHOULD ignore the unknown attribute.<a href="#section-3.8.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cert-provisioning">
<section id="section-3.8.2">
          <h4 id="name-certificate-provisioning-wi">
<a href="#section-3.8.2" class="section-number selfRef">3.8.2. </a><a href="#name-certificate-provisioning-wi" class="section-name selfRef">Certificate Provisioning within the Tunnel</a>
          </h4>
<p id="section-3.8.2-1">Provisioning of a peer's certificate is supported in TEAP by
performing the Simple PKI Request/Response from <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>]</span> using
PKCS#10 and PKCS#7 TLVs, respectively.  A peer sends the Simple PKI
Request using a PKCS#10 CertificateRequest <span>[<a href="#RFC2986" class="cite xref">RFC2986</a>]</span> encoded into the
body of a PKCS#10 TLV (see <a href="#pkcs10-tlv" class="auto internal xref">Section 4.2.17</a>).  The TEAP server issues a
Simple PKI Response using a PKCS#7 <span>[<a href="#RFC2315" class="cite xref">RFC2315</a>]</span> degenerate "Certificates
Only" message encoded into the body of a PKCS#7 TLV (see
<a href="#pkcs7-tlv" class="auto internal xref">Section 4.2.16</a>), only after an authentication method has run and
provided an identity proof on the peer prior to a certificate is
being issued.<a href="#section-3.8.2-1" class="pilcrow">¶</a></p>
<p id="section-3.8.2-2">In order to provide linking identity and proof-of-possession by
including information specific to the current authenticated TLS
session within the signed certification request, the peer generating
the request SHOULD obtain the tls-unique value from the TLS subsystem
as defined in "Channel Bindings for TLS" <span>[<a href="#RFC5929" class="cite xref">RFC5929</a>]</span>.  The TEAP peer
operations between obtaining the tls_unique value through generation
of the Certification Signing Request (CSR) that contains the current
tls_unique value and the subsequent verification of this value by the
TEAP server are the "phases of the application protocol during which
application-layer authentication occurs" that are protected by the
synchronization interoperability mechanism described in the
interoperability note in "Channel Bindings for TLS" (<span>[<a href="#RFC5929" class="cite xref">RFC5929</a>]</span>,
Section 3.1).  When performing renegotiation, TLS
"secure_renegotiation" <span>[<a href="#RFC5746" class="cite xref">RFC5746</a>]</span> MUST be used.<a href="#section-3.8.2-2" class="pilcrow">¶</a></p>
<p id="section-3.8.2-3">The tls-unique value is base-64-encoded as specified in <a href="#message-formats" class="auto internal xref">Section 4</a> of
<span>[<a href="#RFC4648" class="cite xref">RFC4648</a>]</span>, and the resulting string is placed in the certification
request challengePassword field (<span>[<a href="#RFC2985" class="cite xref">RFC2985</a>]</span>, Section 5.4.1).  The
challengePassword field is limited to 255 octets (Section 7.4.9 of
<span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span> indicates that no existing ciphersuite would result in an
issue with this limitation).  If tls-unique information is not
embedded within the certification request, the challengePassword
field MUST be empty to indicate that the peer did not include the
optional channel-binding information (any value submitted is verified
by the server as tls-unique information).<a href="#section-3.8.2-3" class="pilcrow">¶</a></p>
<p id="section-3.8.2-4">The server SHOULD verify the tls-unique information.  This ensures
that the authenticated TEAP peer is in possession of the private key
used to sign the certification request.<a href="#section-3.8.2-4" class="pilcrow">¶</a></p>
<p id="section-3.8.2-5">The Simple PKI Request/Response generation and processing rules of
<span>[<a href="#RFC5272" class="cite xref">RFC5272</a>]</span> SHALL apply to TEAP, with the exception of error
conditions.  In the event of an error, the TEAP server SHOULD respond
with an Error TLV using the most descriptive error code possible; it
MAY ignore the PKCS#10 request that generated the error.<a href="#section-3.8.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unauth-provisioning">
<section id="section-3.8.3">
          <h4 id="name-server-unauthenticated-prov">
<a href="#section-3.8.3" class="section-number selfRef">3.8.3. </a><a href="#name-server-unauthenticated-prov" class="section-name selfRef">Server Unauthenticated Provisioning Mode</a>
          </h4>
<p id="section-3.8.3-1">In Server Unauthenticated Provisioning Mode, an unauthenticated
tunnel is established in Phase 1, and the peer and server negotiate
an EAP method in Phase 2 that supports mutual authentication and key
derivation that is resistant to attacks such as man-in-the-middle and
dictionary attacks.  This provisioning mode enables the bootstrapping
of peers when the peer lacks the ability to authenticate the server
during Phase 1.  This includes both cases in which the ciphersuite
negotiated does not provide authentication and in which the
ciphersuite negotiated provides the authentication but the peer is
unable to validate the identity of the server for some reason.<a href="#section-3.8.3-1" class="pilcrow">¶</a></p>
<p id="section-3.8.3-2">Upon successful completion of the EAP authentication method in Phase 2, the peer and
server exchange a Crypto-Binding TLV to bind the inner method with
the outer tunnel and ensure that a man-in-the-middle attack has not
been attempted.<a href="#section-3.8.3-2" class="pilcrow">¶</a></p>
<p id="section-3.8.3-3">Support for the Server Unauthenticated Provisioning Mode is optional.
The ciphersuite TLS_DH_anon_WITH_AES_128_CBC_SHA is RECOMMENDED when
using Server Unauthenticated Provisioning Mode, but other anonymous
ciphersuites MAY be supported as long as the TLS pre-master secret is
generated from contribution from both peers.  Phase 2 EAP authentication methods
used in Server Unauthenticated Provisioning Mode MUST provide mutual
authentication, provide key generation, and be resistant to
dictionary attack.  Example inner methods include EAP-pwd <span>[<a href="#RFC5931" class="cite xref">RFC5931</a>]</span>
and EAP-EKE <span>[<a href="#RFC6124" class="cite xref">RFC6124</a>]</span>, but not EAP-FAST-MSCHAPv2.<a href="#section-3.8.3-3" class="pilcrow">¶</a></p>
<p id="section-3.8.3-4">When a strong inner method is not used with Server Unauthenticated
Provisioning Mode, it is possible for an attacker to perform a
man-in-the-middle attack.  In effect, Server Unauthenticated
Provisioning Mode has similar security issues as just running the
inner method in the open, without the protection of TLS.  All of the
information in the tunnel should be assumed to be visible to, and
modifiable by, an attacker.<a href="#section-3.8.3-4" class="pilcrow">¶</a></p>
<p id="section-3.8.3-5">Implementations SHOULD exchange minimal data in Server
Unauthenticated Provisioning Mode.  Instead, they should use that mode
to set up a secure / authenticated tunnel, and then use that tunnel to
perform any needed data exchange.<a href="#section-3.8.3-5" class="pilcrow">¶</a></p>
<p id="section-3.8.3-6">It is RECOMMENDED that client implementations and deployments
authenticate TEAP servers if at all possible.  Authenticating the
server means that a PAC can be provisioned securely with no chance of
an attacker eaves-dropping on the connection.<a href="#section-3.8.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="channel-binding">
<section id="section-3.8.4">
          <h4 id="name-channel-binding">
<a href="#section-3.8.4" class="section-number selfRef">3.8.4. </a><a href="#name-channel-binding" class="section-name selfRef">Channel Binding</a>
          </h4>
<p id="section-3.8.4-1"><span>[<a href="#RFC6677" class="cite xref">RFC6677</a>]</span> defines EAP channel bindings to solve the "lying NAS" and
the "lying provider" problems, using a process in which the EAP peer
gives information about the characteristics of the service provided
by the authenticator to the Authentication, Authorization, and
Accounting (AAA) server protected within the EAP authentication method.  This allows
the server to verify the authenticator is providing information to
the peer that is consistent with the information received from this
authenticator as well as the information stored about this
authenticator.<a href="#section-3.8.4-1" class="pilcrow">¶</a></p>
<p id="section-3.8.4-2">TEAP supports EAP channel binding using the Channel-Binding TLV
defined in <a href="#channel-binding-tlv" class="auto internal xref">Section 4.2.7</a>.  If the TEAP server wants to request the
channel-binding information from the peer, it sends an empty Channel-
Binding TLV to indicate the request.  The peer responds to the
request by sending a Channel-Binding TLV containing a channel-binding
message as defined in <span>[<a href="#RFC6677" class="cite xref">RFC6677</a>]</span>.  The server validates the channel-
binding message and sends back a Channel-Binding TLV with a result
code.  If the server didn't initiate the channel-binding request and
the peer still wants to send the channel-binding information to the
server, it can do that by using the Request-Action TLV along with the
Channel-Binding TLV.  The peer MUST only send channel-binding
information after it has successfully authenticated the server and
established the protected tunnel.<a href="#section-3.8.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="message-formats">
<section id="section-4">
      <h2 id="name-message-formats">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-message-formats" class="section-name selfRef">Message Formats</a>
      </h2>
<p id="section-4-1">The following sections describe the message formats used in TEAP.
The fields are transmitted from left to right in network byte order.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="teap-message-format">
<section id="section-4.1">
        <h3 id="name-teap-message-format">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-teap-message-format" class="section-name selfRef">TEAP Message Format</a>
        </h3>
<p id="section-4.1-1">A summary of the TEAP Request/Response packet format is shown below.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Code      |   Identifier  |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |   Flags | Ver |        Message Length         :
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:         Message Length        |         Outer TLV Length
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:     Outer TLV Length          |         TLS Data...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Outer TLVs...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3">Code<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1-4.1">
            <p id="section-4.1-4.1.1">The Code field is one octet in length and is defined as follows:<a href="#section-4.1-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1-4.1.2.1">
                <p id="section-4.1-4.1.2.1.1">1 Request<a href="#section-4.1-4.1.2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.1-4.1.2.1.2">2 Response<a href="#section-4.1-4.1.2.1.2" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-4.1-5">Identifier<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1-6.1">
            <p id="section-4.1-6.1.1">The Identifier field is one octet and aids in matching responses
with requests.  The Identifier field MUST be changed on each
Request packet.  The Identifier field in the Response packet MUST
match the Identifier field from the corresponding request.<a href="#section-4.1-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-7">Length<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1-8.1">
            <p id="section-4.1-8.1.1">The Length field is two octets and indicates the length of the EAP
packet including the Code, Identifier, Length, Type, Flags, Ver,
Message Length, TLS Data, and Outer TLVs fields.  Octets outside
the range of the Length field should be treated as Data Link Layer
padding and should be ignored on reception.<a href="#section-4.1-8.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-9">Type<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1-10.1">
            <p id="section-4.1-10.1.1">55 for TEAP<a href="#section-4.1-10.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-11">Flags<a href="#section-4.1-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-12">
<pre>
       0 1 2 3 4
      +-+-+-+-+-+
      |L M S O R|
      +-+-+-+-+-+

   L  Length included; set to indicate the presence of the four-octet
      Message Length field.  It MUST be present for the first
      fragment of a fragmented message.  It MUST NOT be present for
      any other message.

   M  More fragments; set on all but the last fragment.

   S  TEAP start; set in a TEAP Start message sent from the server to
      the peer.

   O  Outer TLV length included; set to indicate the presence of the
      four-octet Outer TLV Length field.  It MUST be present only in
      the initial request and response messages.  If the initial
      message is fragmented, then it MUST be present only on the
      first fragment.

   R  Reserved (MUST be zero and ignored upon receipt)
</pre><a href="#section-4.1-12" class="pilcrow">¶</a>
</div>
<p id="section-4.1-13">Ver<a href="#section-4.1-13" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1-14.1">
            <p id="section-4.1-14.1.1">This field contains the version of the protocol.  This document
describes version 1 (001 in binary) of TEAP.<a href="#section-4.1-14.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-15">Message Length<a href="#section-4.1-15" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1-16.1">
            <p id="section-4.1-16.1.1">The Message Length field is four octets and is present only if the
L bit is set.  This field provides the total length of the message
that may be fragmented over the data fields of multiple packets.<a href="#section-4.1-16.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-17">Outer TLV Length<a href="#section-4.1-17" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1-18.1">
            <p id="section-4.1-18.1.1">The Outer TLV Length field is four octets and is present only if
the O bit is set.  This field provides the total length of the
Outer TLVs if present.<a href="#section-4.1-18.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-19">TLS Data<a href="#section-4.1-19" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1-20.1">
            <p id="section-4.1-20.1.1">When the TLS Data field is present, it consists of an encapsulated
TLS packet in TLS record format.  A TEAP packet with Flags and
Version fields, but with zero length TLS Data field, is used to
indicate TEAP acknowledgement for either a fragmented message, a
TLS Alert message, or a TLS Finished message.<a href="#section-4.1-20.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-21">Outer TLVs<a href="#section-4.1-21" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1-22.1">
            <p id="section-4.1-22.1.1">The Outer TLVs consist of the optional data used to help establish
the TLS tunnel in TLV format.  They are only allowed in the first
two messages in the TEAP protocol.  That is the first EAP-server-
to-peer message and first peer-to-EAP-server message.  The start
of the Outer TLVs can be derived from the EAP Length field and
Outer TLV Length field.<a href="#section-4.1-22.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="teap-tlv-format">
<section id="section-4.2">
        <h3 id="name-teap-tlv-format-and-support">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-teap-tlv-format-and-support" class="section-name selfRef">TEAP TLV Format and Support</a>
        </h3>
<p id="section-4.2-1">The TLVs defined here are TLV objects.  The TLV objects could be used
to carry arbitrary parameters between an EAP peer and EAP server
within the protected TLS tunnel.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">The EAP peer may not necessarily implement all the TLVs supported by
the EAP server.  To allow for interoperability, TLVs are designed to
allow an EAP server to discover if a TLV is supported by the EAP peer
using the NAK TLV.  The mandatory bit in a TLV indicates whether
support of the TLV is required.  If the peer or server does not
support a TLV marked mandatory, then it MUST send a NAK TLV in the
response, and all the other TLVs in the message MUST be ignored.  If
an EAP peer or server finds an unsupported TLV that is marked as
optional, it can ignore the unsupported TLV.  It MUST NOT send a NAK
TLV for a TLV that is not marked mandatory.  If all TLVs in a message
are marked optional and none are understood by the peer, then a NAK
TLV or Result TLV could be sent to the other side in order to
continue the conversation.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Note that a peer or server may support a TLV with the mandatory bit
set but may not understand the contents.  The appropriate response to
a supported TLV with content that is not understood is defined by the
individual TLV specification.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">EAP implementations compliant with this specification MUST support
TLV exchanges as well as the processing of mandatory/optional
settings on the TLV.  Implementations conforming to this
specification MUST support the following TLVs:<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2-5.1">
            <p id="section-4.2-5.1.1">Authority-ID TLV<a href="#section-4.2-5.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2-5.1.2">Identity-Type TLV<a href="#section-4.2-5.1.2" class="pilcrow">¶</a></p>
<p id="section-4.2-5.1.3">Result TLV<a href="#section-4.2-5.1.3" class="pilcrow">¶</a></p>
<p id="section-4.2-5.1.4">NAK TLV<a href="#section-4.2-5.1.4" class="pilcrow">¶</a></p>
<p id="section-4.2-5.1.5">Error TLV<a href="#section-4.2-5.1.5" class="pilcrow">¶</a></p>
<p id="section-4.2-5.1.6">Request-Action TLV<a href="#section-4.2-5.1.6" class="pilcrow">¶</a></p>
<p id="section-4.2-5.1.7">EAP-Payload TLV<a href="#section-4.2-5.1.7" class="pilcrow">¶</a></p>
<p id="section-4.2-5.1.8">Intermediate-Result TLV<a href="#section-4.2-5.1.8" class="pilcrow">¶</a></p>
<p id="section-4.2-5.1.9">Crypto-Binding TLV<a href="#section-4.2-5.1.9" class="pilcrow">¶</a></p>
<p id="section-4.2-5.1.10">Basic-Password-Auth-Req TLV<a href="#section-4.2-5.1.10" class="pilcrow">¶</a></p>
<p id="section-4.2-5.1.11">Basic-Password-Auth-Resp TLV<a href="#section-4.2-5.1.11" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="general-tlv-format">
<section id="section-4.2.1">
          <h4 id="name-general-tlv-format">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-general-tlv-format" class="section-name selfRef">General TLV Format</a>
          </h4>
<p id="section-4.2.1-1">TLVs are defined as described below.  The fields are transmitted from
left to right.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|            TLV Type       |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              Value...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-3">M<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.1-4.1">
              <p id="section-4.2.1-4.1.1">0  Optional TLV<a href="#section-4.2.1-4.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-4.1.2">1  Mandatory TLV<a href="#section-4.2.1-4.1.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.1-5">R<a href="#section-4.2.1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.1-6.1">
              <p id="section-4.2.1-6.1.1">Reserved, set to zero (0)<a href="#section-4.2.1-6.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.1-7">TLV Type<a href="#section-4.2.1-7" class="pilcrow">¶</a></p>
<p id="section-4.2.1-8">A 14-bit field, denoting the TLV type.  Allocated types include:<a href="#section-4.2.1-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.1-9.1">
              <p id="section-4.2.1-9.1.1">0  Unassigned<a href="#section-4.2.1-9.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9.1.2">1  Authority-ID TLV (<a href="#authority-id-tlv" class="auto internal xref">Section 4.2.2</a>)<a href="#section-4.2.1-9.1.2" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9.1.3">2  Identity-Type TLV (<a href="#identity-type-tlv" class="auto internal xref">Section 4.2.3</a>)<a href="#section-4.2.1-9.1.3" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9.1.4">3  Result TLV (<a href="#result-tlv" class="auto internal xref">Section 4.2.4</a>)<a href="#section-4.2.1-9.1.4" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9.1.5">4  NAK TLV (<a href="#nak-tlv" class="auto internal xref">Section 4.2.5</a>)<a href="#section-4.2.1-9.1.5" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9.1.6">5  Error TLV (<a href="#error-tlv" class="auto internal xref">Section 4.2.6</a>)<a href="#section-4.2.1-9.1.6" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9.1.7">6  Channel-Binding TLV (<a href="#channel-binding-tlv" class="auto internal xref">Section 4.2.7</a>)<a href="#section-4.2.1-9.1.7" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9.1.8">7  Vendor-Specific TLV (<a href="#vendor-specific-tlv" class="auto internal xref">Section 4.2.8</a>)<a href="#section-4.2.1-9.1.8" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9.1.9">8  Request-Action TLV (<a href="#request-action-tlv" class="auto internal xref">Section 4.2.9</a>)<a href="#section-4.2.1-9.1.9" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9.1.10">9  EAP-Payload TLV (<a href="#eap-payload-tlv" class="auto internal xref">Section 4.2.10</a>)<a href="#section-4.2.1-9.1.10" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9.1.11">10 Intermediate-Result TLV (<a href="#intermediate-result-tlv" class="auto internal xref">Section 4.2.11</a>)<a href="#section-4.2.1-9.1.11" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9.1.12">11 PAC TLV (<a href="#pac-tlv-format" class="auto internal xref">Section 4.2.12</a>)<a href="#section-4.2.1-9.1.12" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9.1.13">12 Crypto-Binding TLV (<a href="#crypto-binding-tlv" class="auto internal xref">Section 4.2.13</a>)<a href="#section-4.2.1-9.1.13" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9.1.14">13 Basic-Password-Auth-Req TLV (<a href="#bp-auth-req-tlv" class="auto internal xref">Section 4.2.14</a>)<a href="#section-4.2.1-9.1.14" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9.1.15">14 Basic-Password-Auth-Resp TLV (Section 4.2.15)<a href="#section-4.2.1-9.1.15" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9.1.16">15 PKCS#7 TLV (<a href="#pkcs7-tlv" class="auto internal xref">Section 4.2.16</a>)<a href="#section-4.2.1-9.1.16" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9.1.17">16 PKCS#10 TLV (<a href="#pkcs10-tlv" class="auto internal xref">Section 4.2.17</a>)<a href="#section-4.2.1-9.1.17" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9.1.18">17 Trusted-Server-Root TLV (<a href="#trusted-server-root-tlv" class="auto internal xref">Section 4.2.18</a>)<a href="#section-4.2.1-9.1.18" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.1-10">Length<a href="#section-4.2.1-10" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.1-11.1">
              <p id="section-4.2.1-11.1.1">The length of the Value field in octets.<a href="#section-4.2.1-11.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.1-12">Value<a href="#section-4.2.1-12" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.1-13.1">
              <p id="section-4.2.1-13.1.1">The value of the TLV.<a href="#section-4.2.1-13.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="authority-id-tlv">
<section id="section-4.2.2">
          <h4 id="name-authority-id-tlv">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-authority-id-tlv" class="section-name selfRef">Authority-ID TLV</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-4.2.2-1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              ID...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.2-1" class="pilcrow">¶</a>
</div>
<p id="section-4.2.2-2">M<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.2-3.1">
              <p id="section-4.2.2-3.1.1">0 - Optional TLV<a href="#section-4.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.2-4">R<a href="#section-4.2.2-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.2-5.1">
              <p id="section-4.2.2-5.1.1">Reserved, set to zero (0)<a href="#section-4.2.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.2-6">TLV Type<a href="#section-4.2.2-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.2-7.1">
              <p id="section-4.2.2-7.1.1">1 - Authority-ID<a href="#section-4.2.2-7.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.2-8">Length<a href="#section-4.2.2-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.2-9.1">
              <p id="section-4.2.2-9.1.1">The Length field is two octets and contains the length of the ID
field in octets.<a href="#section-4.2.2-9.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.2-10">ID<a href="#section-4.2.2-10" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.2-11.1">
              <p id="section-4.2.2-11.1.1">Hint of the identity of the server to help the peer to match the
credentials available for the server.  It should be unique across
the deployment.<a href="#section-4.2.2-11.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="identity-type-tlv">
<section id="section-4.2.3">
          <h4 id="name-identity-type-tlv">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-identity-type-tlv" class="section-name selfRef">Identity-Type TLV</a>
          </h4>
<p id="section-4.2.3-1">The Identity-Type TLV allows an EAP server to send a hint to help the
EAP peer select the right type of identity, for example, user or
machine.  TEAPv1 implementations MUST support this TLV.  Only one
Identity-Type TLV SHOULD be present in the TEAP request or response
packet.  The Identity-Type TLV request MUST come with an EAP-Payload
TLV or Basic-Password-Auth-Req TLV.  If the EAP peer does have an
identity corresponding to the identity type requested, then the peer
SHOULD respond with an Identity-Type TLV with the requested type.  If
the Identity-Type field does not contain one of the known values or
if the EAP peer does not have an identity corresponding to the
identity type requested, then the peer SHOULD respond with an
Identity-Type TLV with the one of available identity types.  If the
server receives an identity type in the response that does not match
the requested type, then the peer does not possess the requested
credential type, and the server SHOULD proceed with authentication
for the credential type proposed by the peer, proceed with requesting
another credential type, or simply apply the network policy based on
the configured policy, e.g., sending Result TLV with Failure.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3-2">The Identity-Type TLV is defined as follows:<a href="#section-4.2.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.3-3">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Identity-Type         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.3-3" class="pilcrow">¶</a>
</div>
<p id="section-4.2.3-4">M<a href="#section-4.2.3-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.3-5.1">
              <p id="section-4.2.3-5.1.1">Mandatory, set to one (1)<a href="#section-4.2.3-5.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.3-6">R<a href="#section-4.2.3-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.3-7.1">
              <p id="section-4.2.3-7.1.1">Reserved, set to zero (0)<a href="#section-4.2.3-7.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.3-8">TLV Type<a href="#section-4.2.3-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.3-9.1">
              <p id="section-4.2.3-9.1.1">2 - Identity-Type TLV<a href="#section-4.2.3-9.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.3-10">Length<a href="#section-4.2.3-10" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.3-11.1">
              <p id="section-4.2.3-11.1.1">2<a href="#section-4.2.3-11.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.3-12">Identity-Type<a href="#section-4.2.3-12" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.3-13.1">
              <p id="section-4.2.3-13.1.1">The Identity-Type field is two octets.  Values include:<a href="#section-4.2.3-13.1.1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.3-13.1.2.1">
                  <p id="section-4.2.3-13.1.2.1.1">1  User<a href="#section-4.2.3-13.1.2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.3-13.1.2.1.2">2  Machine<a href="#section-4.2.3-13.1.2.1.2" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
<div id="result-tlv">
<section id="section-4.2.4">
          <h4 id="name-result-tlv">
<a href="#section-4.2.4" class="section-number selfRef">4.2.4. </a><a href="#name-result-tlv" class="section-name selfRef">Result TLV</a>
          </h4>
<p id="section-4.2.4-1">The Result TLV provides support for acknowledged success and failure
messages for protected termination within TEAP.  If the Status field
does not contain one of the known values, then the peer or EAP server
MUST treat this as a fatal error of Unexpected TLVs Exchanged.  The
behavior of the Result TLV is further discussed in <a href="#protected-termination" class="auto internal xref">Section 3.3.4</a> and
<a href="#phase-2-errors" class="auto internal xref">Section 3.6.3</a>  A Result TLV indicating failure MUST NOT be accompanied by
the following TLVs: NAK, EAP-Payload TLV, or Crypto-Binding TLV.  The
Result TLV is defined as follows:<a href="#section-4.2.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.4-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             Status            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.4-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.4-3">M<a href="#section-4.2.4-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.4-4.1">
              <p id="section-4.2.4-4.1.1">Mandatory, set to one (1)<a href="#section-4.2.4-4.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.4-5">R<a href="#section-4.2.4-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.4-6.1">
              <p id="section-4.2.4-6.1.1">Reserved, set to zero (0)<a href="#section-4.2.4-6.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.4-7">TLV Type<a href="#section-4.2.4-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.4-8.1">
              <p id="section-4.2.4-8.1.1">3 - Result TLV<a href="#section-4.2.4-8.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.4-9">Length<a href="#section-4.2.4-9" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.4-10.1">
              <p id="section-4.2.4-10.1.1">2<a href="#section-4.2.4-10.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.4-11">Status<a href="#section-4.2.4-11" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.4-12.1">
              <p id="section-4.2.4-12.1.1">The Status field is two octets.  Values include:<a href="#section-4.2.4-12.1.1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.4-12.1.2.1">
                  <p id="section-4.2.4-12.1.2.1.1">1  Success<a href="#section-4.2.4-12.1.2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.4-12.1.2.1.2">2  Failure<a href="#section-4.2.4-12.1.2.1.2" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
<div id="nak-tlv">
<section id="section-4.2.5">
          <h4 id="name-nak-tlv">
<a href="#section-4.2.5" class="section-number selfRef">4.2.5. </a><a href="#name-nak-tlv" class="section-name selfRef">NAK TLV</a>
          </h4>
<p id="section-4.2.5-1">The NAK TLV allows a peer to detect TLVs that are not supported by
 the other peer.  A TEAP packet can contain 0 or more NAK TLVs.  A NAK
 TLV should not be accompanied by other TLVs.  A NAK TLV MUST NOT be
 sent in response to a message containing a Result TLV, instead a
 Result TLV of failure should be sent indicating failure and an Error
 TLV of Unexpected TLVs Exchanged.  The NAK TLV is defined as follows:<a href="#section-4.2.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.5-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Vendor-Id                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            NAK-Type           |           TLVs...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.5-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.5-3">M<a href="#section-4.2.5-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.5-4.1">
              <p id="section-4.2.5-4.1.1">Mandatory, set to one (1)<a href="#section-4.2.5-4.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.5-5">R<a href="#section-4.2.5-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.5-6.1">
              <p id="section-4.2.5-6.1.1">Reserved, set to zero (0)<a href="#section-4.2.5-6.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.5-7">TLV Type<a href="#section-4.2.5-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.5-8.1">
              <p id="section-4.2.5-8.1.1">4 - NAK TLV<a href="#section-4.2.5-8.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.5-9">Length<a href="#section-4.2.5-9" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.5-10.1">
              <p id="section-4.2.5-10.1.1">&gt;=6<a href="#section-4.2.5-10.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.5-11">Vendor-Id<a href="#section-4.2.5-11" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.5-12.1">
              <p id="section-4.2.5-12.1.1">The Vendor-Id field is four octets and contains the Vendor-Id of
the TLV that was not supported.  The high-order octet is 0, and
the low-order three octets are the Structure of Management
Information (SMI) Network Management Private Enterprise Number of
the Vendor in network byte order.  The Vendor-Id field MUST be
zero for TLVs that are not Vendor-Specific TLVs.<a href="#section-4.2.5-12.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.5-13">NAK-Type<a href="#section-4.2.5-13" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.5-14.1">
              <p id="section-4.2.5-14.1.1">The NAK-Type field is two octets.  The field contains the type of
the TLV that was not supported.  A TLV of this type MUST have been
included in the previous packet.<a href="#section-4.2.5-14.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.5-15">TLVs<a href="#section-4.2.5-15" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.5-16.1">
              <p id="section-4.2.5-16.1.1">This field contains a list of zero or more TLVs, each of which
MUST NOT have the mandatory bit set.  These optional TLVs are for
future extensibility to communicate why the offending TLV was
determined to be unsupported.<a href="#section-4.2.5-16.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="error-tlv">
<section id="section-4.2.6">
          <h4 id="name-error-tlv">
<a href="#section-4.2.6" class="section-number selfRef">4.2.6. </a><a href="#name-error-tlv" class="section-name selfRef">Error TLV</a>
          </h4>
<p id="section-4.2.6-1">The Error TLV allows an EAP peer or server to indicate errors to the
other party.  A TEAP packet can contain 0 or more Error TLVs.  The
Error-Code field describes the type of error.  Error codes 1-999
represent successful outcomes (informative messages), 1000-1999
represent warnings, and 2000-2999 represent fatal errors.  A fatal
Error TLV MUST be accompanied by a Result TLV indicating failure, and
the conversation is terminated as described in <a href="#phase-2-errors" class="auto internal xref">Section 3.6.3</a>.<a href="#section-4.2.6-1" class="pilcrow">¶</a></p>
<p id="section-4.2.6-2">Many of the error codes below refer to errors in inner method
processing that may be retrieved if made available by the inner
method.  Implementations MUST take care that error messages do not
reveal too much information to an attacker.  For example, the usage
of error message 1031 (User account credentials incorrect) is NOT
RECOMMENDED, because it allows an attacker to determine valid
usernames by differentiating this response from other responses.  It
should only be used for troubleshooting purposes.<a href="#section-4.2.6-2" class="pilcrow">¶</a></p>
<p id="section-4.2.6-3">The Error TLV is defined as follows:<a href="#section-4.2.6-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.6-4">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Error-Code                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.6-4" class="pilcrow">¶</a>
</div>
<p id="section-4.2.6-5">M<a href="#section-4.2.6-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.6-6.1">
              <p id="section-4.2.6-6.1.1">Mandatory, set to one (1)<a href="#section-4.2.6-6.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.6-7">R<a href="#section-4.2.6-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.6-8.1">
              <p id="section-4.2.6-8.1.1">Reserved, set to zero (0)<a href="#section-4.2.6-8.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.6-9">TLV Type<a href="#section-4.2.6-9" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.6-10.1">
              <p id="section-4.2.6-10.1.1">5 - Error TLV<a href="#section-4.2.6-10.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.6-11">Length<a href="#section-4.2.6-11" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.6-12.1">
              <p id="section-4.2.6-12.1.1">4<a href="#section-4.2.6-12.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.6-13">Error-Code<a href="#section-4.2.6-13" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.6-14.1">
              <p id="section-4.2.6-14.1.1">The Error-Code field is four octets.  Currently defined values for
Error-Code include:<a href="#section-4.2.6-14.1.1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.6-14.1.2.1">
                  <p id="section-4.2.6-14.1.2.1.1">1     User account expires soon<a href="#section-4.2.6-14.1.2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.2">2     User account credential expires soon<a href="#section-4.2.6-14.1.2.1.2" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.3">3     User account authorizations change soon<a href="#section-4.2.6-14.1.2.1.3" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.4">4     Clock skew detected<a href="#section-4.2.6-14.1.2.1.4" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.5">5     Contact administrator<a href="#section-4.2.6-14.1.2.1.5" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.6">6     User account credentials change required<a href="#section-4.2.6-14.1.2.1.6" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.7">1001  Inner Method Error<a href="#section-4.2.6-14.1.2.1.7" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.8">1002  Unspecified authentication infrastructure problem<a href="#section-4.2.6-14.1.2.1.8" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.9">1003  Unspecified authentication failure<a href="#section-4.2.6-14.1.2.1.9" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.10">1004  Unspecified authorization failure<a href="#section-4.2.6-14.1.2.1.10" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.11">1005  User account credentials unavailable<a href="#section-4.2.6-14.1.2.1.11" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.12">1006  User account expired<a href="#section-4.2.6-14.1.2.1.12" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.13">1007  User account locked: try again later<a href="#section-4.2.6-14.1.2.1.13" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.14">1008  User account locked: admin intervention required<a href="#section-4.2.6-14.1.2.1.14" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.15">1009  Authentication infrastructure unavailable<a href="#section-4.2.6-14.1.2.1.15" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.16">1010  Authentication infrastructure not trusted<a href="#section-4.2.6-14.1.2.1.16" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.17">1011  Clock skew too great<a href="#section-4.2.6-14.1.2.1.17" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.18">1012  Invalid inner realm<a href="#section-4.2.6-14.1.2.1.18" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.19">1013  Token out of sync: administrator intervention required<a href="#section-4.2.6-14.1.2.1.19" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.20">1014  Token out of sync: PIN change required<a href="#section-4.2.6-14.1.2.1.20" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.21">1015  Token revoked<a href="#section-4.2.6-14.1.2.1.21" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.22">1016  Tokens exhausted<a href="#section-4.2.6-14.1.2.1.22" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.23">1017  Challenge expired<a href="#section-4.2.6-14.1.2.1.23" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.24">1018  Challenge algorithm mismatch<a href="#section-4.2.6-14.1.2.1.24" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.25">1019  Client certificate not supplied<a href="#section-4.2.6-14.1.2.1.25" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.26">1020  Client certificate rejected<a href="#section-4.2.6-14.1.2.1.26" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.27">1021  Realm mismatch between inner and outer identity<a href="#section-4.2.6-14.1.2.1.27" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.28">1022  Unsupported Algorithm In Certificate Signing Request<a href="#section-4.2.6-14.1.2.1.28" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.29">1023  Unsupported Extension In Certificate Signing Request<a href="#section-4.2.6-14.1.2.1.29" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.30">1024  Bad Identity In Certificate Signing Request<a href="#section-4.2.6-14.1.2.1.30" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.31">1025  Bad Certificate Signing Request<a href="#section-4.2.6-14.1.2.1.31" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.32">1026  Internal CA Error<a href="#section-4.2.6-14.1.2.1.32" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.33">1027  General PKI Error<a href="#section-4.2.6-14.1.2.1.33" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.34">1028  Inner method's channel-binding data required but not
supplied<a href="#section-4.2.6-14.1.2.1.34" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.35">1029  Inner method's channel-binding data did not include required
information<a href="#section-4.2.6-14.1.2.1.35" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.36">1030  Inner method's channel binding failed<a href="#section-4.2.6-14.1.2.1.36" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.37">1031  User account credentials incorrect [USAGE NOT RECOMMENDED]<a href="#section-4.2.6-14.1.2.1.37" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.38">2001  Tunnel Compromise Error<a href="#section-4.2.6-14.1.2.1.38" class="pilcrow">¶</a></p>
<p id="section-4.2.6-14.1.2.1.39">2002  Unexpected TLVs Exchanged<a href="#section-4.2.6-14.1.2.1.39" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
<div id="channel-binding-tlv">
<section id="section-4.2.7">
          <h4 id="name-channel-binding-tlv">
<a href="#section-4.2.7" class="section-number selfRef">4.2.7. </a><a href="#name-channel-binding-tlv" class="section-name selfRef">Channel-Binding TLV</a>
          </h4>
<p id="section-4.2.7-1">The Channel-Binding TLV provides a mechanism for carrying channel-
binding data from the peer to the EAP server and a channel-binding
response from the EAP server to the peer as described in <span>[<a href="#RFC6677" class="cite xref">RFC6677</a>]</span>.
TEAPv1 implementations MAY support this TLV, which cannot be
responded to with a NAK TLV.  If the Channel-Binding data field does
not contain one of the known values or if the EAP server does not
support this TLV, then the server MUST ignore the value.  The
Channel-Binding TLV is defined as follows:<a href="#section-4.2.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.7-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Data ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.7-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.7-3">M<a href="#section-4.2.7-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.7-4.1">
              <p id="section-4.2.7-4.1.1">0 - Optional TLV<a href="#section-4.2.7-4.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.7-5">R<a href="#section-4.2.7-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.7-6.1">
              <p id="section-4.2.7-6.1.1">Reserved, set to zero (0)<a href="#section-4.2.7-6.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.7-7">TLV Type<a href="#section-4.2.7-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.7-8.1">
              <p id="section-4.2.7-8.1.1">6 - Channel-Binding TLV<a href="#section-4.2.7-8.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.7-9">Length<a href="#section-4.2.7-9" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.7-10.1">
              <p id="section-4.2.7-10.1.1">variable<a href="#section-4.2.7-10.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.7-11">Data<a href="#section-4.2.7-11" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.7-12.1">
              <p id="section-4.2.7-12.1.1">The data field contains a channel-binding message as defined in
Section 5.3 of <span>[<a href="#RFC6677" class="cite xref">RFC6677</a>]</span>.<a href="#section-4.2.7-12.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="vendor-specific-tlv">
<section id="section-4.2.8">
          <h4 id="name-vendor-specific-tlv">
<a href="#section-4.2.8" class="section-number selfRef">4.2.8. </a><a href="#name-vendor-specific-tlv" class="section-name selfRef">Vendor-Specific TLV</a>
          </h4>
<p id="section-4.2.8-1">The Vendor-Specific TLV is available to allow vendors to support
their own extended attributes not suitable for general usage.  A
Vendor-Specific TLV attribute can contain one or more TLVs, referred
to as Vendor TLVs.  The TLV type of a Vendor-TLV is defined by the
vendor.  All the Vendor TLVs inside a single Vendor-Specific TLV
belong to the same vendor.  There can be multiple Vendor-Specific
TLVs from different vendors in the same message.  Error handling in
the Vendor TLV could use the vendor's own specific error-handling
mechanism or use the standard TEAP error codes defined.<a href="#section-4.2.8-1" class="pilcrow">¶</a></p>
<p id="section-4.2.8-2">Vendor TLVs may be optional or mandatory.  Vendor TLVs sent with
Result TLVs MUST be marked as optional.  If the Vendor-Specific TLV
is marked as mandatory, then it is expected that the receiving side
needs to recognize the vendor ID, parse all Vendor TLVs within, and
deal with error handling within the Vendor-Specific TLV as defined by
the vendor.<a href="#section-4.2.8-2" class="pilcrow">¶</a></p>
<p id="section-4.2.8-3">Where a Vendor-Specific TLV carries an authentication protocol in the
inner method, it MUST define values for MSK and EMSK.  Where these
values cannot be derived from cryptographic primitives, they MUST be
set to zero, as happens when Basic-Password-Auth-Req is used.<a href="#section-4.2.8-3" class="pilcrow">¶</a></p>
<p id="section-4.2.8-4">The Vendor-Specific TLV is defined as follows:<a href="#section-4.2.8-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.8-5">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Vendor-Id                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Vendor TLVs....
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.8-5" class="pilcrow">¶</a>
</div>
<p id="section-4.2.8-6">M<a href="#section-4.2.8-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.8-7.1">
              <p id="section-4.2.8-7.1.1">0 or 1<a href="#section-4.2.8-7.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.8-8">R<a href="#section-4.2.8-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.8-9.1">
              <p id="section-4.2.8-9.1.1">Reserved, set to zero (0)<a href="#section-4.2.8-9.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.8-10">TLV Type<a href="#section-4.2.8-10" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.8-11.1">
              <p id="section-4.2.8-11.1.1">7 - Vendor-Specific TLV<a href="#section-4.2.8-11.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.8-12">Length<a href="#section-4.2.8-12" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.8-13.1">
              <p id="section-4.2.8-13.1.1">4 + cumulative length of all included Vendor TLVs<a href="#section-4.2.8-13.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.8-14">Vendor-Id<a href="#section-4.2.8-14" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.8-15.1">
              <p id="section-4.2.8-15.1.1">The Vendor-Id field is four octets and contains the Vendor-Id of
the TLV.  The high-order octet is 0, and the low-order 3 octets
are the SMI Network Management Private Enterprise Number of the
Vendor in network byte order.<a href="#section-4.2.8-15.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.8-16">Vendor TLVs<a href="#section-4.2.8-16" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.8-17.1">
              <p id="section-4.2.8-17.1.1">This field is of indefinite length.  It contains Vendor-Specific
TLVs, in a format defined by the vendor.<a href="#section-4.2.8-17.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="request-action-tlv">
<section id="section-4.2.9">
          <h4 id="name-request-action-tlv">
<a href="#section-4.2.9" class="section-number selfRef">4.2.9. </a><a href="#name-request-action-tlv" class="section-name selfRef">Request-Action TLV</a>
          </h4>
<p id="section-4.2.9-1">The Request-Action TLV MAY be sent by both the peer and the server in
response to a successful or failed Result TLV.  It allows the peer or
server to request the other side to negotiate additional inner methods
or process TLVs specified in the response packet.  The receiving side
MUST process this TLV.  The processing for the TLV is as follows:<a href="#section-4.2.9-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.9-2.1">
              <p id="section-4.2.9-2.1.1">The receiving entity MAY choose to process any of the TLVs that
are included in the message.<a href="#section-4.2.9-2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.9-2.1.2">If the receiving entity chooses NOT to process any TLV in the
list, then it sends back a Result TLV with the same code in the
Status field of the Request-Action TLV.<a href="#section-4.2.9-2.1.2" class="pilcrow">¶</a></p>
<p id="section-4.2.9-2.1.3">If multiple Request-Action TLVs are in the request, the session
can continue if any of the TLVs in any Request-Action TLV are
processed.<a href="#section-4.2.9-2.1.3" class="pilcrow">¶</a></p>
</li>
          </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.9-3.1">
              <p id="section-4.2.9-3.1.1">If multiple Request-Action TLVs are in the request and none of
them is processed, then the most fatal status should be used in
the Result TLV returned.  If a status code in the Request-Action
TLV is not understood by the receiving entity, then it should be
treated as a fatal error.<a href="#section-4.2.9-3.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.9-3.1.2">After processing the TLVs or inner method in the request, another
round of Result TLV exchange would occur to synchronize the final
status on both sides.<a href="#section-4.2.9-3.1.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.9-4">The peer or the server MAY send multiple Request-Action TLVs to the
other side.  Two Request-Action TLVs MUST NOT occur in the same TEAP
packet if they have the same Status value.  The order of processing
multiple Request-Action TLVs is implementation dependent.  If the
receiving side processes the optional (non-fatal) items first, it is
possible that the fatal items will disappear at a later time.  If the
receiving side processes the fatal items first, the communication
time will be shorter.<a href="#section-4.2.9-4" class="pilcrow">¶</a></p>
<p id="section-4.2.9-5">The peer or the server MAY return a new set of Request-Action TLVs
after one or more of the requested items has been processed and the
other side has signaled it wants to end the EAP conversation.<a href="#section-4.2.9-5" class="pilcrow">¶</a></p>
<p id="section-4.2.9-6">The Request-Action TLV is defined as follows:<a href="#section-4.2.9-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.9-7">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Status   |      Action    |                TLVs....
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+--+-+-+-+-+-+-+-+-+-+-+-+-
</pre><a href="#section-4.2.9-7" class="pilcrow">¶</a>
</div>
<p id="section-4.2.9-8">M<a href="#section-4.2.9-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.9-9.1">
              <p id="section-4.2.9-9.1.1">Mandatory, set to one (1)<a href="#section-4.2.9-9.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.9-10">R<a href="#section-4.2.9-10" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.9-11.1">
              <p id="section-4.2.9-11.1.1">Reserved, set to zero (0)<a href="#section-4.2.9-11.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.9-12">TLV Type<a href="#section-4.2.9-12" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.9-13.1">
              <p id="section-4.2.9-13.1.1">8 - Request-Action TLV<a href="#section-4.2.9-13.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.9-14">Length<a href="#section-4.2.9-14" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.9-15.1">
              <p id="section-4.2.9-15.1.1">2 + cumulative length of all included TLVs<a href="#section-4.2.9-15.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.9-16">Status<a href="#section-4.2.9-16" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.9-17.1">
              <p id="section-4.2.9-17.1.1">The Status field is one octet.  This indicates the result if the
party who receives this TLV does not process the action. Values
include:<a href="#section-4.2.9-17.1.1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.9-17.1.2.1">
                  <p id="section-4.2.9-17.1.2.1.1">1  Success<a href="#section-4.2.9-17.1.2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.9-17.1.2.1.2">2  Failure<a href="#section-4.2.9-17.1.2.1.2" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-4.2.9-18">Action<a href="#section-4.2.9-18" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.9-19.1">
              <p id="section-4.2.9-19.1.1">The Action field is one octet.  Values include:<a href="#section-4.2.9-19.1.1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.9-19.1.2.1">
                  <p id="section-4.2.9-19.1.2.1.1">1  Process-TLV<a href="#section-4.2.9-19.1.2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.9-19.1.2.1.2">2  Negotiate-EAP<a href="#section-4.2.9-19.1.2.1.2" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-4.2.9-20">TLVs<a href="#section-4.2.9-20" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.9-21.1">
              <p id="section-4.2.9-21.1.1">This field is of indefinite length.  It contains TLVs that the
peer wants the server to process.<a href="#section-4.2.9-21.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="eap-payload-tlv">
<section id="section-4.2.10">
          <h4 id="name-eap-payload-tlv">
<a href="#section-4.2.10" class="section-number selfRef">4.2.10. </a><a href="#name-eap-payload-tlv" class="section-name selfRef">EAP-Payload TLV</a>
          </h4>
<p id="section-4.2.10-1">To allow piggybacking an EAP request or response with other TLVs, the
EAP-Payload TLV is defined, which includes an encapsulated EAP packet
and a list of optional TLVs.  The optional TLVs are provided for
future extensibility to provide hints about the current EAP
authentication.  Only one EAP-Payload TLV is allowed in a message.
The EAP-Payload TLV is defined as follows:<a href="#section-4.2.10-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.10-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          EAP packet...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                             TLVs...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.10-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.10-3">M<a href="#section-4.2.10-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.10-4.1">
              <p id="section-4.2.10-4.1.1">Mandatory, set to one (1)<a href="#section-4.2.10-4.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.10-5">R<a href="#section-4.2.10-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.10-6.1">
              <p id="section-4.2.10-6.1.1">Reserved, set to zero (0)<a href="#section-4.2.10-6.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.10-7">TLV Type<a href="#section-4.2.10-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.10-8.1">
              <p id="section-4.2.10-8.1.1">9 - EAP-Payload TLV<a href="#section-4.2.10-8.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.10-9">Length<a href="#section-4.2.10-9" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.10-10.1">
              <p id="section-4.2.10-10.1.1">length of embedded EAP packet + cumulative length of additional
TLVs<a href="#section-4.2.10-10.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.10-11">EAP packet<a href="#section-4.2.10-11" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.10-12.1">
              <p id="section-4.2.10-12.1.1">This field contains a complete EAP packet, including the EAP
header (Code, Identifier, Length, Type) fields.  The length of
this field is determined by the Length field of the encapsulated
EAP packet.<a href="#section-4.2.10-12.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.10-13">TLVs<a href="#section-4.2.10-13" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.10-14.1">
              <p id="section-4.2.10-14.1.1">This (optional) field contains a list of TLVs associated with the
EAP packet field.  The TLVs MUST NOT have the mandatory bit set.
The total length of this field is equal to the Length field of the
EAP-Payload TLV, minus the Length field in the EAP header of the
EAP packet field.<a href="#section-4.2.10-14.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="intermediate-result-tlv">
<section id="section-4.2.11">
          <h4 id="name-intermediate-result-tlv">
<a href="#section-4.2.11" class="section-number selfRef">4.2.11. </a><a href="#name-intermediate-result-tlv" class="section-name selfRef">Intermediate-Result TLV</a>
          </h4>
<p id="section-4.2.11-1">The Intermediate-Result TLV signals
intermediate Success and Failure messages for all inner
methods.  The Intermediate-Result TLV MUST be be used for all inner methods.<a href="#section-4.2.11-1" class="pilcrow">¶</a></p>
<p id="section-4.2.11-2">An Intermediate-Result TLV indicating Success
MUST be accompanied by a Crypto-Binding TLV.<a href="#section-4.2.11-2" class="pilcrow">¶</a></p>
<p id="section-4.2.11-3">An Intermediate-Result TLV indicating Failure SHOULD be accompanied by an Error TLV which indicates why the authentication failed.<a href="#section-4.2.11-3" class="pilcrow">¶</a></p>
<p id="section-4.2.11-4">The optional TLVs
associated with this TLV are provided for future extensibility to
provide hints about the current result.  The Intermediate-Result TLV
is defined as follows:<a href="#section-4.2.11-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.11-5">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             Status            |        TLVs...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.11-5" class="pilcrow">¶</a>
</div>
<p id="section-4.2.11-6">M<a href="#section-4.2.11-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.11-7.1">
              <p id="section-4.2.11-7.1.1">Mandatory, set to one (1)<a href="#section-4.2.11-7.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.11-8">R<a href="#section-4.2.11-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.11-9.1">
              <p id="section-4.2.11-9.1.1">Reserved, set to zero (0)<a href="#section-4.2.11-9.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.11-10">TLV Type<a href="#section-4.2.11-10" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.11-11.1">
              <p id="section-4.2.11-11.1.1">10 - Intermediate-Result TLV<a href="#section-4.2.11-11.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.11-12">Length<a href="#section-4.2.11-12" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.11-13.1">
              <p id="section-4.2.11-13.1.1">2 + cumulative length of the embedded associated TLVs<a href="#section-4.2.11-13.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.11-14">Status<a href="#section-4.2.11-14" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.11-15.1">
              <p id="section-4.2.11-15.1.1">The Status field is two octets.  Values include:<a href="#section-4.2.11-15.1.1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.11-15.1.2.1">
                  <p id="section-4.2.11-15.1.2.1.1">1  Success<a href="#section-4.2.11-15.1.2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.11-15.1.2.1.2">2  Failure<a href="#section-4.2.11-15.1.2.1.2" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-4.2.11-16">TLVs<a href="#section-4.2.11-16" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.11-17.1">
              <p id="section-4.2.11-17.1.1">This field is of indeterminate length and contains zero or more of
the TLVs associated with the Intermediate Result TLV.  The TLVs in
this field MUST NOT have the mandatory bit set.<a href="#section-4.2.11-17.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="pac-tlv-format">
<section id="section-4.2.12">
          <h4 id="name-pac-tlv-format">
<a href="#section-4.2.12" class="section-number selfRef">4.2.12. </a><a href="#name-pac-tlv-format" class="section-name selfRef">PAC TLV Format</a>
          </h4>
<p id="section-4.2.12-1">The PAC TLV provides support for provisioning the Protected Access
Credential (PAC).  The PAC TLV carries the PAC and related
information within PAC attribute fields.  Additionally, the PAC TLV
MAY be used by the peer to request provisioning of a PAC of the type
specified in the PAC-Type PAC attribute.  The PAC TLV MUST only be
used in a protected tunnel providing encryption and integrity
protection.  A general PAC TLV format is defined as follows:<a href="#section-4.2.12-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.12-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        PAC Attributes...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.12-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.12-3">M<a href="#section-4.2.12-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12-4.1">
              <p id="section-4.2.12-4.1.1">0 or 1<a href="#section-4.2.12-4.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.12-5">R<a href="#section-4.2.12-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12-6.1">
              <p id="section-4.2.12-6.1.1">Reserved, set to zero (0)<a href="#section-4.2.12-6.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.12-7">TLV Type<a href="#section-4.2.12-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12-8.1">
              <p id="section-4.2.12-8.1.1">11 - PAC TLV<a href="#section-4.2.12-8.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.12-9">Length<a href="#section-4.2.12-9" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12-10.1">
              <p id="section-4.2.12-10.1.1">Two octets containing the length of the PAC Attributes field in
octets.<a href="#section-4.2.12-10.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.12-11">PAC Attributes<a href="#section-4.2.12-11" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12-12.1">
              <p id="section-4.2.12-12.1.1">A list of PAC attributes in the TLV format.<a href="#section-4.2.12-12.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div id="pac-attr-format">
<section id="section-4.2.12.1">
            <h5 id="name-formats-for-pac-attributes">
<a href="#section-4.2.12.1" class="section-number selfRef">4.2.12.1. </a><a href="#name-formats-for-pac-attributes" class="section-name selfRef">Formats for PAC Attributes</a>
            </h5>
<p id="section-4.2.12.1-1">Each PAC attribute in a PAC TLV is formatted as a TLV defined as
follows:<a href="#section-4.2.12.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.12.1-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Type               |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              Value...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.12.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.12.1-3">Type<a href="#section-4.2.12.1-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.1-4.1">
                <p id="section-4.2.12.1-4.1.1">The Type field is two octets, denoting the attribute type.
Allocated types include:<a href="#section-4.2.12.1-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.1-4.1.2.1">
                    <p id="section-4.2.12.1-4.1.2.1.1">1 - PAC-Key<a href="#section-4.2.12.1-4.1.2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.12.1-4.1.2.1.2">2 - PAC-Opaque<a href="#section-4.2.12.1-4.1.2.1.2" class="pilcrow">¶</a></p>
<p id="section-4.2.12.1-4.1.2.1.3">3 - PAC-Lifetime<a href="#section-4.2.12.1-4.1.2.1.3" class="pilcrow">¶</a></p>
<p id="section-4.2.12.1-4.1.2.1.4">4 - A-ID<a href="#section-4.2.12.1-4.1.2.1.4" class="pilcrow">¶</a></p>
<p id="section-4.2.12.1-4.1.2.1.5">5 - I-ID<a href="#section-4.2.12.1-4.1.2.1.5" class="pilcrow">¶</a></p>
<p id="section-4.2.12.1-4.1.2.1.6">6 - Reserved<a href="#section-4.2.12.1-4.1.2.1.6" class="pilcrow">¶</a></p>
<p id="section-4.2.12.1-4.1.2.1.7">7 - A-ID-Info<a href="#section-4.2.12.1-4.1.2.1.7" class="pilcrow">¶</a></p>
<p id="section-4.2.12.1-4.1.2.1.8">8 - PAC-Acknowledgement<a href="#section-4.2.12.1-4.1.2.1.8" class="pilcrow">¶</a></p>
<p id="section-4.2.12.1-4.1.2.1.9">9 - PAC-Info<a href="#section-4.2.12.1-4.1.2.1.9" class="pilcrow">¶</a></p>
<p id="section-4.2.12.1-4.1.2.1.10">10 - PAC-Type<a href="#section-4.2.12.1-4.1.2.1.10" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
<p id="section-4.2.12.1-5">Length<a href="#section-4.2.12.1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.1-6.1">
                <p id="section-4.2.12.1-6.1.1">Two octets containing the length of the Value field in octets.<a href="#section-4.2.12.1-6.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.2.12.1-7">Value<a href="#section-4.2.12.1-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.1-8.1">
                <p id="section-4.2.12.1-8.1.1">The value of the PAC attribute.<a href="#section-4.2.12.1-8.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="pac-key">
<section id="section-4.2.12.2">
            <h5 id="name-pac-key">
<a href="#section-4.2.12.2" class="section-number selfRef">4.2.12.2. </a><a href="#name-pac-key" class="section-name selfRef">PAC-Key</a>
            </h5>
<p id="section-4.2.12.2-1">The PAC-Key is a secret key distributed in a PAC attribute of type
PAC-Key.  The PAC-Key attribute is included within the PAC TLV
whenever the server wishes to issue or renew a PAC that is bound to a
key such as a Tunnel PAC.  The key is a randomly generated octet
string that is 48 octets in length.  The generator of this key is the
issuer of the credential, which is identified by the Authority
Identifier (A-ID).<a href="#section-4.2.12.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.12.2-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Type               |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                              Key                              ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.12.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.12.2-3">Type<a href="#section-4.2.12.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.2-4.1">
                <p id="section-4.2.12.2-4.1.1">1 - PAC-Key<a href="#section-4.2.12.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.2.12.2-5">Length<a href="#section-4.2.12.2-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.2-6.1">
                <p id="section-4.2.12.2-6.1.1">2-octet length indicating the length of the key.<a href="#section-4.2.12.2-6.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.2.12.2-7">Key<a href="#section-4.2.12.2-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.2-8.1">
                <p id="section-4.2.12.2-8.1.1">The value of the PAC-Key.<a href="#section-4.2.12.2-8.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="pac-opaque">
<section id="section-4.2.12.3">
            <h5 id="name-pac-opaque">
<a href="#section-4.2.12.3" class="section-number selfRef">4.2.12.3. </a><a href="#name-pac-opaque" class="section-name selfRef">PAC-Opaque</a>
            </h5>
<p id="section-4.2.12.3-1">The PAC-Opaque attribute is included within the PAC TLV whenever the
server wishes to issue or renew a PAC.<a href="#section-4.2.12.3-1" class="pilcrow">¶</a></p>
<p id="section-4.2.12.3-2">The PAC-Opaque is opaque to the peer, and thus the peer MUST NOT
attempt to interpret it.  A peer that has been issued a PAC-Opaque by
a server stores that data and presents it back to the server
according to its PAC-Type.  The Tunnel PAC is used in the ClientHello
SessionTicket extension field defined in <span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span>.  If a peer has
opaque data issued to it by multiple servers, then it stores the data
issued by each server separately according to the A-ID.  This
requirement allows the peer to maintain and use each opaque datum as
an independent PAC pairing, with a PAC-Key mapping to a PAC-Opaque
identified by the A-ID.  As there is a one-to-one correspondence
between the PAC-Key and PAC-Opaque, the peer determines the PAC-Key
and corresponding PAC-Opaque based on the A-ID provided in the
TEAP/Start message and the A-ID provided in the PAC-Info when it was
provisioned with a PAC-Opaque.<a href="#section-4.2.12.3-2" class="pilcrow">¶</a></p>
<p id="section-4.2.12.3-3">The PAC-Opaque attribute format is summarized as follows:<a href="#section-4.2.12.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.12.3-4">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Type               |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              Value ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.12.3-4" class="pilcrow">¶</a>
</div>
<p id="section-4.2.12.3-5">Type<a href="#section-4.2.12.3-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.3-6.1">
                <p id="section-4.2.12.3-6.1.1">2 - PAC-Opaque<a href="#section-4.2.12.3-6.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.2.12.3-7">Length<a href="#section-4.2.12.3-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.3-8.1">
                <p id="section-4.2.12.3-8.1.1">The Length field is two octets, which contains the length of the
Value field in octets.<a href="#section-4.2.12.3-8.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.2.12.3-9">Value<a href="#section-4.2.12.3-9" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.3-10.1">
                <p id="section-4.2.12.3-10.1.1">The Value field contains the actual data for the PAC-Opaque.  It
is specific to the server implementation.<a href="#section-4.2.12.3-10.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="pac-info">
<section id="section-4.2.12.4">
            <h5 id="name-pac-info">
<a href="#section-4.2.12.4" class="section-number selfRef">4.2.12.4. </a><a href="#name-pac-info" class="section-name selfRef">PAC-Info</a>
            </h5>
<p id="section-4.2.12.4-1">The PAC-Info is comprised of a set of PAC attributes as defined in
<a href="#pac-attr-format" class="auto internal xref">Section 4.2.12.1</a>.  The PAC-Info attribute MUST contain the A-ID,
A-ID-Info, and PAC-Type attributes.  Other attributes MAY be included
in the PAC-Info to provide more information to the peer.  The
PAC-Info attribute MUST NOT contain the PAC-Key, PAC-Acknowledgement,
PAC-Info, or PAC-Opaque attributes.  The PAC-Info attribute is
included within the PAC TLV whenever the server wishes to issue or
renew a PAC.<a href="#section-4.2.12.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.12.4-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Type               |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Attributes...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.12.4-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.12.4-3">Type<a href="#section-4.2.12.4-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.4-4.1">
                <p id="section-4.2.12.4-4.1.1">9 - PAC-Info<a href="#section-4.2.12.4-4.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.2.12.4-5">Length<a href="#section-4.2.12.4-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.4-6.1">
                <p id="section-4.2.12.4-6.1.1">2-octet field containing the length of the Attributes field in
octets.<a href="#section-4.2.12.4-6.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.2.12.4-7">Attributes<a href="#section-4.2.12.4-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.4-8.1">
                <p id="section-4.2.12.4-8.1.1">The Attributes field contains a list of PAC attributes.  Each
mandatory and optional field type is defined as follows:<a href="#section-4.2.12.4-8.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.12.4-8.1.2">3 - PAC-Lifetime<a href="#section-4.2.12.4-8.1.2" class="pilcrow">¶</a></p>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.4-9.1">
                <ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.4-9.1.1.1">
                    <p id="section-4.2.12.4-9.1.1.1.1">This is a 4-octet quantity representing the expiration time of
the credential expressed as the number of seconds, excluding
leap seconds, after midnight UTC, January 1, 1970.  This
attribute MAY be provided to the peer as part of the PAC-Info.<a href="#section-4.2.12.4-9.1.1.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
<p id="section-4.2.12.4-9.1.2">4 - A-ID<a href="#section-4.2.12.4-9.1.2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.4-9.1.3.1">
                    <p id="section-4.2.12.4-9.1.3.1.1">The A-ID is the identity of the authority that issued the PAC.
The A-ID is intended to be unique across all issuing servers to
avoid namespace collisions.  The A-ID is used by the peer to
determine which PAC to employ.  The A-ID is treated as an
opaque octet string.  This attribute MUST be included in the
PAC-Info attribute.  The A-ID MUST match the Authority-ID the
server used to establish the tunnel.  One method for generating
the A-ID is to use a high-quality random number generator to
generate a random number.  An alternate method would be to take
the hash of the public key or public key certificate belonging
to a server represented by the A-ID.<a href="#section-4.2.12.4-9.1.3.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
<p id="section-4.2.12.4-9.1.4">5 - I-ID<a href="#section-4.2.12.4-9.1.4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.4-9.1.5.1">
                    <p id="section-4.2.12.4-9.1.5.1.1">Initiator Identifier (I-ID) is the peer identity associated
with the credential.  This identity is derived from the inner
authentication or from the client-side authentication during
tunnel establishment if an inner method is not used.  The
server employs the I-ID in the TEAP Phase 2 conversation to
validate that the same peer identity used to execute TEAP Phase
1 is also used in at minimum one inner methods in TEAP
Phase 2.  If the server is enforcing the I-ID validation on the
inner method, then the I-ID MUST be included in the
PAC-Info, to enable the peer to also enforce a unique PAC for
each unique user.  If the I-ID is missing from the PAC-Info, it
is assumed that the Tunnel PAC can be used for multiple users
and the peer will not enforce the unique-Tunnel-PAC-per-user
policy.<a href="#section-4.2.12.4-9.1.5.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
<p id="section-4.2.12.4-9.1.6">7 - A-ID-Info<a href="#section-4.2.12.4-9.1.6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.4-9.1.7.1">
                    <p id="section-4.2.12.4-9.1.7.1.1">Authority Identifier Information is intended to provide a user-
friendly name for the A-ID.  It may contain the enterprise name
and server name in a human-readable format.  This TLV serves as
an aid to the peer to better inform the end user about the
A-ID.  The name is encoded in UTF-8 <span>[<a href="#RFC3629" class="cite xref">RFC3629</a>]</span> format.  This
attribute MUST be included in the PAC-Info.<a href="#section-4.2.12.4-9.1.7.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
<p id="section-4.2.12.4-9.1.8">10 - PAC-Type<a href="#section-4.2.12.4-9.1.8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.4-9.1.9.1">
                    <p id="section-4.2.12.4-9.1.9.1.1">The PAC-Type is intended to provide the type of PAC.  This
attribute SHOULD be included in the PAC-Info.  If the PAC-Type
is not present, then it defaults to a Tunnel PAC (Type 1).<a href="#section-4.2.12.4-9.1.9.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</section>
</div>
<div id="pac-acknowledgement-tlv">
<section id="section-4.2.12.5">
            <h5 id="name-pac-acknowledgement-tlv">
<a href="#section-4.2.12.5" class="section-number selfRef">4.2.12.5. </a><a href="#name-pac-acknowledgement-tlv" class="section-name selfRef">PAC-Acknowledgement TLV</a>
            </h5>
<p id="section-4.2.12.5-1">The PAC-Acknowledgement is used to acknowledge the receipt of the
Tunnel PAC by the peer.  The peer includes the PAC-Acknowledgement
TLV in a PAC TLV sent to the server to indicate the result of the
processing and storing of a newly provisioned Tunnel PAC.  This TLV
is only used when Tunnel PAC is provisioned.<a href="#section-4.2.12.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.12.5-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Type               |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Result             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.12.5-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.12.5-3">Type<a href="#section-4.2.12.5-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.5-4.1">
                <p id="section-4.2.12.5-4.1.1">8 - PAC-Acknowledgement<a href="#section-4.2.12.5-4.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.2.12.5-5">Length<a href="#section-4.2.12.5-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.5-6.1">
                <p id="section-4.2.12.5-6.1.1">The length of this field is two octets containing a value of 2.<a href="#section-4.2.12.5-6.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.2.12.5-7">Result<a href="#section-4.2.12.5-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.5-8.1">
                <p id="section-4.2.12.5-8.1.1">The resulting value MUST be one of the following:<a href="#section-4.2.12.5-8.1.1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.5-8.1.2.1">
                    <p id="section-4.2.12.5-8.1.2.1.1">1 - Success<a href="#section-4.2.12.5-8.1.2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.12.5-8.1.2.1.2">2 - Failure<a href="#section-4.2.12.5-8.1.2.1.2" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</section>
</div>
<div id="pac-type-tlv">
<section id="section-4.2.12.6">
            <h5 id="name-pac-type-tlv">
<a href="#section-4.2.12.6" class="section-number selfRef">4.2.12.6. </a><a href="#name-pac-type-tlv" class="section-name selfRef">PAC-Type TLV</a>
            </h5>
<p id="section-4.2.12.6-1">The PAC-Type TLV is a TLV intended to specify the PAC-Type.  It is
included in a PAC TLV sent by the peer to request PAC provisioning
from the server.  Its format is described below:<a href="#section-4.2.12.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.12.6-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Type               |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         PAC-Type              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.12.6-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.12.6-3">Type<a href="#section-4.2.12.6-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.6-4.1">
                <p id="section-4.2.12.6-4.1.1">10 - PAC-Type<a href="#section-4.2.12.6-4.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.2.12.6-5">Length<a href="#section-4.2.12.6-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.6-6.1">
                <p id="section-4.2.12.6-6.1.1">2-octet field with a value of 2.<a href="#section-4.2.12.6-6.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.2.12.6-7">PAC-Type<a href="#section-4.2.12.6-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.6-8.1">
                <p id="section-4.2.12.6-8.1.1">This 2-octet field defines the type of PAC being requested or
provisioned.  The following values are defined:<a href="#section-4.2.12.6-8.1.1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.12.6-8.1.2.1">
                    <p id="section-4.2.12.6-8.1.2.1.1">1 - Tunnel PAC<a href="#section-4.2.12.6-8.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</section>
</div>
</section>
</div>
<div id="crypto-binding-tlv">
<section id="section-4.2.13">
          <h4 id="name-crypto-binding-tlv">
<a href="#section-4.2.13" class="section-number selfRef">4.2.13. </a><a href="#name-crypto-binding-tlv" class="section-name selfRef">Crypto-Binding TLV</a>
          </h4>
<p id="section-4.2.13-1">The Crypto-Binding TLV is used to prove that both the peer and server
participated in the tunnel establishment and sequence of
authentications.  It also provides verification of the TEAP type,
version negotiated, and Outer TLVs exchanged before the TLS tunnel
establishment.<a href="#section-4.2.13-1" class="pilcrow">¶</a></p>
<p id="section-4.2.13-2">The Crypto-Binding TLV MUST be exchanged and validated before any
Intermediate-Result or Result TLV value is examined, regardless of
whether there is an inner authentication method or not.  It MUST be
included with the Intermediate-Result TLV to perform cryptographic
binding after each successful inner method in a sequence of inner
methods, before proceeding with another inner method.  If no MSK or
EMSK has been generated and a Crypto-Binding TLV is required then the
MSK Compound MAC field contains the MAC using keys generated according
to <a href="#computing-compound-mac" class="auto internal xref">Section 5.3</a>.<a href="#section-4.2.13-2" class="pilcrow">¶</a></p>
<p id="section-4.2.13-3">The Crypto-Binding TLV is valid only if the following checks pass:<a href="#section-4.2.13-3" class="pilcrow">¶</a></p>
<p id="section-4.2.13-4">o  The Crypto-Binding TLV version is supported.<a href="#section-4.2.13-4" class="pilcrow">¶</a></p>
<p id="section-4.2.13-5">o  The MAC verifies correctly.<a href="#section-4.2.13-5" class="pilcrow">¶</a></p>
<p id="section-4.2.13-6">o  The received version in the Crypto-Binding TLV matches the version
   sent by the receiver during the EAP version negotiation.<a href="#section-4.2.13-6" class="pilcrow">¶</a></p>
<p id="section-4.2.13-7">o  The subtype is set to the correct value.<a href="#section-4.2.13-7" class="pilcrow">¶</a></p>
<p id="section-4.2.13-8">If any of the above checks fails, then the TLV is invalid.  An
invalid Crypto-Binding TLV is a fatal error and is handled as
described in <a href="#phase-2-errors" class="auto internal xref">Section 3.6.3</a><a href="#section-4.2.13-8" class="pilcrow">¶</a></p>
<p id="section-4.2.13-9">The Crypto-Binding TLV is defined as follows:<a href="#section-4.2.13-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.13-10">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Reserved   |    Version    |  Received Ver.| Flags|Sub-Type|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                             Nonce                             ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                   EMSK Compound MAC                           ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                    MSK Compound MAC                           ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.13-10" class="pilcrow">¶</a>
</div>
<p id="section-4.2.13-11">M<a href="#section-4.2.13-11" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.13-12.1">
              <p id="section-4.2.13-12.1.1">Mandatory, set to one (1)<a href="#section-4.2.13-12.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.13-13">R<a href="#section-4.2.13-13" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.13-14.1">
              <p id="section-4.2.13-14.1.1">Reserved, set to zero (0)<a href="#section-4.2.13-14.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.13-15">TLV Type<a href="#section-4.2.13-15" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.13-16.1">
              <p id="section-4.2.13-16.1.1">12 - Crypto-Binding TLV<a href="#section-4.2.13-16.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.13-17">Length<a href="#section-4.2.13-17" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.13-18.1">
              <p id="section-4.2.13-18.1.1">76<a href="#section-4.2.13-18.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.13-19">Reserved<a href="#section-4.2.13-19" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.13-20.1">
              <p id="section-4.2.13-20.1.1">Reserved, set to zero (0)<a href="#section-4.2.13-20.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.13-21">Version<a href="#section-4.2.13-21" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.13-22.1">
              <p id="section-4.2.13-22.1.1">The Version field is a single octet, which is set to the version
of Crypto-Binding TLV the TEAP method is using.  For an
implementation compliant with this version of TEAP, the version
number MUST be set to one (1).<a href="#section-4.2.13-22.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.13-23">Received Ver<a href="#section-4.2.13-23" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.13-24.1">
              <p id="section-4.2.13-24.1.1">The Received Ver field is a single octet and MUST be set to the
TEAP version number received during version negotiation.  Note
that this field only provides protection against downgrade
attacks, where a version of EAP requiring support for this TLV is
required on both sides.<a href="#section-4.2.13-24.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.13-25">Flags<a href="#section-4.2.13-25" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.13-26.1">
              <p id="section-4.2.13-26.1.1">The Flags field is four bits.  Defined values include<a href="#section-4.2.13-26.1.1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.13-26.1.2.1">
                  <p id="section-4.2.13-26.1.2.1.1">1  EMSK Compound MAC is present<a href="#section-4.2.13-26.1.2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.13-26.1.2.1.2">2  MSK Compound MAC is present<a href="#section-4.2.13-26.1.2.1.2" class="pilcrow">¶</a></p>
<p id="section-4.2.13-26.1.2.1.3">3  Both EMSK and MSK Compound MAC are present<a href="#section-4.2.13-26.1.2.1.3" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-4.2.13-27">Sub-Type<a href="#section-4.2.13-27" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.13-28.1">
              <p id="section-4.2.13-28.1.1">The Sub-Type field is four bits.  Defined values include<a href="#section-4.2.13-28.1.1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.13-28.1.2.1">
                  <p id="section-4.2.13-28.1.2.1.1">0  Binding Request<a href="#section-4.2.13-28.1.2.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.13-28.1.2.1.2">&lt; 1  Binding Response<a href="#section-4.2.13-28.1.2.1.2" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-4.2.13-29">Nonce<a href="#section-4.2.13-29" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.13-30.1">
              <p id="section-4.2.13-30.1.1">The Nonce field is 32 octets.  It contains a 256-bit nonce that is
temporally unique, used for Compound MAC key derivation at each
end.  The nonce in a request MUST have its least significant bit
set to zero (0), and the nonce in a response MUST have the same
value as the request nonce except the least significant bit MUST
be set to one (1).<a href="#section-4.2.13-30.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.13-31">EMSK Compound MAC<a href="#section-4.2.13-31" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.13-32.1">
              <p id="section-4.2.13-32.1.1">The EMSK Compound MAC field is 20 octets.  This can be the Server
MAC (B1_MAC) or the Client MAC (B2_MAC).  The computation of the
MAC is described in <a href="#computing-compound-mac" class="auto internal xref">Section 5.3</a>.<a href="#section-4.2.13-32.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.13-32.1.2">Note that this field is always 20 octets in length.  Any larger
MAC is simply truncated.  All validations or comparisons MUST be done
on the truncated value.<a href="#section-4.2.13-32.1.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.13-33">MSK Compound MAC<a href="#section-4.2.13-33" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.13-34.1">
              <p id="section-4.2.13-34.1.1">The MSK Compound MAC field is 20 octets.  This can be the Server
MAC (B1_MAC) or the Client MAC (B2_MAC).  The computation of the
MAC is described in <a href="#computing-compound-mac" class="auto internal xref">Section 5.3</a>.<a href="#section-4.2.13-34.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2.13-34.1.2">Note that this field is always 20 octets in length.  Any larger
MAC is simply truncated.  All validations or comparisons MUST be done
on the truncated value.<a href="#section-4.2.13-34.1.2" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="bp-auth-req-tlv">
<section id="section-4.2.14">
          <h4 id="name-basic-password-auth-req-tlv">
<a href="#section-4.2.14" class="section-number selfRef">4.2.14. </a><a href="#name-basic-password-auth-req-tlv" class="section-name selfRef">Basic-Password-Auth-Req TLV</a>
          </h4>
<p id="section-4.2.14-1">The Basic-Password-Auth-Req TLV is used by the authentication server
to request a username and password from the peer.  It contains an
optional user prompt message for the request.  The peer is expected
to obtain the username and password and send them in a Basic-
Password-Auth-Resp TLV.<a href="#section-4.2.14-1" class="pilcrow">¶</a></p>
<p id="section-4.2.14-2">The Basic-Password-Auth-Req TLV is defined as follows:<a href="#section-4.2.14-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.14-3">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Prompt ....
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.14-3" class="pilcrow">¶</a>
</div>
<p id="section-4.2.14-4">M<a href="#section-4.2.14-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.14-5.1">
              <p id="section-4.2.14-5.1.1">Mandatory, set to one (1)<a href="#section-4.2.14-5.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.14-6">R<a href="#section-4.2.14-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.14-7.1">
              <p id="section-4.2.14-7.1.1">Reserved, set to zero (0)<a href="#section-4.2.14-7.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.14-8">TLV Type<a href="#section-4.2.14-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.14-9.1">
              <p id="section-4.2.14-9.1.1">13 - Basic-Password-Auth-Req TLV<a href="#section-4.2.14-9.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.14-10">Length<a href="#section-4.2.14-10" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.14-11.1">
              <p id="section-4.2.14-11.1.1">variable<a href="#section-4.2.14-11.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.14-12">Prompt<a href="#section-4.2.14-12" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.14-13.1">
              <p id="section-4.2.14-13.1.1">optional user prompt message in UTF-8 <span>[<a href="#RFC3629" class="cite xref">RFC3629</a>]</span> format<a href="#section-4.2.14-13.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="bp-auth-resp-tlv">
<section id="section-4.2.15">
          <h4 id="name-basic-password-auth-resp-tl">
<a href="#section-4.2.15" class="section-number selfRef">4.2.15. </a><a href="#name-basic-password-auth-resp-tl" class="section-name selfRef">Basic-Password-Auth-Resp TLV</a>
          </h4>
<p id="section-4.2.15-1">The Basic-Password-Auth-Resp TLV is used by the peer to respond to a
Basic-Password-Auth-Req TLV with a username and password.  The TLV
contains a username and password.  The username and password are in
UTF-8 <span>[<a href="#RFC3629" class="cite xref">RFC3629</a>]</span> format.<a href="#section-4.2.15-1" class="pilcrow">¶</a></p>
<p id="section-4.2.15-2">The Basic-Password-Auth-Resp TLV is defined as follows:<a href="#section-4.2.15-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.15-3">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Userlen     |             Username
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      ...     Username    ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Passlen     |             Password
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      ...     Password    ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.2.15-3" class="pilcrow">¶</a>
</div>
<p id="section-4.2.15-4">M<a href="#section-4.2.15-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.15-5.1">
              <p id="section-4.2.15-5.1.1">Mandatory, set to one (1)<a href="#section-4.2.15-5.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.15-6">R<a href="#section-4.2.15-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.15-7.1">
              <p id="section-4.2.15-7.1.1">Reserved, set to zero (0)<a href="#section-4.2.15-7.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.15-8">TLV Type<a href="#section-4.2.15-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.15-9.1">
              <p id="section-4.2.15-9.1.1">14 - Basic-Password-Auth-Resp TLV<a href="#section-4.2.15-9.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.15-10">Length<a href="#section-4.2.15-10" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.15-11.1">
              <p id="section-4.2.15-11.1.1">variable<a href="#section-4.2.15-11.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.15-12">Userlen<a href="#section-4.2.15-12" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.15-13.1">
              <p id="section-4.2.15-13.1.1">Length of Username field in octets<a href="#section-4.2.15-13.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.15-14">Username<a href="#section-4.2.15-14" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.15-15.1">
              <p id="section-4.2.15-15.1.1">Username in UTF-8 <span>[<a href="#RFC3629" class="cite xref">RFC3629</a>]</span> format<a href="#section-4.2.15-15.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.15-16">Passlen<a href="#section-4.2.15-16" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.15-17.1">
              <p id="section-4.2.15-17.1.1">Length of Password field in octets<a href="#section-4.2.15-17.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.15-18">Password<a href="#section-4.2.15-18" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.15-19.1">
              <p id="section-4.2.15-19.1.1">Password in UTF-8 <span>[<a href="#RFC3629" class="cite xref">RFC3629</a>]</span> format<a href="#section-4.2.15-19.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="pkcs7-tlv">
<section id="section-4.2.16">
          <h4 id="name-pkcs7-tlv">
<a href="#section-4.2.16" class="section-number selfRef">4.2.16. </a><a href="#name-pkcs7-tlv" class="section-name selfRef">PKCS#7 TLV</a>
          </h4>
<p id="section-4.2.16-1">The PKCS#7 TLV is used by the EAP server to deliver certificate(s) to
the peer.  The format consists of a certificate or certificate chain
in binary DER encoding <span>[<a href="#X.690" class="cite xref">X.690</a>]</span> in a degenerate Certificates Only
PKCS#7 SignedData Content as defined in <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>.<a href="#section-4.2.16-1" class="pilcrow">¶</a></p>
<p id="section-4.2.16-2">When used in response to a Trusted-Server-Root TLV request from the
peer, the EAP server MUST send the PKCS#7 TLV inside a Trusted-
Server-Root TLV.  When used in response to a PKCS#10 certificate
enrollment request from the peer, the EAP server MUST send the PKCS#7
TLV without a Trusted-Server-Root TLV.  The PKCS#7 TLV is always
marked as optional, which cannot be responded to with a NAK TLV.
TEAP implementations that support the Trusted-Server-Root TLV or the
PKCS#10 TLV MUST support this TLV.  Peers MUST NOT assume that the
certificates in a PKCS#7 TLV are in any order.<a href="#section-4.2.16-2" class="pilcrow">¶</a></p>
<p id="section-4.2.16-3">TEAP servers MAY return self-signed certificates.  Peers that handle
self-signed certificates or trust anchors MUST NOT implicitly trust
these certificates merely due to their presence in the certificate
bag.  Note: Peers are advised to take great care in deciding whether
to use a received certificate as a trust anchor.  The authenticated
nature of the tunnel in which a PKCS#7 bag is received can provide a
level of authenticity to the certificates contained therein.  Peers
are advised to take into account the implied authority of the EAP
server and to constrain the trust it can achieve through the trust
anchor received in a PKCS#7 TLV.<a href="#section-4.2.16-3" class="pilcrow">¶</a></p>
<p id="section-4.2.16-4">The PKCS#7 TLV is defined as follows:<a href="#section-4.2.16-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.16-5">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           PKCS#7 Data...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-++-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
</pre><a href="#section-4.2.16-5" class="pilcrow">¶</a>
</div>
<p id="section-4.2.16-6">M<a href="#section-4.2.16-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.16-7.1">
              <p id="section-4.2.16-7.1.1">0 - Optional TLV<a href="#section-4.2.16-7.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.16-8">R<a href="#section-4.2.16-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.16-9.1">
              <p id="section-4.2.16-9.1.1">Reserved, set to zero (0)<a href="#section-4.2.16-9.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.16-10">TLV Type<a href="#section-4.2.16-10" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.16-11.1">
              <p id="section-4.2.16-11.1.1">15 - PKCS#7 TLV<a href="#section-4.2.16-11.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.16-12">Length<a href="#section-4.2.16-12" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.16-13.1">
              <p id="section-4.2.16-13.1.1">The length of the PKCS#7 Data field.<a href="#section-4.2.16-13.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.16-14">PKCS#7 Data<a href="#section-4.2.16-14" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.16-15.1">
              <p id="section-4.2.16-15.1.1">This field contains the DER-encoded X.509 certificate or
certificate chain in a Certificates-Only PKCS#7 SignedData
message.<a href="#section-4.2.16-15.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="pkcs10-tlv">
<section id="section-4.2.17">
          <h4 id="name-pkcs10-tlv">
<a href="#section-4.2.17" class="section-number selfRef">4.2.17. </a><a href="#name-pkcs10-tlv" class="section-name selfRef">PKCS#10 TLV</a>
          </h4>
<p id="section-4.2.17-1">The PKCS#10 TLV is used by the peer to initiate the "simple PKI"
Request/Response from <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>]</span>.  The format of the request is as
specified in Section 6.4 of <span>[<a href="#RFC4945" class="cite xref">RFC4945</a>]</span>.  The PKCS#10 TLV is always
marked as optional, which cannot be responded to with a NAK TLV.<a href="#section-4.2.17-1" class="pilcrow">¶</a></p>
<p id="section-4.2.17-2">The PKCS#10 TLV is defined as follows:<a href="#section-4.2.17-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.17-3">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           PKCS#10 Data...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-++-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
</pre><a href="#section-4.2.17-3" class="pilcrow">¶</a>
</div>
<p id="section-4.2.17-4">M<a href="#section-4.2.17-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.17-5.1">
              <p id="section-4.2.17-5.1.1">0 - Optional TLV<a href="#section-4.2.17-5.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.17-6">R<a href="#section-4.2.17-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.17-7.1">
              <p id="section-4.2.17-7.1.1">Reserved, set to zero (0)<a href="#section-4.2.17-7.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.17-8">TLV Type<a href="#section-4.2.17-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.17-9.1">
              <p id="section-4.2.17-9.1.1">16 - PKCS#10 TLV<a href="#section-4.2.17-9.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.17-10">Length<a href="#section-4.2.17-10" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.17-11.1">
              <p id="section-4.2.17-11.1.1">The length of the PKCS#10 Data field.<a href="#section-4.2.17-11.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.17-12">PKCS#10 Data<a href="#section-4.2.17-12" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.17-13.1">
              <p id="section-4.2.17-13.1.1">This field contains the DER-encoded PKCS#10 certificate request.<a href="#section-4.2.17-13.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="trusted-server-root-tlv">
<section id="section-4.2.18">
          <h4 id="name-trusted-server-root-tlv">
<a href="#section-4.2.18" class="section-number selfRef">4.2.18. </a><a href="#name-trusted-server-root-tlv" class="section-name selfRef">Trusted-Server-Root TLV</a>
          </h4>
<p id="section-4.2.18-1">Trusted-Server-Root TLV facilitates the request and delivery of a
trusted server root certificate.  The Trusted-Server-Root TLV can be
exchanged in regular TEAP authentication mode or provisioning mode.
The Trusted-Server-Root TLV is always marked as optional and cannot
be responded to with a Negative Acknowledgement (NAK) TLV.  The
Trusted-Server-Root TLV MUST only be sent as an Inner TLV (inside the
protection of the tunnel).<a href="#section-4.2.18-1" class="pilcrow">¶</a></p>
<p id="section-4.2.18-2">After the peer has determined that it has successfully authenticated
the EAP server and validated the Crypto-Binding TLV, it MAY send one
or more Trusted-Server-Root TLVs (marked as optional) to request the
trusted server root certificates from the EAP server.  The EAP server
MAY send one or more root certificates with a Public Key
Cryptographic System #7 (PKCS#7) TLV inside the Trusted-Server-Root
TLV.  The EAP server MAY also choose not to honor the request.<a href="#section-4.2.18-2" class="pilcrow">¶</a></p>
<p id="section-4.2.18-3">The Trusted-Server-Root TLV allows the peer to send a request to the
EAP server for a list of trusted roots.  The server may respond with
one or more root certificates in PKCS#7 <span>[<a href="#RFC2315" class="cite xref">RFC2315</a>]</span> format.<a href="#section-4.2.18-3" class="pilcrow">¶</a></p>
<p id="section-4.2.18-4">If the EAP server sets the credential format to PKCS#7-Server-
Certificate-Root, then the Trusted-Server-Root TLV should contain the
root of the certificate chain of the certificate issued to the EAP
server packaged in a PKCS#7 TLV.  If the server certificate is a
self-signed certificate, then the root is the self-signed
certificate.<a href="#section-4.2.18-4" class="pilcrow">¶</a></p>
<p id="section-4.2.18-5">If the Trusted-Server-Root TLV credential format contains a value
unknown to the peer, then the EAP peer should ignore the TLV.<a href="#section-4.2.18-5" class="pilcrow">¶</a></p>
<p id="section-4.2.18-6">The Trusted-Server-Root TLV is defined as follows:<a href="#section-4.2.18-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.18-7">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|R|         TLV Type          |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Credential-Format   |     Cred TLVs...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-++-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
</pre><a href="#section-4.2.18-7" class="pilcrow">¶</a>
</div>
<p id="section-4.2.18-8">M<a href="#section-4.2.18-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.18-9.1">
              <p id="section-4.2.18-9.1.1">0 - Optional TLV<a href="#section-4.2.18-9.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.18-10">R<a href="#section-4.2.18-10" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.18-11.1">
              <p id="section-4.2.18-11.1.1">Reserved, set to zero (0)<a href="#section-4.2.18-11.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.18-12">TLV Type<a href="#section-4.2.18-12" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.18-13.1">
              <p id="section-4.2.18-13.1.1">17 - Trusted-Server-Root TLV<a href="#section-4.2.18-13.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.18-14">Length<a href="#section-4.2.18-14" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.18-15.1">
              <p id="section-4.2.18-15.1.1">&gt;=2 octets<a href="#section-4.2.18-15.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.18-16">Credential-Format<a href="#section-4.2.18-16" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.18-17.1">
              <p id="section-4.2.18-17.1.1">The Credential-Format field is two octets.  Values include:<a href="#section-4.2.18-17.1.1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.18-17.1.2.1">
                  <p id="section-4.2.18-17.1.2.1.1">1 - PKCS#7-Server-Certificate-Root<a href="#section-4.2.18-17.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-4.2.18-18">Cred TLVs<a href="#section-4.2.18-18" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2.18-19.1">
              <p id="section-4.2.18-19.1.1">This field is of indefinite length.  It contains TLVs associated
with the credential format.  The peer may leave this field empty
when using this TLV to request server trust roots.<a href="#section-4.2.18-19.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="tlv-rules">
<section id="section-4.3">
        <h3 id="name-tlv-rules">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-tlv-rules" class="section-name selfRef">TLV Rules</a>
        </h3>
<p id="section-4.3-1">To save round trips, multiple TLVs can be sent in a single TEAP
packet.  However, multiple EAP Payload TLVs, multiple Basic Password
Authentication TLVs, or an EAP Payload TLV with a Basic Password
Authentication TLV within one single TEAP packet is not supported in
this version and MUST NOT be sent.  If the peer or EAP server
receives multiple EAP Payload TLVs, then it MUST terminate the
connection with the Result TLV.  The order in which TLVs are encoded in a TEAP packet does not
matter, however there is an order in which TLVs in a packet must be processed:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3-2">
<li id="section-4.3-2.1">Crypto-Binding-TLV<a href="#section-4.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-2.2">Intermediate-Result-TLV<a href="#section-4.3-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-2.3">Result-TLV or Request-Action TLV<a href="#section-4.3-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-2.4">Identity-Type TLV<a href="#section-4.3-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-2.5">EAP-Payload TLV[Identity-Request] or Basic-Password-Auth-Req TLV<a href="#section-4.3-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-2.6">Other TLVs<a href="#section-4.3-2.6" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-4.3-3">That is, cryptographic binding is checked before any result is used,
and identities are checked before proposing an authentication method, as the
identity may influence the chosen authentication method.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">The following define the meaning of the table entries in the sections
below:<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-5">
<pre>
0     This TLV MUST NOT be present in the message.

0+    Zero or more instances of this TLV MAY be present in the
      message.

0-1   Zero or one instance of this TLV MAY be present in the message.

1     Exactly one instance of this TLV MUST be present in the
      message.
</pre><a href="#section-4.3-5" class="pilcrow">¶</a>
</div>
<div id="outer-tlvs">
<section id="section-4.3.1">
          <h4 id="name-outer-tlvs">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-outer-tlvs" class="section-name selfRef">Outer TLVs</a>
          </h4>
<p id="section-4.3.1-1">The following table provides a guide to which TLVs may be included in
the TEAP packet outside the TLS channel, which kind of packets, and
in what quantity:<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.1-2">
<pre>
Request  Response    Success   Failure   TLVs
0-1      0           0         0         Authority-ID
0-1      0-1         0         0         Identity-Type
0+       0+          0         0         Vendor-Specific
</pre><a href="#section-4.3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.3.1-3">Outer TLVs MUST be marked as optional.  Vendor-TLVs inside Vendor-
Specific TLV MUST be marked as optional when included in Outer TLVs.
Outer TLVs MUST NOT be included in messages after the first two TEAP
messages sent by peer and EAP-server respectively.  That is the first
EAP-server-to-peer message and first peer-to-EAP-server message.  If
the message is fragmented, the whole set of messages is counted as
one message.  If Outer TLVs are included in messages after the first
two TEAP messages, they MUST be ignored.<a href="#section-4.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="inner-tlvs">
<section id="section-4.3.2">
          <h4 id="name-inner-tlvs">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-inner-tlvs" class="section-name selfRef">Inner TLVs</a>
          </h4>
<p id="section-4.3.2-1">The following table provides a guide to which Inner TLVs may be
encapsulated in TLS in TEAP Phase 2, in which kind of packets, and in
what quantity.  The messages are as follows: Request is a TEAP
Request, Response is a TEAP Response, Success is a message containing
a successful Result TLV, and Failure is a message containing a failed
Result TLV.<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.2-2">
<pre>
Request  Response    Success   Failure   TLVs
0-1      0-1         0         0         Identity-Type
0-1      0-1         1         1         Result
0+       0+          0         0         NAK
0+       0+          0+        0+        Error
0-1      0-1         0         0         Channel-Binding
0+       0+          0+        0+        Vendor-Specific
0+       0+          0+        0+        Request-Action
0-1      0-1         0         0         EAP-Payload
0-1      0-1         0-1       0-1       Intermediate-Result
0+       0+          0+        0         PAC TLV
0-1      0-1         0-1       0-1       Crypto-Binding
0-1      0           0         0         Basic-Password-Auth-Req
0        0-1         0         0         Basic-Password-Auth-Resp
0-1      0           0-1       0         PKCS#7
0        0-1         0         0         PKCS#10
0-1      0-1         0-1       0         Trusted-Server-Root
</pre><a href="#section-4.3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.3.2-3">NOTE: Vendor TLVs (included in Vendor-Specific TLVs) sent with a
Result TLV MUST be marked as optional.<a href="#section-4.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="cryptographic-calculations">
<section id="section-5">
      <h2 id="name-cryptographic-calculations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-cryptographic-calculations" class="section-name selfRef">Cryptographic Calculations</a>
      </h2>
<p id="section-5-1">For key derivation and crypto-binding, TEAP uses the Pseudorandom
Function (PRF) and MAC algorithms negotiated in the underlying TLS
session.  Since these algorithms depend on the TLS version and
ciphersuite, TEAP implementations need a mechanism to determine the
version and ciphersuite in use for a particular session.  The
implementation can then use this information to determine which PRF
and MAC algorithm to use.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="phase1">
<section id="section-5.1">
        <h3 id="name-teap-authentication-phase-1-">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-teap-authentication-phase-1-" class="section-name selfRef">TEAP Authentication Phase 1: Key Derivations</a>
        </h3>
<p id="section-5.1-1">With TEAPv1, the TLS master secret is generated as specified in TLS.
If a PAC is used, then the master secret is obtained as described in
<span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">TEAPv1 makes use of the TLS Keying Material Exporters defined in
<span>[<a href="#RFC5705" class="cite xref">RFC5705</a>]</span> to derive the session_key_seed as follows:<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-3">
<pre>
   session_key_seed = TLS-Exporter(
                      "EXPORTER: teap session key seed",, 40)
</pre><a href="#section-5.1-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1-4">No context data is used in the export process.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">The session_key_seed is used by the TEAP authentication Phase 2
conversation to both cryptographically bind the inner method(s) to
the tunnel as well as generate the resulting TEAP session keys.  The
other TLS keying materials are derived and used as defined in
<span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span>.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intermediate-compound-key">
<section id="section-5.2">
        <h3 id="name-intermediate-compound-key-d">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-intermediate-compound-key-d" class="section-name selfRef">Intermediate Compound Key Derivations</a>
        </h3>
<p id="section-5.2-1">The session_key_seed derived as part of TEAP Phase 2 is used in TEAP
Phase 2 to generate an Intermediate Compound Key (IMCK) used to
verify the integrity of the TLS tunnel after each successful inner
authentication and in the generation of Master Session Key (MSK) and
Extended Master Session Key (EMSK) defined in <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span>.  Note that
the IMCK MUST be recalculated after each successful inner method.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">The first step in these calculations is the generation of the base
compound key, IMCK[j] from the session_key_seed, and any session keys
derived from the successful execution of jth inner
methods. The inner method(s) MUST
provide Inner Method Session Keys (IMSKs), IMSK[1]..IMSK[n], corresponding
to inner method 1 through n.  When a particular authentication method
does not provide key material (such as with password exchange) then a special "all zero" IMSK
is used as described below.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">If an inner method supports export of an Extended Master Session Key
(EMSK), then the IMSK SHOULD be derived from the EMSK as defined in
<span>[<a href="#RFC5295" class="cite xref">RFC5295</a>]</span>.  The usage label used is "TEAPbindkey@ietf.org", and the
length is 64 octets.  Optional data parameter is not used in the
derivation.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-4">
<pre>
    IMSK[j] = First 32 octets of TLS-PRF(secret, "TEAPbindkey@ietf.org",
           0x00 \| 0x00 \| 0x40)
</pre><a href="#section-5.2-4" class="pilcrow">¶</a>
</div>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.2-5.1">
            <p id="section-5.2-5.1.1">where "|" denotes concatenation and the TLS-PRF is defined in
<span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span> as<a href="#section-5.2-5.1.1" class="pilcrow">¶</a></p>
<p id="section-5.2-5.1.2">PRF(secret, label, seed) = P_&lt;hash&gt;(secret, label | seed).<a href="#section-5.2-5.1.2" class="pilcrow">¶</a></p>
<p id="section-5.2-5.1.3">The secret is the EMSK or MSK from the j'th inner method, the label is
"TEAPbindkey@ietf.org" consisting of the ASCII value for the
label "TEAPbindkey@ietf.org" (without quotes),  the seed
consists of the "\0" null delimiter (0x00) and 2-octet unsigned
integer length in network byte order (0x00 | 0x40) specified
in <span>[<a href="#RFC5295" class="cite xref">RFC5295</a>]</span>.<a href="#section-5.2-5.1.3" class="pilcrow">¶</a></p>
<p id="section-5.2-5.1.4">If an inner method does not support export of an Extended Master
Session Key (EMSK), then the IMSK is derived from the MSK of the inner method.  The
EMSK or MSK is truncated at 32 octets if it is longer than 32 octets or
padded to a length of 32 octets with zeros if it is less than 32
octets.<a href="#section-5.2-5.1.4" class="pilcrow">¶</a></p>
<p id="section-5.2-5.1.5">If no inner EAP authentication method is run then no EMSK or MSK
will be generated (e.g. when basic password authentication
is used or when no inner method has been run and the crypto-binding TLV
for the Result-TLV needs to be generated).  In this case, IMSK[j]
is set to zero (i.e., MSK = 32 octets of 0x00s).<a href="#section-5.2-5.1.5" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.2-6">However, it is possible that the peer and server sides might not have
the same capability to export EMSK.  In order to maintain maximum
flexibility while prevent downgrading attack, the following mechanism
is in place.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2-7">On the sender of the Crypto-Binding TLV side:<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.2-8.1">
            <p id="section-5.2-8.1.1">If the EMSK is not available, then the sender computes the Compound
MAC using the MSK of the inner method.<a href="#section-5.2-8.1.1" class="pilcrow">¶</a></p>
<p id="section-5.2-8.1.2">If the EMSK is available and the sender's policy accepts MSK-based
MAC, then the sender computes two Compound MAC values.  The first
is computed with the EMSK.  The second one is computed using the
MSK.  Both MACs are then sent to the other side.<a href="#section-5.2-8.1.2" class="pilcrow">¶</a></p>
<p id="section-5.2-8.1.3">If the EMSK is available but the sender's policy does not allow
downgrading to MSK-generated MAC, then the sender SHOULD only send
EMSK-based MAC.<a href="#section-5.2-8.1.3" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.2-9">On the receiver of the Crypto-Binding TLV side:<a href="#section-5.2-9" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.2-10.1">
            <p id="section-5.2-10.1.1">If the EMSK is not available and an MSK-based Compound MAC was
sent, then the receiver validates the Compound MAC and sends back
an MSK-based Compound MAC response.<a href="#section-5.2-10.1.1" class="pilcrow">¶</a></p>
<p id="section-5.2-10.1.2">If the EMSK is not available and no MSK-based Compound MAC was
sent, then the receiver handles like an invalid Crypto-Binding TLV
with a fatal error.<a href="#section-5.2-10.1.2" class="pilcrow">¶</a></p>
<p id="section-5.2-10.1.3">If the EMSK is available and an EMSK-based Compound MAC was sent,
then the receiver validates it and creates a response Compound MAC
using the EMSK.<a href="#section-5.2-10.1.3" class="pilcrow">¶</a></p>
<p id="section-5.2-10.1.4">If the EMSK is available but no EMSK-based Compound MAC was sent
and its policy accepts MSK-based MAC, then the receiver validates
it using the MSK and, if successful, generates and returns an MSK-
based Compound MAC.<a href="#section-5.2-10.1.4" class="pilcrow">¶</a></p>
<p id="section-5.2-10.1.5">If the EMSK is available but no EMSK Compound MAC was sent and its
policy does not accept MSK-based MAC, then the receiver handles
like an invalid Crypto-Binding TLV with a fatal error.<a href="#section-5.2-10.1.5" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.2-11">If an inner method results in failure, then it is not included in this
calculation.<a href="#section-5.2-11" class="pilcrow">¶</a></p>
<p id="section-5.2-12">The derivation of S-IMCK is as follows:<a href="#section-5.2-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-13">
<pre>
   S-IMCK[0] = session_key_seed
   For j = 1 to n-1 do
        IMCK[j] = the first 60 octets of TLS-PRF(S-IMCK[j-1],
             "Inner Methods Compound Keys",
             IMSK[j])
        S-IMCK[j] = first 40 octets of IMCK[j]
        CMK[j] = last 20 octets of IMCK[j]
</pre><a href="#section-5.2-13" class="pilcrow">¶</a>
</div>
<p id="section-5.2-14">where TLS-PRF is the PRF described above negotiated as
part of TLS handshake <span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span>.  The value j refers to a
corresponding inner method 1 through n.  The special value of
S-IMCK[0] is used to bootstrap the calculations, and can be done as
soon as the TLS connection is established, and before any inner
methods are run.<a href="#section-5.2-14" class="pilcrow">¶</a></p>
<p id="section-5.2-15">In practice, the requirement to use either MSK or EMSK means that an
implement MUST track two independent derivations of IMCK[j], one which
depends on the MSK, and another which depends on EMSK.  That is, we
have both values derived from MSK:<a href="#section-5.2-15" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-16">
<pre>
   IMSK_MSK[j]
   S-IMCK_MSK[j]
   CMK_MSK[j]
</pre><a href="#section-5.2-16" class="pilcrow">¶</a>
</div>
<p id="section-5.2-17">and then also values derived from EMSK:<a href="#section-5.2-17" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-18">
<pre>
   IMSK_EMSK[j]
   S-IMCK_EMSK[j]
   CMK_EMSK[j]
</pre><a href="#section-5.2-18" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="computing-compound-mac">
<section id="section-5.3">
        <h3 id="name-computing-the-compound-mac">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-computing-the-compound-mac" class="section-name selfRef">Computing the Compound MAC</a>
        </h3>
<p id="section-5.3-1">For inner methods that generate keying material, further
protection against man-in-the-middle attacks is provided through
cryptographically binding keying material established by both TEAP
Phase 1 and TEAP Phase 2 conversations.  After each successful inner
EAP authentication, EAP EMSK and/or MSKs are cryptographically
combined with key material from TEAP Phase 1 to generate a Compound
Session Key (CMK).  The CMK is used to calculate the Compound MAC as
part of the Crypto-Binding TLV described in <a href="#crypto-binding-tlv" class="auto internal xref">Section 4.2.13</a>, which
helps provide assurance that the same entities are involved in all
communications in TEAP.  During the calculation of the Compound MAC,
the MAC field is filled with zeros.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">The Compound MAC computation is as follows:<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-3">
<pre>
   Compound-MAC = the first 20 octets of MAC( CMK[n], BUFFER )
</pre><a href="#section-5.3-3" class="pilcrow">¶</a>
</div>
<p id="section-5.3-4">where n is the number of the last successfully executed inner
method, MAC is the MAC function negotiated in TLS (e.g. TLS 1.2 in <span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span>), and
BUFFER is created after concatenating these fields in the following
order:<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3-5">
<li id="section-5.3-5.1">The entire Crypto-Binding TLV attribute with both the EMSK and MSK
 Compound MAC fields zeroed out.<a href="#section-5.3-5.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-5.2">The EAP Type sent by the other party in the first TEAP message,
which MUST be TEAP, encoded as one octet of 0x37.<a href="#section-5.3-5.2" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-5.3">All the Outer TLVs from the first TEAP message sent by EAP server
to peer.  If a single TEAP message is fragmented into multiple
TEAP packets, then the Outer TLVs in all the fragments of that
message MUST be included.<a href="#section-5.3-5.3" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-5.4">All the Outer TLVs from the first TEAP message sent by the peer to
the EAP server.  If a single TEAP message is fragmented into
multiple TEAP packets, then the Outer TLVs in all the fragments of
that message MUST be included.<a href="#section-5.3-5.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-5.3-6">If no inner EAP authentication method is run then no EMSK or MSK
will be generated.  If an IMSK needs to be generated then the MSK
and therefore the IMSK is set to 0 (e.g., MSK = 32 octets of 0x00s).<a href="#section-5.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="eap-master-session-key-generation">
<section id="section-5.4">
        <h3 id="name-eap-master-session-key-gene">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-eap-master-session-key-gene" class="section-name selfRef">EAP Master Session Key Generation</a>
        </h3>
<p id="section-5.4-1">TEAP authentication assures the Master Session Key (MSK) and Extended
Master Session Key (EMSK) output from the EAP authentication method are the result
of all authentication conversations by generating an Intermediate
Compound Key (IMCK).  The IMCK is mutually derived by the peer and
the server as described in <a href="#intermediate-compound-key" class="auto internal xref">Section 5.2</a> by combining the MSKs from
inner methods with key material from TEAP Phase 1.  The resulting
MSK and EMSK are generated from the final ("n"th) inner method, as part of the IMCK[n] key hierarchy via the
following derivation:<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4-2">
<pre>
   MSK  = the first 64 octets of TLS-PRF(S-IMCK[n],
          "Session Key Generating Function")
   EMSK = the first 64 octets of TLS-PRF(S-IMCK[n],
          "Extended Session Key Generating Function")
</pre><a href="#section-5.4-2" class="pilcrow">¶</a>
</div>
<p id="section-5.4-3">The TLS-PRF is defined in <span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span> as<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4-4">
<pre>
   PRF(secret, label, seed) = P_&lt;hash&gt;(secret, label | seed).
</pre><a href="#section-5.4-4" class="pilcrow">¶</a>
</div>
<p id="section-5.4-5">where "|" denotes concatenation. The secret is S-IMCK[n] where n is the
number of the last generated
S-IMCK[j] from <a href="#intermediate-compound-key" class="auto internal xref">Section 5.2</a>.  The label is is the ASCII
value for the string without quotes.  The seed is empty (0 length) and
is omitted from the derivation.<a href="#section-5.4-5" class="pilcrow">¶</a></p>
<p id="section-5.4-6">The EMSK is typically only known to the TEAP peer and server and is
not provided to a third party.  The derivation of additional keys and
transportation of these keys to a third party are outside the scope
of this document.<a href="#section-5.4-6" class="pilcrow">¶</a></p>
<p id="section-5.4-7">If no EAP authentication methods have been negotiated inside the tunnel or no EAP
authentication methods have been successfully completed inside the tunnel, the MSK
and EMSK will be generated directly from the session_key_seed meaning
S-IMCK[0] = session_key_seed.<a href="#section-5.4-7" class="pilcrow">¶</a></p>
<p id="section-5.4-8">As we noted above, not all inner methods generate both MSK and EMSK,
so we have to maintain two independent derivations of S-IMCK[j], one
for each of MSK[j] and EMSK[j].  The final derivation using
S-IMCK[n] must choose only one of these keys.<a href="#section-5.4-8" class="pilcrow">¶</a></p>
<p id="section-5.4-9">If the Crypto-Binding TLV contains an EMSK compound MAC, then the
derivation is taken from the S_IMCK_EMSK[n].  Otherwise it is taken
from the S_IMCK_MSK[n].<a href="#section-5.4-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">This section provides guidance to the Internet Assigned Numbers
Authority (IANA) regarding registration of values related to the TEAP
protocol, in accordance with BCP 26 <span>[<a href="#RFC5226" class="cite xref">RFC5226</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">IANA is instructed to update the references in the "Tunnel Extensible
Authentication Protocol (TEAP) Parameters" registry to point to this
document instead of to <span>[<a href="#RFC7170" class="cite xref">RFC7170</a>]</span><a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">IANA is instructed to add a "NOTE" at the beginning of the TEAP
parameters registry which states:<a href="#section-6-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6-4.1">
          <p id="section-6-4.1.1">The values in this registry were originally defined in <span>[<a href="#RFC7170" class="cite xref">RFC7170</a>]</span><a href="#section-6-4.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">TEAP is designed with a focus on wireless media, where the medium
itself is inherent to eavesdropping.  Whereas in wired media an
attacker would have to gain physical access to the wired medium,
wireless media enables anyone to capture information as it is
transmitted over the air, enabling passive attacks.  Thus, physical
security can not be assumed, and security vulnerabilities are far
greater.  The threat model used for the security evaluation of TEAP
is defined in EAP <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="mutual-authentication-and-integrity-protection">
<section id="section-7.1">
        <h3 id="name-mutual-authentication-and-i">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-mutual-authentication-and-i" class="section-name selfRef">Mutual Authentication and Integrity Protection</a>
        </h3>
<p id="section-7.1-1">As a whole, TEAP provides message and integrity protection by
establishing a secure tunnel for protecting the inner
method(s).  The confidentiality and integrity protection is defined
by TLS and provides the same security strengths afforded by TLS
employing a strong entropy shared master secret.  The integrity of
the key generating inner methods executed within the TEAP
tunnel is verified through the calculation of the Crypto-Binding TLV.
This ensures that the tunnel endpoints are the same as the inner
method endpoints.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">The Result TLV is protected and conveys the true Success or Failure
of TEAP, and it should be used as the indicator of its success or
failure respectively.  However, as EAP terminates with either a
cleartext EAP Success or Failure, a peer will also receive a
cleartext EAP Success or Failure.  The received cleartext EAP Success
or Failure MUST match that received in the Result TLV; the peer
SHOULD silently discard those cleartext EAP Success or Failure
messages that do not coincide with the status sent in the protected
Result TLV.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="method-negotiation">
<section id="section-7.2">
        <h3 id="name-method-negotiation">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-method-negotiation" class="section-name selfRef">Method Negotiation</a>
        </h3>
<p id="section-7.2-1">As is true for any negotiated EAP protocol, NAK packets used to
suggest an alternate EAP authentication method are sent unprotected and,
as such, are subject to spoofing.  During unprotected EAP method
negotiation, NAK packets may be interjected as active attacks to
negotiate down to a weaker form of authentication, such as EAP-MD5
(which only provides one-way authentication and does not derive a
key).  Both the peer and server should have a method selection policy
that prevents them from negotiating down to weaker methods.  Inner
method negotiation resists attacks because it is protected by the
mutually authenticated TLS tunnel established.  Selection of TEAP as
an authentication method does not limit the potential inner
methods, so TEAP should be selected when available.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">An attacker cannot readily determine the inner method used,
except perhaps by traffic analysis.  It is also important that peer
implementations limit the use of credentials with an unauthenticated
or unauthorized server.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="separation-p1-p2">
<section id="section-7.3">
        <h3 id="name-separation-of-phase-1-and-p">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-separation-of-phase-1-and-p" class="section-name selfRef">Separation of Phase 1 and Phase 2 Servers</a>
        </h3>
<p id="section-7.3-1">Separation of the TEAP Phase 1 from the Phase 2 conversation is NOT
RECOMMENDED.  Allowing the Phase 1 conversation to be terminated at a
different server than the Phase 2 conversation can introduce
vulnerabilities if there is not a proper trust relationship and
protection for the protocol between the two servers.  Some
vulnerabilities include:<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">o  Loss of identity protection<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">o  Offline dictionary attacks<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">o  Lack of policy enforcement<a href="#section-7.3-4" class="pilcrow">¶</a></p>
<p id="section-7.3-5">o  Man-in-the-middle attacks (as described in <span>[<a href="#RFC7029" class="cite xref">RFC7029</a>]</span>)<a href="#section-7.3-5" class="pilcrow">¶</a></p>
<p id="section-7.3-6">There may be cases where a trust relationship exists between the
Phase 1 and Phase 2 servers, such as on a campus or between two
offices within the same company, where there is no danger in
revealing the inner identity and credentials of the peer to entities
between the two servers.  In these cases, using a proxy solution
without end-to-end protection of TEAP MAY be used.  The TEAP
encrypting/decrypting gateway MUST, at a minimum, provide support for
IPsec, TLS, or similar protection in order to provide confidentiality
for the portion of the conversation between the gateway and the EAP
server.  In addition, separation of the TEAP server and Inner servers
allows for crypto-binding based on the inner method MSK to be
thwarted as described in <span>[<a href="#RFC7029" class="cite xref">RFC7029</a>]</span>.  Implementation and deployment
SHOULD adopt various mitigation strategies described in <span>[<a href="#RFC7029" class="cite xref">RFC7029</a>]</span>.
If the inner method is deriving EMSK, then this threat is mitigated
as TEAP utilizes the mutual crypto-binding based on EMSK as described
in <span>[<a href="#RFC7029" class="cite xref">RFC7029</a>]</span>.<a href="#section-7.3-6" class="pilcrow">¶</a></p>
<p id="section-7.3-7">On the other hand, if the inner method is not deriving EMSK as with
password authentication or unauthenticated provisioning, then this
thread still exists.<a href="#section-7.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mitigation-of-known-vulnerabilities-and-protocol-deficiencies">
<section id="section-7.4">
        <h3 id="name-mitigation-of-known-vulnera">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-mitigation-of-known-vulnera" class="section-name selfRef">Mitigation of Known Vulnerabilities and Protocol Deficiencies</a>
        </h3>
<p id="section-7.4-1">TEAP addresses the known deficiencies and weaknesses in some EAP
authentication methods.  By employing a shared secret between the peer and server to
establish a secured tunnel, TEAP enables:<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">o  Per-packet confidentiality and integrity protection<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<p id="section-7.4-3">o  User identity protection<a href="#section-7.4-3" class="pilcrow">¶</a></p>
<p id="section-7.4-4">o  Better support for notification messages<a href="#section-7.4-4" class="pilcrow">¶</a></p>
<p id="section-7.4-5">o  Protected inner method negotiation, including EAP method<a href="#section-7.4-5" class="pilcrow">¶</a></p>
<p id="section-7.4-6">o  Sequencing of inner methods, including EAP methods<a href="#section-7.4-6" class="pilcrow">¶</a></p>
<p id="section-7.4-7">o  Strong mutually derived MSKs<a href="#section-7.4-7" class="pilcrow">¶</a></p>
<p id="section-7.4-8">o  Acknowledged success/failure indication<a href="#section-7.4-8" class="pilcrow">¶</a></p>
<p id="section-7.4-9">o  Faster re-authentications through session resumption<a href="#section-7.4-9" class="pilcrow">¶</a></p>
<p id="section-7.4-10">o  Mitigation of offline dictionary attacks<a href="#section-7.4-10" class="pilcrow">¶</a></p>
<p id="section-7.4-11">o  Mitigation of man-in-the-middle attacks<a href="#section-7.4-11" class="pilcrow">¶</a></p>
<p id="section-7.4-12">o  Mitigation of some denial-of-service attacks<a href="#section-7.4-12" class="pilcrow">¶</a></p>
<p id="section-7.4-13">It should be noted that in TEAP, as in many other authentication
protocols, a denial-of-service attack can be mounted by adversaries
sending erroneous traffic to disrupt the protocol.  This is a problem
in many authentication or key agreement protocols and is therefore
noted for TEAP as well.<a href="#section-7.4-13" class="pilcrow">¶</a></p>
<p id="section-7.4-14">TEAP was designed with a focus on protected inner methods
that typically rely on weak credentials, such as password-based
secrets.  To that extent, the TEAP authentication mitigates several
vulnerabilities, such as offline dictionary attacks, by protecting the weak
credential-based inner method.  The protection is based on
strong cryptographic algorithms in TLS to provide message
confidentiality and integrity.  The keys derived for the protection
relies on strong random challenges provided by both peer and server
as well as an established key with strong entropy.  Implementations
should follow the recommendation in <span>[<a href="#RFC4086" class="cite xref">RFC4086</a>]</span> when generating random
numbers.<a href="#section-7.4-14" class="pilcrow">¶</a></p>
<div id="user-identity-protection-and-verification">
<section id="section-7.4.1">
          <h4 id="name-user-identity-protection-an">
<a href="#section-7.4.1" class="section-number selfRef">7.4.1. </a><a href="#name-user-identity-protection-an" class="section-name selfRef">User Identity Protection and Verification</a>
          </h4>
<p id="section-7.4.1-1">The initial identity request response exchange is sent in cleartext
outside the protection of TEAP.  Typically, the Network Access
Identifier (NAI) <span>[<a href="#RFC4282" class="cite xref">RFC4282</a>]</span> in the identity response is useful only
for the realm of information that is used to route the authentication
requests to the right EAP server.  This means that the identity
response may contain an anonymous identity and just contain realm
information.  In other cases, the identity exchange may be eliminated
altogether if there are other means for establishing the destination
realm of the request.  In no case should an intermediary place any
trust in the identity information in the identity response since it
is unauthenticated and may not have any relevance to the
authenticated identity.  TEAP implementations should not attempt to
compare any identity disclosed in the initial cleartext EAP Identity
response packet with those Identities authenticated in Phase 2.<a href="#section-7.4.1-1" class="pilcrow">¶</a></p>
<p id="section-7.4.1-2">Identity request/response exchanges sent after the TEAP tunnel is
established are protected from modification and eavesdropping by
attackers.<a href="#section-7.4.1-2" class="pilcrow">¶</a></p>
<p id="section-7.4.1-3">Note that since TLS client certificates are sent in the clear, if
identity protection is required, then it is possible for the TLS
authentication to be renegotiated after the first server
authentication.  To accomplish this, the server will typically not
request a certificate in the server_hello; then, after the
server_finished message is sent and before TEAP Phase 2, the server
MAY send a TLS hello_request.  This allows the peer to perform client
authentication by sending a client_hello if it wants to or send a
no_renegotiation alert to the server indicating that it wants to
continue with TEAP Phase 2 instead.  Assuming that the peer permits
renegotiation by sending a client_hello, then the server will respond
with server_hello, certificate, and certificate_request messages.
The peer replies with certificate, client_key_exchange, and
certificate_verify messages.  Since this renegotiation occurs within
the encrypted TLS channel, it does not reveal client certificate
details.  It is possible to perform certificate authentication using
an EAP authentication method (for example, EAP-TLS) within the TLS session in TEAP
Phase 2 instead of using TLS handshake renegotiation.<a href="#section-7.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dictionary-attack-resistance">
<section id="section-7.4.2">
          <h4 id="name-dictionary-attack-resistanc">
<a href="#section-7.4.2" class="section-number selfRef">7.4.2. </a><a href="#name-dictionary-attack-resistanc" class="section-name selfRef">Dictionary Attack Resistance</a>
          </h4>
<p id="section-7.4.2-1">TEAP was designed with a focus on protected inner methods
that typically rely on weak credentials, such as password-based
secrets.  TEAP mitigates offline dictionary attacks by allowing the
establishment of a mutually authenticated encrypted TLS tunnel
providing confidentiality and integrity to protect the weak
credential-based inner method.<a href="#section-7.4.2-1" class="pilcrow">¶</a></p>
<p id="section-7.4.2-2">TEAP mitigates dictionary attacks by permitting inner methods such as
EAP-pwd which are not vulnerable to dictionary attacks.<a href="#section-7.4.2-2" class="pilcrow">¶</a></p>
<p id="section-7.4.2-3">TEAP implementations can mitigate against online "brute force"
dictionary attempts by limiting the number of failed authentication
attempts for a particular identity.<a href="#section-7.4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protection-against-man-in-the-middle-attacks">
<section id="section-7.4.3">
          <h4 id="name-protection-against-man-in-t">
<a href="#section-7.4.3" class="section-number selfRef">7.4.3. </a><a href="#name-protection-against-man-in-t" class="section-name selfRef">Protection against Man-in-the-Middle Attacks</a>
          </h4>
<p id="section-7.4.3-1">Allowing authentication methods to be executed both with and without the protection
of a secure tunnel opens up a possibility of a man-in-the-middle
attack.  To avoid man-in-the-middle attacks it is recommended to
always deploy authentication methods with the protection of TEAP.
TEAP provides protection from man-in-the-middle attacks even if a
deployment chooses to execute inner methods both with and without
TEAP protection.  TEAP prevents this attack in two ways:<a href="#section-7.4.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.4.3-2">
<li id="section-7.4.3-2.1">By using the PAC-Key to mutually authenticate the peer and server
during TEAP authentication Phase 1 establishment of a secure
tunnel.<a href="#section-7.4.3-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-7.4.3-2.2">By using the keys generated by the inner method
(if the inner methods are key generating) in the crypto-binding
exchange and in the generation of the key material exported by
the EAP authentication method described in <a href="#cryptographic-calculations" class="auto internal xref">Section 5</a>.<a href="#section-7.4.3-2.2" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-7.4.3-3">TEAP crypto binding does not guarantee man-in-the-middle protection
if the client allows a connection to an untrusted server, such as in
the case where the client does not properly validate the server's
certificate.  If the TLS ciphersuite derives the master secret solely
from the contribution of secret data from one side of the
conversation (such as ciphersuites based on RSA key transport), then
an attacker who can convince the client to connect and engage in
authentication can impersonate the client to another server even if a
strong inner method is executed within the tunnel.  If the TLS
ciphersuite derives the master secret from the contribution of
secrets from both sides of the conversation (such as in ciphersuites
based on Diffie-Hellman), then crypto binding can detect an attacker
in the conversation if a strong inner method is used.<a href="#section-7.4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pac-binding-to-user-identity">
<section id="section-7.4.4">
          <h4 id="name-pac-binding-to-user-identit">
<a href="#section-7.4.4" class="section-number selfRef">7.4.4. </a><a href="#name-pac-binding-to-user-identit" class="section-name selfRef">PAC Binding to User Identity</a>
          </h4>
<p id="section-7.4.4-1">A PAC may be bound to a user identity.  A compliant implementation of
TEAP MUST validate that an identity obtained in the PAC-Opaque field
matches at minimum one of the identities provided in the TEAP Phase 2
inner method.  This validation provides another binding to
ensure that the intended peer (based on identity) has successfully
completed the TEAP Phase 1 and proved identity in the Phase 2
conversations.<a href="#section-7.4.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="protecting-against-forged-cleartext-eap-packets">
<section id="section-7.5">
        <h3 id="name-protecting-against-forged-c">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-protecting-against-forged-c" class="section-name selfRef">Protecting against Forged Cleartext EAP Packets</a>
        </h3>
<p id="section-7.5-1">EAP Success and EAP Failure packets are, in general, sent in
cleartext and may be forged by an attacker without detection.  Forged
EAP Failure packets can be used to attempt to convince an EAP peer to
disconnect.  Forged EAP Success packets may be used to attempt to
convince a peer that authentication has succeeded, even though the
authenticator has not authenticated itself to the peer.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">By providing message confidentiality and integrity, TEAP provides
protection against these attacks.  Once the peer and authentication
server (AS) initiate the TEAP authentication Phase 2, compliant TEAP
implementations MUST silently discard all cleartext EAP messages,
unless both the TEAP peer and server have indicated success or
failure using a protected mechanism.  Protected mechanisms include
the TLS alert mechanism and the protected termination mechanism
described in <a href="#protected-termination" class="auto internal xref">Section 3.3.4</a>.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
<p id="section-7.5-3">The success/failure decisions within the TEAP tunnel indicate the
final decision of the TEAP authentication conversation.  After a
success/failure result has been indicated by a protected mechanism,
the TEAP peer can process unprotected EAP Success and EAP Failure
messages; however, the peer MUST ignore any unprotected EAP Success
or Failure messages where the result does not match the result of the
protected mechanism.<a href="#section-7.5-3" class="pilcrow">¶</a></p>
<p id="section-7.5-4">To abide by <span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span>, the server sends a cleartext EAP Success or
EAP Failure packet to terminate the EAP conversation.  However, since
EAP Success and EAP Failure packets are not retransmitted, the final
packet may be lost.  While a TEAP-protected EAP Success or EAP
Failure packet should not be a final packet in a TEAP conversation,
it may occur based on the conditions stated above, so an EAP peer
should not rely upon the unprotected EAP Success and Failure
messages.<a href="#section-7.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-certificate-validation">
<section id="section-7.6">
        <h3 id="name-server-certificate-validati">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-server-certificate-validati" class="section-name selfRef">Server Certificate Validation</a>
        </h3>
<p id="section-7.6-1">As part of the TLS negotiation, the server presents a certificate to
the peer.  The peer SHOULD verify the validity of the EAP server
certificate and SHOULD also examine the EAP server name presented in
the certificate in order to determine whether the EAP server can be
trusted.  When performing server certificate validation,
implementations MUST provide support for the rules in <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> for
validating certificates against a known trust anchor.  In addition,
implementations MUST support matching the realm portion of the peer's
NAI against a SubjectAltName of type dNSName within the server
certificate.  However, in certain deployments, this might not be
turned on.  Please note that in the case where the EAP authentication
is remote, the EAP server will not reside on the same machine as the
authenticator, and therefore, the name in the EAP server's
certificate cannot be expected to match that of the intended
destination.  In this case, a more appropriate test might be whether
the EAP server's certificate is signed by a certification authority
(CA) controlling the intended domain and whether the authenticator
can be authorized by a server in that domain.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tunnel-pac-considerations">
<section id="section-7.7">
        <h3 id="name-tunnel-pac-considerations">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-tunnel-pac-considerations" class="section-name selfRef">Tunnel PAC Considerations</a>
        </h3>
<p id="section-7.7-1">Since the Tunnel PAC is stored by the peer, special care should be
given to the overall security of the peer.  The Tunnel PAC MUST be
securely stored by the peer to prevent theft or forgery of any of the
Tunnel PAC components.  In particular, the peer MUST securely store
the PAC-Key and protect it from disclosure or modification.
Disclosure of the PAC-Key enables an attacker to establish the TEAP
tunnel; however, disclosure of the PAC-Key does not reveal the peer
or server identity or compromise any other peer's PAC credentials.
Modification of the PAC-Key or PAC-Opaque components of the Tunnel
PAC may also lead to denial of service as the tunnel establishment
will fail.  The PAC-Opaque component is the effective TLS ticket
extension used to establish the tunnel using the techniques of
<span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span>.  Thus, the security considerations defined by <span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span>
also apply to the PAC-Opaque.  The PAC-Info may contain information
about the Tunnel PAC such as the identity of the PAC issuer and the
Tunnel PAC lifetime for use in the management of the Tunnel PAC.  The
PAC-Info should be securely stored by the peer to protect it from
disclosure and modification.<a href="#section-7.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-claims">
<section id="section-7.8">
        <h3 id="name-security-claims">
<a href="#section-7.8" class="section-number selfRef">7.8. </a><a href="#name-security-claims" class="section-name selfRef">Security Claims</a>
        </h3>
<p id="section-7.8-1">This section provides the needed security claim requirement for EAP
<span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span>.<a href="#section-7.8-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.8-2">
<pre>
Auth. mechanism:         Certificate-based, shared-secret-based, and
                         various tunneled authentication mechanisms.

Ciphersuite negotiation: Yes

Mutual authentication:   Yes

Integrity protection:    Yes.  Any method executed within the TEAP
                         tunnel is integrity protected.  The
                         cleartext EAP headers outside the tunnel are
                         not integrity protected.

Replay protection:       Yes

Confidentiality:         Yes

Key derivation:          Yes

Key strength:            See Note 1 below.

Dictionary attack prot.: See Note 2 below.

Fast reconnect:          Yes

Cryptographic binding:   Yes

Session independence:    Yes

Fragmentation:           Yes

Key Hierarchy:           Yes

Channel binding:         Yes
</pre><a href="#section-7.8-2" class="pilcrow">¶</a>
</div>
<p id="section-7.8-3">Notes<a href="#section-7.8-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.8-4">
<li id="section-7.8-4.1">BCP 86 <span>[<a href="#RFC3766" class="cite xref">RFC3766</a>]</span> offers advice on appropriate key sizes.  The
National Institute for Standards and Technology (NIST) also
offers advice on appropriate key sizes in <span>[<a href="#NIST-SP-800-57" class="cite xref">NIST-SP-800-57</a>]</span>.
<span>[<a href="#RFC3766" class="cite xref">RFC3766</a>]</span>, <a href="#cryptographic-calculations" class="auto internal xref">Section 5</a> advises use of the following required RSA or
DH (Diffie-Hellman) module and DSA (Digital Signature Algorithm)
subgroup size in bits for a given level of attack resistance in
bits.  Based on the table below, a 2048-bit RSA key is required
to provide 112-bit equivalent key strength:<a href="#section-7.8-4.1" class="pilcrow">¶</a>
</li>
        </ol>
<div class="alignLeft art-text artwork" id="section-7.8-5">
<pre>
    Attack Resistance     RSA or DH Modulus            DSA subgroup
     (bits)                  size (bits)                size (bits)
    -----------------     -----------------            ------------
       70                        947                        129
       80                       1228                        148
       90                       1553                        167
      100                       1926                        186
      150                       4575                        284
      200                       8719                        383
      250                      14596                        482
</pre><a href="#section-7.8-5" class="pilcrow">¶</a>
</div>
<ol start="1" type="1" class="normal type-1" id="section-7.8-6">
<li id="section-7.8-6.1">TEAP protects against offline dictionary attacks when secure inner
methods are used.  TEAP protects against online dictionary attacks by
limiting the number of failed authentications for a particular
identity.<a href="#section-7.8-6.1" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="section-8">
      <h2 id="name-acknowledgements">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-8-1">Nearly all of the text in this document was taken directly from
<span>[<a href="#RFC7170" class="cite xref">RFC7170</a>]</span>. We are grateful to the original authors and reviewers for
that document.  The acknowledgements given here are only for the
changes which resulted in this document.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Alexander Clouter provided substantial and detailed technical feedback
on nearly every aspect of the specification.  The corrections in this
document are based on his work.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">We wish to thank the many reviewers and commenters in the EMU WG,
including Eliot Lear, Jouni Malinen, Joe Salowey, Heikki Vatiainen,
and Bruno Pereria Vidal.<a href="#section-8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="changes-from-rfc-7170">
<section id="section-9">
      <h2 id="name-changes-from-rfc-7170">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-changes-from-rfc-7170" class="section-name selfRef">Changes from RFC 7170</a>
      </h2>
<p id="section-9-1">Alan DeKok was added as editor.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">The document was converted to Markdown, from the <span>[<a href="#RFC7170" class="cite xref">RFC7170</a>]</span> text output.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">Any formatting changes mostly result from differences between using Markdown
versus XML for source.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">The IANA considerations section was replaced with a note to change the
IANA registry references to this document.<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">A new section was added to explain that the inner EAP-MSCHAPv2
derivation follows EAP-FAST.  This is the largest technical change
from the previous revision of this document, and follows existing implementations.<a href="#section-9-5" class="pilcrow">¶</a></p>
<p id="section-9-6">Many small changes have been made throughout the document to correct
inconsistencies, and to address mistakes.  At a high level:<a href="#section-9-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-7.1">All open errata have been addressed.<a href="#section-9-7.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-7.2">A new term "inner method" has been defined.<a href="#section-9-7.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-7.3">The definitions and derivation of IMSK, S-IMCK, etc. have been corrected and clarified.<a href="#section-9-7.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-7.4">The diagrams in Appendix C have been updated to match the TEAP state machine<a href="#section-9-7.4" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="appendix-a-evaluation-against-tunnel-based-eap-method-requirements">
<section id="section-10">
      <h2 id="name-appendix-a-evaluation-again">
<a href="#name-appendix-a-evaluation-again" class="section-name selfRef">Appendix A Evaluation against Tunnel-Based EAP Method Requirements</a>
      </h2>
<p id="section-10-1">This section evaluates all tunnel-based EAP method requirements
described in <span>[<a href="#RFC6678" class="cite xref">RFC6678</a>]</span> against TEAP version 1.<a href="#section-10-1" class="pilcrow">¶</a></p>
<div id="a1-requirement-411-rfc-compliance">
<section id="section-10.1">
        <h3 id="name-a1-requirement-411-rfc-comp">
<a href="#name-a1-requirement-411-rfc-comp" class="section-name selfRef">A.1.  Requirement 4.1.1: RFC Compliance</a>
        </h3>
<p id="section-10.1-1">TEAPv1 meets this requirement by being compliant with RFC 3748
<span>[<a href="#RFC3748" class="cite xref">RFC3748</a>]</span>, RFC 4017 <span>[<a href="#RFC4017" class="cite xref">RFC4017</a>]</span>, RFC 5247 <span>[<a href="#RFC5247" class="cite xref">RFC5247</a>]</span>, and RFC 4962
<span>[<a href="#RFC4962" class="cite xref">RFC4962</a>]</span>.  It is also compliant with the "cryptographic algorithm
agility" requirement by leveraging TLS 1.2 for all cryptographic
algorithm negotiation.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a2-requirement-421-tls-requirements">
<section id="section-10.2">
        <h3 id="name-a2-requirement-421-tls-requ">
<a href="#name-a2-requirement-421-tls-requ" class="section-name selfRef">A.2.  Requirement 4.2.1: TLS Requirements</a>
        </h3>
<p id="section-10.2-1">TEAPv1 meets this requirement by mandating TLS version 1.2 support as
defined in <a href="#phase1" class="auto internal xref">Section 5.1</a>.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a3-requirement-42111-ciphersuite-negotiation">
<section id="section-10.3">
        <h3 id="name-a3-requirement-42111-cipher">
<a href="#name-a3-requirement-42111-cipher" class="section-name selfRef">A.3.  Requirement 4.2.1.1.1: Ciphersuite Negotiation</a>
        </h3>
<p id="section-10.3-1">TEAPv1 meets this requirement by using TLS to provide protected
ciphersuite negotiation.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a4-requirement-42112-tunnel-data-protection-algorithms">
<section id="section-10.4">
        <h3 id="name-a4-requirement-42112-tunnel">
<a href="#name-a4-requirement-42112-tunnel" class="section-name selfRef">A.4.  Requirement 4.2.1.1.2: Tunnel Data Protection Algorithms</a>
        </h3>
<p id="section-10.4-1">TEAPv1 meets this requirement by mandating
TLS_RSA_WITH_AES_128_CBC_SHA as a mandatory-to-implement ciphersuite
as defined in <a href="#phase1" class="auto internal xref">Section 5.1</a>.<a href="#section-10.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a5-requirement-42113-tunnel-authentication-and-key-establishment">
<section id="section-10.5">
        <h3 id="name-a5-requirement-42113-tunnel">
<a href="#name-a5-requirement-42113-tunnel" class="section-name selfRef">A.5.  Requirement 4.2.1.1.3: Tunnel Authentication and Key Establishment</a>
        </h3>
<p id="section-10.5-1">TEAPv1 meets this requirement by mandating
TLS_RSA_WITH_AES_128_CBC_SHA as a mandatory-to-implement ciphersuite
that provides certificate-based authentication of the server and is
approved by NIST.  The mandatory-to-implement ciphersuites only
include ciphersuites that use strong cryptographic algorithms.  They
do not include ciphersuites providing mutually anonymous
authentication or static Diffie-Hellman ciphersuites as defined in
<a href="#phase1" class="auto internal xref">Section 5.1</a>.<a href="#section-10.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a6-requirement-4212-tunnel-replay-protection">
<section id="section-10.6">
        <h3 id="name-a6-requirement-4212-tunnel-">
<a href="#name-a6-requirement-4212-tunnel-" class="section-name selfRef">A.6.  Requirement 4.2.1.2: Tunnel Replay Protection</a>
        </h3>
<p id="section-10.6-1">TEAPv1 meets this requirement by using TLS to provide sufficient
replay protection.<a href="#section-10.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a7-requirement-4213-tls-extensions">
<section id="section-10.7">
        <h3 id="name-a7-requirement-4213-tls-ext">
<a href="#name-a7-requirement-4213-tls-ext" class="section-name selfRef">A.7.  Requirement 4.2.1.3: TLS Extensions</a>
        </h3>
<p id="section-10.7-1">TEAPv1 meets this requirement by allowing TLS extensions, such as TLS
Certificate Status Request extension <span>[<a href="#RFC6066" class="cite xref">RFC6066</a>]</span> and SessionTicket
extension <span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span>, to be used during TLS tunnel establishment.<a href="#section-10.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a8-requirement-4214-peer-identity-privacy">
<section id="section-10.8">
        <h3 id="name-a8-requirement-4214-peer-id">
<a href="#name-a8-requirement-4214-peer-id" class="section-name selfRef">A.8.  Requirement 4.2.1.4: Peer Identity Privacy</a>
        </h3>
<p id="section-10.8-1">TEAPv1 meets this requirement by establishment of the TLS tunnel and
protection identities specific to the inner method.  In addition, the
peer certificate can be sent confidentially (i.e., encrypted).<a href="#section-10.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a9-requirement-4215-session-resumption">
<section id="section-10.9">
        <h3 id="name-a9-requirement-4215-session">
<a href="#name-a9-requirement-4215-session" class="section-name selfRef">A.9.  Requirement 4.2.1.5: Session Resumption</a>
        </h3>
<p id="section-10.9-1">TEAPv1 meets this requirement by mandating support of TLS session
resumption as defined in <a href="#resume-server-state" class="auto internal xref">Section 3.2.1</a> and TLS session resume using a
PAC as defined in <a href="#resume-pac" class="auto internal xref">Section 3.2.2</a> .<a href="#section-10.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a10-requirement-422-fragmentation">
<section id="section-10.10">
        <h3 id="name-a10-requirement-422-fragmen">
<a href="#name-a10-requirement-422-fragmen" class="section-name selfRef">A.10.  Requirement 4.2.2: Fragmentation</a>
        </h3>
<p id="section-10.10-1">TEAPv1 meets this requirement by leveraging fragmentation support
provided by TLS as defined in <a href="#fragmentation" class="auto internal xref">Section 3.7</a>.<a href="#section-10.10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a11-requirement-423-protection-of-data-external-to-tunnel">
<section id="section-10.11">
        <h3 id="name-a11-requirement-423-protect">
<a href="#name-a11-requirement-423-protect" class="section-name selfRef">A.11.  Requirement 4.2.3: Protection of Data External to Tunnel</a>
        </h3>
<p id="section-10.11-1">TEAPv1 meets this requirement by including the TEAP version number
received in the computation of the Crypto-Binding TLV as defined in
<a href="#crypto-binding-tlv" class="auto internal xref">Section 4.2.13</a>.<a href="#section-10.11-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a12-requirement-431-extensible-attribute-types">
<section id="section-10.12">
        <h3 id="name-a12-requirement-431-extensi">
<a href="#name-a12-requirement-431-extensi" class="section-name selfRef">A.12.  Requirement 4.3.1: Extensible Attribute Types</a>
        </h3>
<p id="section-10.12-1">TEAPv1 meets this requirement by using an extensible TLV data layer
inside the tunnel as defined in <a href="#teap-tlv-format" class="auto internal xref">Section 4.2</a>.<a href="#section-10.12-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a13-requirement-432-requestchallenge-response-operation">
<section id="section-10.13">
        <h3 id="name-a13-requirement-432-request">
<a href="#name-a13-requirement-432-request" class="section-name selfRef">A.13.  Requirement 4.3.2: Request/Challenge Response Operation</a>
        </h3>
<p id="section-10.13-1">TEAPv1 meets this requirement by allowing multiple TLVs to be sent in
a single EAP request or response packet, while maintaining the half-
duplex operation typical of EAP.<a href="#section-10.13-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a14-requirement-433-indicating-criticality-of-attributes">
<section id="section-10.14">
        <h3 id="name-a14-requirement-433-indicat">
<a href="#name-a14-requirement-433-indicat" class="section-name selfRef">A.14.  Requirement 4.3.3: Indicating Criticality of Attributes</a>
        </h3>
<p id="section-10.14-1">TEAPv1 meets this requirement by having a mandatory bit in each TLV
to indicate whether it is mandatory to support or not as defined in
<a href="#teap-tlv-format" class="auto internal xref">Section 4.2</a>.<a href="#section-10.14-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a15-requirement-434-vendor-specific-support">
<section id="section-10.15">
        <h3 id="name-a15-requirement-434-vendor-">
<a href="#name-a15-requirement-434-vendor-" class="section-name selfRef">A.15.  Requirement 4.3.4: Vendor-Specific Support</a>
        </h3>
<p id="section-10.15-1">TEAPv1 meets this requirement by having a Vendor-Specific TLV to
allow vendors to define their own attributes as defined in
<a href="#vendor-specific-tlv" class="auto internal xref">Section 4.2.8</a>.<a href="#section-10.15-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a16-requirement-435-result-indication">
<section id="section-10.16">
        <h3 id="name-a16-requirement-435-result-">
<a href="#name-a16-requirement-435-result-" class="section-name selfRef">A.16.  Requirement 4.3.5: Result Indication</a>
        </h3>
<p id="section-10.16-1">TEAPv1 meets this requirement by having a Result TLV to exchange the
final result of the EAP authentication so both the peer and server
have a synchronized state as defined in <a href="#result-tlv" class="auto internal xref">Section 4.2.4</a>.<a href="#section-10.16-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a17-requirement-436-internationalization-of-display-strings">
<section id="section-10.17">
        <h3 id="name-a17-requirement-436-interna">
<a href="#name-a17-requirement-436-interna" class="section-name selfRef">A.17.  Requirement 4.3.6: Internationalization of Display Strings</a>
        </h3>
<p id="section-10.17-1">TEAPv1 meets this requirement by supporting UTF-8 format in the
Basic-Password-Auth-Req TLV as defined in <a href="#bp-auth-req-tlv" class="auto internal xref">Section 4.2.14</a> and the
Basic-Password-Auth-Resp TLV as defined in Section 4.2.15.<a href="#section-10.17-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a18-requirement-44-eap-channel-binding-requirements">
<section id="section-10.18">
        <h3 id="name-a18-requirement-44-eap-chan">
<a href="#name-a18-requirement-44-eap-chan" class="section-name selfRef">A.18.  Requirement 4.4: EAP Channel-Binding Requirements</a>
        </h3>
<p id="section-10.18-1">TEAPv1 meets this requirement by having a Channel-Binding TLV to
exchange the EAP channel-binding data as defined in <a href="#channel-binding-tlv" class="auto internal xref">Section 4.2.7</a>.<a href="#section-10.18-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a19-requirement-4511-confidentiality-and-integrity">
<section id="section-10.19">
        <h3 id="name-a19-requirement-4511-confid">
<a href="#name-a19-requirement-4511-confid" class="section-name selfRef">A.19.  Requirement 4.5.1.1: Confidentiality and Integrity</a>
        </h3>
<p id="section-10.19-1">TEAPv1 meets this requirement by running the password authentication
inside a protected TLS tunnel.<a href="#section-10.19-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a20-requirement-4512-authentication-of-server">
<section id="section-10.20">
        <h3 id="name-a20-requirement-4512-authen">
<a href="#name-a20-requirement-4512-authen" class="section-name selfRef">A.20.  Requirement 4.5.1.2: Authentication of Server</a>
        </h3>
<p id="section-10.20-1">TEAPv1 meets this requirement by mandating authentication of the
server before establishment of the protected TLS and then running
inner password authentication as defined in <a href="#phase1" class="auto internal xref">Section 5.1</a>.<a href="#section-10.20-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a21-requirement-4513-server-certificate-revocation-checking">
<section id="section-10.21">
        <h3 id="name-a21-requirement-4513-server">
<a href="#name-a21-requirement-4513-server" class="section-name selfRef">A.21.  Requirement 4.5.1.3: Server Certificate Revocation Checking</a>
        </h3>
<p id="section-10.21-1">TEAPv1 meets this requirement by supporting TLS Certificate Status
Request extension <span>[<a href="#RFC6066" class="cite xref">RFC6066</a>]</span> during tunnel establishment.<a href="#section-10.21-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a22-requirement-452-internationalization">
<section id="section-10.22">
        <h3 id="name-a22-requirement-452-interna">
<a href="#name-a22-requirement-452-interna" class="section-name selfRef">A.22.  Requirement 4.5.2: Internationalization</a>
        </h3>
<p id="section-10.22-1">TEAPv1 meets this requirement by supporting UTF-8 format in Basic-
Password-Auth-Req TLV as defined in <a href="#bp-auth-req-tlv" class="auto internal xref">Section 4.2.14</a> and Basic-
Password-Auth-Resp TLV as defined in Section 4.2.15.<a href="#section-10.22-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a23-requirement-453-metadata">
<section id="section-10.23">
        <h3 id="name-a23-requirement-453-metadat">
<a href="#name-a23-requirement-453-metadat" class="section-name selfRef">A.23.  Requirement 4.5.3: Metadata</a>
        </h3>
<p id="section-10.23-1">TEAPv1 meets this requirement by supporting Identity-Type TLV as
defined in <a href="#identity-type-tlv" class="auto internal xref">Section 4.2.3</a> to indicate whether the authentication is
for a user or a machine.<a href="#section-10.23-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a24-requirement-454-password-change">
<section id="section-10.24">
        <h3 id="name-a24-requirement-454-passwor">
<a href="#name-a24-requirement-454-passwor" class="section-name selfRef">A.24.  Requirement 4.5.4: Password Change</a>
        </h3>
<p id="section-10.24-1">TEAPv1 meets this requirement by supporting multiple Basic-Password-
Auth-Req TLV and Basic-Password-Auth-Resp TLV exchanges within a
single EAP authentication, which allows "housekeeping"" functions
such as password change.<a href="#section-10.24-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a25-requirement-461-method-negotiation">
<section id="section-10.25">
        <h3 id="name-a25-requirement-461-method-">
<a href="#name-a25-requirement-461-method-" class="section-name selfRef">A.25.  Requirement 4.6.1: Method Negotiation</a>
        </h3>
<p id="section-10.25-1">TEAPv1 meets this requirement by supporting inner EAP method
negotiation within the protected TLS tunnel.<a href="#section-10.25-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a26-requirement-462-chained-methods">
<section id="section-10.26">
        <h3 id="name-a26-requirement-462-chained">
<a href="#name-a26-requirement-462-chained" class="section-name selfRef">A.26.  Requirement 4.6.2: Chained Methods</a>
        </h3>
<p id="section-10.26-1">TEAPv1 meets this requirement by supporting inner EAP method chaining
within protected TLS tunnels as defined in <a href="#inner-eap" class="auto internal xref">Section 3.3.1</a>.<a href="#section-10.26-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a27-requirement-463-cryptographic-binding-with-the-tls-tunnel">
<section id="section-10.27">
        <h3 id="name-a27-requirement-463-cryptog">
<a href="#name-a27-requirement-463-cryptog" class="section-name selfRef">A.27.  Requirement 4.6.3: Cryptographic Binding with the TLS Tunnel</a>
        </h3>
<p id="section-10.27-1">TEAPv1 meets this requirement by supporting cryptographic binding of
the inner EAP method keys with the keys derived from the TLS tunnel
as defined in <a href="#crypto-binding-tlv" class="auto internal xref">Section 4.2.13</a>.<a href="#section-10.27-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a28-requirement-464-peer-initiated-eap-authentication">
<section id="section-10.28">
        <h3 id="name-a28-requirement-464-peer-in">
<a href="#name-a28-requirement-464-peer-in" class="section-name selfRef">A.28.  Requirement 4.6.4: Peer-Initiated EAP Authentication</a>
        </h3>
<p id="section-10.28-1">TEAPv1 meets this requirement by supporting the Request-Action TLV as
defined in <a href="#request-action-tlv" class="auto internal xref">Section 4.2.9</a> to allow a peer to initiate another inner
EAP method.<a href="#section-10.28-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a29-requirement-465-method-metadata">
<section id="section-10.29">
        <h3 id="name-a29-requirement-465-method-">
<a href="#name-a29-requirement-465-method-" class="section-name selfRef">A.29.  Requirement 4.6.5: Method Metadata</a>
        </h3>
<p id="section-10.29-1">TEAPv1 meets this requirement by supporting the Identity-Type TLV as
defined in <a href="#identity-type-tlv" class="auto internal xref">Section 4.2.3</a> to indicate whether the authentication is
for a user or a machine.<a href="#section-10.29-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="appendix-b-major-differences-from-eap-fast">
<section id="section-11">
      <h2 id="name-appendix-b-major-difference">
<a href="#name-appendix-b-major-difference" class="section-name selfRef">Appendix B.  Major Differences from EAP-FAST</a>
      </h2>
<p id="section-11-1">This document is a new standard tunnel EAP method based on revision
of EAP-FAST version 1 <span>[<a href="#RFC4851" class="cite xref">RFC4851</a>]</span> that contains improved flexibility,
particularly for negotiation of cryptographic algorithms.  The major
changes are:<a href="#section-11-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-11-2">
<li id="section-11-2.1">The EAP method name has been changed from EAP-FAST to TEAP; this
change thus requires that a new EAP Type be assigned.<a href="#section-11-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-11-2.2">This version of TEAP MUST support TLS 1.2 <span>[<a href="#RFC5246" class="cite xref">RFC5246</a>]</span>.  TLS 1.1 and earlier MUST NOT be used with TEAP.<a href="#section-11-2.2" class="pilcrow">¶</a>
</li>
        <li id="section-11-2.3">The key derivation now makes use of TLS keying material exporters
<span>[<a href="#RFC5705" class="cite xref">RFC5705</a>]</span> and the PRF and hash function negotiated in TLS.  This
is to simplify implementation and better support cryptographic
algorithm agility.<a href="#section-11-2.3" class="pilcrow">¶</a>
</li>
        <li id="section-11-2.4">TEAP is in full conformance with TLS ticket extension <span>[<a href="#RFC5077" class="cite xref">RFC5077</a>]</span>
as described in <a href="#resume-pac" class="auto internal xref">Section 3.2.2</a>.<a href="#section-11-2.4" class="pilcrow">¶</a>
</li>
        <li id="section-11-2.5">Support is provided for passing optional Outer TLVs in the first
two message exchanges, in addition to the Authority-ID TLV data
in EAP-FAST.<a href="#section-11-2.5" class="pilcrow">¶</a>
</li>
        <li id="section-11-2.6">Basic password authentication on the TLV level has been added in
addition to the existing inner EAP method.<a href="#section-11-2.6" class="pilcrow">¶</a>
</li>
        <li id="section-11-2.7">Additional TLV types have been defined to support EAP channel
binding and metadata.  They are the Identity-Type TLV and
Channel-Binding TLVs, defined in <a href="#teap-tlv-format" class="auto internal xref">Section 4.2</a>.<a href="#section-11-2.7" class="pilcrow">¶</a>
</li>
      </ol>
</section>
</div>
<div id="appendix-c-examples">
<section id="section-12">
      <h2 id="name-appendix-c-examples">
<a href="#name-appendix-c-examples" class="section-name selfRef">Appendix C.  Examples</a>
      </h2>
<div id="c1-successful-authentication">
<section id="section-12.1">
        <h3 id="name-c1-successful-authenticatio">
<a href="#name-c1-successful-authenticatio" class="section-name selfRef">C.1.  Successful Authentication</a>
        </h3>
<p id="section-12.1-1">The following exchanges show a successful TEAP authentication with
basic password authentication and optional PAC refreshment.  The
conversation will appear as follows:<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-12.1-2">
<pre>
   Authenticating Peer     Authenticator
   -------------------     -------------
                           &lt;- EAP-Request/
                           Identity
   EAP-Response/
   Identity (MyID1) -&gt;
                           &lt;- EAP-Request/
                           EAP-Type=TEAP, V=1
                           (TEAP Start, S bit set, Authority-ID)

   EAP-Response/
   EAP-Type=TEAP, V=1
   (TLS client_hello with
    PAC-Opaque in SessionTicket extension)-&gt;

                           &lt;- EAP-Request/
                           EAP-Type=TEAP, V=1
                           (TLS server_hello,
                           (TLS change_cipher_spec,
                            TLS finished)

   EAP-Response/
   EAP-Type=TEAP, V=1 -&gt;
   (TLS change_cipher_spec,
    TLS finished)

   TLS channel established
   (messages sent within the TLS channel)

                          &lt;- Basic-Password-Auth-Req TLV, Challenge

   Basic-Password-Auth-Resp TLV, Response with both
   username and password) -&gt;

   optional additional exchanges (new pin mode,
   password change, etc.) ...

                        &lt;- Intermediate-Result-TLV (Success),
                            Crypto-Binding TLV (Request),
                            Result TLV (Success),
                            (Optional PAC TLV)

   Intermediate-Result-TLV (Success),
   Crypto-Binding TLV(Response),
   Result TLV (Success),
   (PAC-Acknowledgement TLV) -&gt;

   TLS channel torn down
   (messages sent in cleartext)

                           &lt;- EAP-Success
</pre><a href="#section-12.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="c2-failed-authentication">
<section id="section-12.2">
        <h3 id="name-c2-failed-authentication">
<a href="#name-c2-failed-authentication" class="section-name selfRef">C.2.  Failed Authentication</a>
        </h3>
<p id="section-12.2-1">The following exchanges show a failed TEAP authentication due to
wrong user credentials.  The conversation will appear as follows:<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-12.2-2">
<pre>
   Authenticating Peer     Authenticator
   -------------------     -------------
                           &lt;- EAP-Request/Identity

   EAP-Response/
   Identity (MyID1) -&gt;


                           &lt;- EAP-Request/
                           EAP-Type=TEAP, V=1
                           (TEAP Start, S bit set, Authority-ID)

   EAP-Response/
   EAP-Type=TEAP, V=1
   (TLS client_hello with
    PAC-Opaque in SessionTicket extension)-&gt;

                           &lt;- EAP-Request/
                           EAP-Type=TEAP, V=1
                           (TLS server_hello,
                           (TLS change_cipher_spec,
                            TLS finished)

   EAP-Response/
   EAP-Type=TEAP, V=1 -&gt;
   (TLS change_cipher_spec,
    TLS finished)

   TLS channel established
   (messages sent within the TLS channel)

                          &lt;- Basic-Password-Auth-Req TLV, Challenge

   Basic-Password-Auth-Resp TLV, Response with both
   username and password) -&gt;

                           &lt;- Intermediate-Result-TLV (Failure),
                              Result TLV (Failure)

   Intermediate-Result-TLV (Failure),
   Result TLV (Failure) -&gt;

   TLS channel torn down
   (messages sent in cleartext)

                           &lt;- EAP-Failure
</pre><a href="#section-12.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="c3-full-tls-handshake-using-certificate-based-ciphersuite">
<section id="section-12.3">
        <h3 id="name-c3-full-tls-handshake-using">
<a href="#name-c3-full-tls-handshake-using" class="section-name selfRef">C.3.  Full TLS Handshake Using Certificate-Based Ciphersuite</a>
        </h3>
<p id="section-12.3-1">In the case within TEAP Phase 1 where an abbreviated TLS handshake is
tried, fails, and falls back to the certificate-based full TLS
handshake, the conversation will appear as follows:<a href="#section-12.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-12.3-2">
<pre>
  Authenticating Peer    Authenticator
  -------------------    -------------
                         &lt;- EAP-Request/Identity
  EAP-Response/
  Identity (MyID1) -&gt;

  // Identity sent in the clear.  May be a hint to help route
     the authentication request to EAP server, instead of the
     full user identity.

                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TEAP Start, S bit set, Authority-ID)
  EAP-Response/
  EAP-Type=TEAP, V=1
  (TLS client_hello with
  PAC-Opaque in SessionTicket extension)-&gt;

  // Peer sends PAC-Opaque of Tunnel PAC along with a list of
     ciphersuites supported.  If the server rejects the PAC-
     Opaque, it falls through to the full TLS handshake.

                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TLS server_hello,
                           TLS certificate,
                          [TLS server_key_exchange,]
                          [TLS certificate_request,]
                           TLS server_hello_done)

  EAP-Response/
  EAP-Type=TEAP, V=1
  ([TLS certificate,]
   TLS client_key_exchange,
  [TLS certificate_verify,]
   TLS change_cipher_spec,
   TLS finished) -&gt;
                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TLS change_cipher_spec,
                           TLS finished,
                           EAP-Payload-TLV[EAP-Request/
                           Identity])

  // TLS channel established
     (messages sent within the TLS channel)

  // First EAP Payload TLV is piggybacked to the TLS Finished as
     Application Data and protected by the TLS tunnel.

  EAP-Payload-TLV
  [EAP-Response/Identity (MyID2)]-&gt;

  // identity protected by TLS.

                           &lt;- EAP-Payload-TLV
                           [EAP-Request/EAP-Type=X]

  EAP-Payload-TLV
  [EAP-Response/EAP-Type=X] -&gt;

  // Method X exchanges followed by Protected Termination

                       &lt;- Intermediate-Result-TLV (Success),
                           Crypto-Binding TLV (Request),
                           Result TLV (Success)

  Intermediate-Result-TLV (Success),
  Crypto-Binding TLV (Response),
  Result-TLV (Success) -&gt;

  // TLS channel torn down
  (messages sent in cleartext)

                          &lt;- EAP-Success
</pre><a href="#section-12.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="c4-client-authentication-during-phase-1-with-identity-privacy">
<section id="section-12.4">
        <h3 id="name-c4-client-authentication-du">
<a href="#name-c4-client-authentication-du" class="section-name selfRef">C.4.  Client Authentication during Phase 1 with Identity Privacy</a>
        </h3>
<p id="section-12.4-1">In the case where a certificate-based TLS handshake occurs within
TEAP Phase 1 and client certificate authentication and identity
privacy is desired (and therefore TLS renegotiation is being used to
transmit the peer credentials in the protected TLS tunnel), the
conversation will appear as follows:<a href="#section-12.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-12.4-2">
<pre>
  Authenticating Peer     Authenticator
  -------------------     -------------
                         &lt;- EAP-Request/Identity
  EAP-Response/
  Identity (MyID1) -&gt;

  // Identity sent in the clear.  May be a hint to help route
     the authentication request to EAP server, instead of the
     full user identity.

                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TEAP Start, S bit set, Authority-ID)
  EAP-Response/
  EAP-Type=TEAP, V=1
  (TLS client_hello)-&gt;
                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TLS server_hello,
                           TLS certificate,
                          [TLS server_key_exchange,]
                          [TLS certificate_request,]
                           TLS server_hello_done)
  EAP-Response/
  EAP-Type=TEAP, V=1
  (TLS client_key_exchange,
   TLS change_cipher_spec,
   TLS finished) -&gt;
                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TLS change_cipher_spec,
                           TLS finished,
                           EAP-Payload-TLV[EAP-Request/
                           Identity])

  // TLS channel established
     (EAP Payload messages sent within the TLS channel)

  // peer sends TLS client_hello to request TLS renegotiation
  TLS client_hello -&gt;

                          &lt;- TLS server_hello,
                           TLS certificate,
                           [TLS server_key_exchange,]
                           [TLS certificate_request,]
                           TLS server_hello_done
  [TLS certificate,]
   TLS client_key_exchange,
  [TLS certificate_verify,]
   TLS change_cipher_spec,
   TLS finished -&gt;

                          &lt;- TLS change_cipher_spec,
                             TLS finished,
                             Crypto-Binding TLV (Request),
                             Result TLV (Success)

  Crypto-Binding TLV (Response),
  Result-TLV (Success)) -&gt;

  //TLS channel torn down
  (messages sent in cleartext)

                          &lt;- EAP-Success
</pre><a href="#section-12.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="c5-fragmentation-and-reassembly">
<section id="section-12.5">
        <h3 id="name-c5-fragmentation-and-reasse">
<a href="#name-c5-fragmentation-and-reasse" class="section-name selfRef">C.5.  Fragmentation and Reassembly</a>
        </h3>
<p id="section-12.5-1">In the case where TEAP fragmentation is required, the conversation
will appear as follows:<a href="#section-12.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-12.5-2">
<pre>
  Authenticating Peer     Authenticator
  -------------------     -------------
                          &lt;- EAP-Request/
                          Identity
  EAP-Response/
  Identity (MyID) -&gt;
                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TEAP Start, S bit set, Authority-ID)

  EAP-Response/
  EAP-Type=TEAP, V=1
  (TLS client_hello)-&gt;

                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TLS server_hello,
                           TLS certificate,
                          [TLS server_key_exchange,]
                          [TLS certificate_request,]
                           TLS server_hello_done)
                          (Fragment 1: L, M bits set)

  EAP-Response/
  EAP-Type=TEAP, V=1 -&gt;

                          &lt;- EAP-Request/
                             EAP-Type=TEAP, V=1
                          (Fragment 2: M bit set)
  EAP-Response/
  EAP-Type=TEAP, V=1 -&gt;
                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (Fragment 3)
  EAP-Response/
  EAP-Type=TEAP, V=1
  ([TLS certificate,]
   TLS client_key_exchange,
  [TLS certificate_verify,]
   TLS change_cipher_spec,
   TLS finished)
   (Fragment 1: L, M bits set)-&gt;

                           &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
  EAP-Response/
  EAP-Type=TEAP, V=1
  (Fragment 2)-&gt;
                         &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TLS change_cipher_spec,
                           TLS finished,
                          [EAP-Payload-TLV[
                          EAP-Request/Identity]])

  // TLS channel established
     (messages sent within the TLS channel)

  // First EAP Payload TLV is piggybacked to the TLS Finished as
     Application Data and protected by the TLS tunnel.

  EAP-Payload-TLV
  [EAP-Response/Identity (MyID2)]-&gt;

  // identity protected by TLS.

                           &lt;- EAP-Payload-TLV
                           [EAP-Request/EAP-Type=X]

  EAP-Payload-TLV
  [EAP-Response/EAP-Type=X] -&gt;

  // Method X exchanges followed by Protected Termination

                       &lt;- Intermediate-Result-TLV (Success),
                           Crypto-Binding TLV (Request),
                           Result TLV (Success)

  Intermediate-Result-TLV (Success),
  Crypto-Binding TLV (Response),
  Result-TLV (Success) -&gt;

  // TLS channel torn down
  (messages sent in cleartext)

                          &lt;- EAP-Success
</pre><a href="#section-12.5-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="c6-sequence-of-eap-methods">
<section id="section-12.6">
        <h3 id="name-c6-sequence-of-eap-methods">
<a href="#name-c6-sequence-of-eap-methods" class="section-name selfRef">C.6.  Sequence of EAP Methods</a>
        </h3>
<p id="section-12.6-1">When TEAP is negotiated with a sequence of EAP method X followed by
method Y, the conversation will occur as follows:<a href="#section-12.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-12.6-2">
<pre>
  Authenticating Peer     Authenticator
  -------------------     -------------
                          &lt;- EAP-Request/
                          Identity
  EAP-Response/
  Identity (MyID1) -&gt;
                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TEAP Start, S bit set, Authority-ID)

  EAP-Response/
  EAP-Type=TEAP, V=1
  (TLS client_hello)-&gt;

                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TLS server_hello,
                           TLS certificate,
                          [TLS server_key_exchange,]
                          [TLS certificate_request,]
                           TLS server_hello_done)
  EAP-Response/
  EAP-Type=TEAP, V=1
  ([TLS certificate,]
   TLS client_key_exchange,
  [TLS certificate_verify,]
   TLS change_cipher_spec,
   TLS finished) -&gt;
                         &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TLS change_cipher_spec,
                           TLS finished,
                           Identity-Type TLV,
                          EAP-Payload-TLV[
                          EAP-Request/Identity])

  // TLS channel established
     (messages sent within the TLS channel)

  // First EAP Payload TLV is piggybacked to the TLS Finished as
     Application Data and protected by the TLS tunnel

  Identity_Type TLV
  EAP-Payload-TLV
  [EAP-Response/Identity] -&gt;

                          &lt;- EAP-Payload-TLV
                        [EAP-Request/EAP-Type=X]

  EAP-Payload-TLV
  [EAP-Response/EAP-Type=X] -&gt;

         // Optional additional X Method exchanges...

                         &lt;- EAP-Payload-TLV
                        [EAP-Request/EAP-Type=X]

  EAP-Payload-TLV
  [EAP-Response/EAP-Type=X]-&gt;

                          &lt;- Intermediate Result TLV (Success),
                           Crypto-Binding TLV (Request),
                           Identity-Type TLV,
                          EAP-Payload-TLV[
                          EAP-Request/Identity])

  // Compound MAC calculated using keys generated from
     EAP method X and the TLS tunnel.

  // Next EAP conversation started (with EAP-Request/Identity) after successful completion
     of previous method X.  The Intermediate-Result and Crypto-
     Binding TLVs are sent in the next packet to minimize round
     trips.

  Intermediate Result TLV (Success),
  Crypto-Binding TLV (Response),
  EAP-Payload-TLV [EAP-Response/Identity (MyID2)] -&gt;

         // Optional additional EAP method Y exchanges...

                         &lt;- EAP Payload TLV [
                         EAP-Type=Y]

  EAP Payload TLV
  [EAP-Type=Y] -&gt;

                         &lt;- Intermediate-Result-TLV (Success),
                           Crypto-Binding TLV (Request),
                           Result TLV (Success)

  Intermediate-Result-TLV (Success),
  Crypto-Binding TLV (Response),
  Result-TLV (Success) -&gt;

  // Compound MAC calculated using keys generated from EAP
     methods X and Y and the TLS tunnel.  Compound keys are
     generated using keys generated from EAP methods X and Y
     and the TLS tunnel.

  // TLS channel torn down (messages sent in cleartext)

                          &lt;- EAP-Success
</pre><a href="#section-12.6-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="c7-failed-crypto-binding">
<section id="section-12.7">
        <h3 id="name-c7-failed-crypto-binding">
<a href="#name-c7-failed-crypto-binding" class="section-name selfRef">C.7.  Failed Crypto-Binding</a>
        </h3>
<p id="section-12.7-1">The following exchanges show a failed crypto-binding validation.  The
conversation will appear as follows:<a href="#section-12.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-12.7-2">
<pre>
  Authenticating Peer     Authenticator
  -------------------     -------------
                          &lt;- EAP-Request/
                          Identity
  EAP-Response/
  Identity (MyID1) -&gt;
                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TEAP Start, S bit set, Authority-ID)

  EAP-Response/
  EAP-Type=TEAP, V=1
  (TLS client_hello without
  PAC-Opaque in SessionTicket extension)-&gt;
                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TLS Server Key Exchange
                           TLS Server Hello Done)
  EAP-Response/
  EAP-Type=TEAP, V=1 -&gt;
  (TLS Client Key Exchange
   TLS change_cipher_spec,
   TLS finished)

                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TLS change_cipher_spec
                           TLS finished)
                           EAP-Payload-TLV[
                           EAP-Request/Identity])

     // TLS channel established
        (messages sent within the TLS channel)

     // First EAP Payload TLV is piggybacked to the TLS Finished as
        Application Data and protected by the TLS tunnel.

  EAP-Payload TLV/
  EAP Identity Response -&gt;

                         &lt;-  EAP Payload TLV, EAP-Request,
                             (EAP-MSCHAPV2, Challenge)

  EAP Payload TLV, EAP-Response,
  (EAP-MSCHAPV2, Response) -&gt;

                         &lt;-  EAP Payload TLV, EAP-Request,
                             (EAP-MSCHAPV2, Success Request)

  EAP Payload TLV, EAP-Response,
  (EAP-MSCHAPV2, Success Response) -&gt;

                       &lt;- Intermediate-Result-TLV (Success),
                           Crypto-Binding TLV (Request),
                              Result TLV (Success)

     Intermediate-Result-TLV (Success),
     Result TLV (Failure)
     Error TLV with
     (Error Code = 2001) -&gt;

  // TLS channel torn down
     (messages sent in cleartext)

                       &lt;- EAP-Failure
</pre><a href="#section-12.7-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="c8-sequence-of-eap-method-with-vendor-specific-tlv-exchange">
<section id="section-12.8">
        <h3 id="name-c8-sequence-of-eap-method-w">
<a href="#name-c8-sequence-of-eap-method-w" class="section-name selfRef">C.8.  Sequence of EAP Method with Vendor-Specific TLV Exchange</a>
        </h3>
<p id="section-12.8-1">When TEAP is negotiated with a sequence of EAP methods followed by a
Vendor-Specific TLV exchange, the conversation will occur as follows:<a href="#section-12.8-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-12.8-2">
<pre>
  Authenticating Peer     Authenticator
  -------------------     -------------
                          &lt;- EAP-Request/
                          Identity
  EAP-Response/
  Identity (MyID1) -&gt;
                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TEAP Start, S bit set, Authority-ID)

  EAP-Response/
  EAP-Type=TEAP, V=1
  (TLS client_hello)-&gt;
                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TLS server_hello,
                           TLS certificate,
                   [TLS server_key_exchange,]
                   [TLS certificate_request,]
                       TLS server_hello_done)

  EAP-Response/
  EAP-Type=TEAP, V=1
  ([TLS certificate,]
   TLS client_key_exchange,
  [TLS certificate_verify,]
   TLS change_cipher_spec,
   TLS finished) -&gt;
                         &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TLS change_cipher_spec,
                           TLS finished,
                          EAP-Payload-TLV[
                          EAP-Request/Identity])

  // TLS channel established
     (messages sent within the TLS channel)

  // First EAP Payload TLV is piggybacked to the TLS Finished as
     Application Data and protected by the TLS tunnel.

  EAP-Payload-TLV
  [EAP-Response/Identity] -&gt;

                        &lt;- EAP-Payload-TLV
                        [EAP-Request/EAP-Type=X]

  EAP-Payload-TLV
  [EAP-Response/EAP-Type=X] -&gt;

                         &lt;- EAP-Payload-TLV
                        [EAP-Request/EAP-Type=X]

  EAP-Payload-TLV
  [EAP-Response/EAP-Type=X]-&gt;

                          &lt;- Intermediate Result TLV (Success),
                           Crypto-Binding TLV (Request),
                           Vendor-Specific TLV,

  // Vendor-Specific TLV exchange started after successful
     completion of previous method X.  The Intermediate-Result
     and Crypto-Binding TLVs are sent with Vendor-Specific TLV
     in next packet to minimize round trips.

  // Compound MAC calculated using keys generated from
     EAP method X and the TLS tunnel.

  Intermediate Result TLV (Success),
  Crypto-Binding TLV (Response),
  Vendor-Specific TLV -&gt;

      // Optional additional Vendor-Specific TLV exchanges...

                         &lt;- Vendor-Specific TLV

  Vendor-Specific TLV -&gt;
                         &lt;- Result TLV (Success)

  Result-TLV (Success) -&gt;

  // TLS channel torn down (messages sent in cleartext)

                          &lt;- EAP-Success
</pre><a href="#section-12.8-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="c9-peer-requests-inner-method-after-server-sends-result-tlv">
<section id="section-12.9">
        <h3 id="name-c9-peer-requests-inner-meth">
<a href="#name-c9-peer-requests-inner-meth" class="section-name selfRef">C.9.  Peer Requests Inner Method after Server Sends Result TLV</a>
        </h3>
<p id="section-12.9-1">In the case where the peer is authenticated during Phase 1 and the
server sends back a Result TLV but the peer wants to request another
inner method, the conversation will appear as follows:<a href="#section-12.9-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-12.9-2">
<pre>
  Authenticating Peer    Authenticator
  -------------------    -------------
                         &lt;- EAP-Request/Identity
  EAP-Response/
  Identity (MyID1) -&gt;

  // Identity sent in the clear.  May be a hint to help route
     the authentication request to EAP server, instead of the
     full user identity.

                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TEAP Start, S bit set, Authority-ID)
  EAP-Response/
  EAP-Type=TEAP, V=1
  (TLS client_hello)-&gt;
                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TLS server_hello,
                           TLS certificate,
                          [TLS server_key_exchange,]
                          [TLS certificate_request,]
                           TLS server_hello_done)

  EAP-Response/
  EAP-Type=TEAP, V=1
  [TLS certificate,]
   TLS client_key_exchange,
  [TLS certificate_verify,]
   TLS change_cipher_spec,
   TLS finished -&gt;
                          &lt;- EAP-Request/
                          EAP-Type=TEAP, V=1
                          (TLS change_cipher_spec,
                           TLS finished,
                           Crypto-Binding TLV (Request),
                            Result TLV (Success))

  // TLS channel established
     (TLV Payload messages sent within the TLS channel)

   Crypto-Binding TLV(Response),
   Request-Action TLV
   (Status=Failure, Action=Negotiate-EAP)-&gt;

                        &lt;- EAP-Payload-TLV
                            [EAP-Request/Identity]

  EAP-Payload-TLV
  [EAP-Response/Identity] -&gt;

                        &lt;- EAP-Payload-TLV
                        [EAP-Request/EAP-Type=X]

  EAP-Payload-TLV
  [EAP-Response/EAP-Type=X] -&gt;

                         &lt;- EAP-Payload-TLV
                        [EAP-Request/EAP-Type=X]

  EAP-Payload-TLV
  [EAP-Response/EAP-Type=X]-&gt;

                          &lt;- Intermediate Result TLV (Success),
                             Crypto-Binding TLV (Request),
                             Result TLV (Success)

  Intermediate Result TLV (Success),
  Crypto-Binding TLV (Response),
  Result-TLV (Success)) -&gt;

  // TLS channel torn down
  (messages sent in cleartext)

                          &lt;- EAP-Success
</pre><a href="#section-12.9-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="c10-channel-binding">
<section id="section-12.10">
        <h3 id="name-c10-channel-binding">
<a href="#name-c10-channel-binding" class="section-name selfRef">C.10.  Channel Binding</a>
        </h3>
<p id="section-12.10-1">The following exchanges show a successful TEAP authentication with
basic password authentication and channel binding using a Request-
Action TLV.  The conversation will appear as follows:<a href="#section-12.10-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-12.10-2">
<pre>
   Authenticating Peer     Authenticator
   -------------------     -------------
                           &lt;- EAP-Request/
                           Identity
   EAP-Response/
   Identity (MyID1) -&gt;

                           &lt;- EAP-Request/
                           EAP-Type=TEAP, V=1
                           (TEAP Start, S bit set, Authority-ID)

   EAP-Response/
   EAP-Type=TEAP, V=1
   (TLS client_hello with
    PAC-Opaque in SessionTicket extension)-&gt;

                           &lt;- EAP-Request/
                           EAP-Type=TEAP, V=1
                           (TLS server_hello,
                           (TLS change_cipher_spec,
                            TLS finished)

   EAP-Response/
   EAP-Type=TEAP, V=1 -&gt;
   (TLS change_cipher_spec,
    TLS finished)

   TLS channel established
   (messages sent within the TLS channel)

                          &lt;- Basic-Password-Auth-Req TLV, Challenge

   Basic-Password-Auth-Resp TLV, Response with both
   username and password) -&gt;

   optional additional exchanges (new pin mode,
   password change, etc.) ...

                        &lt;- Crypto-Binding TLV (Request),
                            Result TLV (Success),

   Crypto-Binding TLV(Response),
   Request-Action TLV
   (Status=Failure, Action=Process-TLV,
   TLV=Channel-Binding TLV)-&gt;

                            &lt;- Channel-Binding TLV (Response),
                            Result TLV (Success),

   Result-TLV (Success) -&gt;

   TLS channel torn down
   (messages sent in cleartext)

                           &lt;- EAP-Success
</pre><a href="#section-12.10-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<section id="section-13">
      <h2 id="name-references">
<a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-13.1">
        <h3 id="name-normative-references">
<a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="BCP14">[BCP14]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3748">[RFC3748]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Blunk, L.</span>, <span class="refAuthor">Vollbrecht, J.</span>, <span class="refAuthor">Carlson, J.</span>, and <span class="refAuthor">H. Levkowetz, Ed.</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP)"</span>, <span class="seriesInfo">RFC 3748</span>, <span class="seriesInfo">DOI 10.17487/RFC3748</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3748">https://www.rfc-editor.org/rfc/rfc3748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5077">[RFC5077]</dt>
        <dd>
<span class="refAuthor">Salowey, J.</span>, <span class="refAuthor">Zhou, H.</span>, <span class="refAuthor">Eronen, P.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Transport Layer Security (TLS) Session Resumption without Server-Side State"</span>, <span class="seriesInfo">RFC 5077</span>, <span class="seriesInfo">DOI 10.17487/RFC5077</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5077">https://www.rfc-editor.org/rfc/rfc5077</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5226">[RFC5226]</dt>
        <dd>
<span class="refAuthor">Narten, T.</span> and <span class="refAuthor">H. Alvestrand</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">RFC 5226</span>, <span class="seriesInfo">DOI 10.17487/RFC5226</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5226">https://www.rfc-editor.org/rfc/rfc5226</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5246">[RFC5246]</dt>
        <dd>
<span class="refAuthor">Dierks, T.</span> and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.2"</span>, <span class="seriesInfo">RFC 5246</span>, <span class="seriesInfo">DOI 10.17487/RFC5246</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5246">https://www.rfc-editor.org/rfc/rfc5246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5295">[RFC5295]</dt>
        <dd>
<span class="refAuthor">Salowey, J.</span>, <span class="refAuthor">Dondeti, L.</span>, <span class="refAuthor">Narayanan, V.</span>, and <span class="refAuthor">M. Nakhjiri</span>, <span class="refTitle">"Specification for the Derivation of Root Keys from an Extended Master Session Key (EMSK)"</span>, <span class="seriesInfo">RFC 5295</span>, <span class="seriesInfo">DOI 10.17487/RFC5295</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5295">https://www.rfc-editor.org/rfc/rfc5295</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5705">[RFC5705]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"Keying Material Exporters for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 5705</span>, <span class="seriesInfo">DOI 10.17487/RFC5705</span>, <time datetime="2010-03" class="refDate">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5705">https://www.rfc-editor.org/rfc/rfc5705</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5746">[RFC5746]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Ray, M.</span>, <span class="refAuthor">Dispensa, S.</span>, and <span class="refAuthor">N. Oskov</span>, <span class="refTitle">"Transport Layer Security (TLS) Renegotiation Indication Extension"</span>, <span class="seriesInfo">RFC 5746</span>, <span class="seriesInfo">DOI 10.17487/RFC5746</span>, <time datetime="2010-02" class="refDate">February 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5746">https://www.rfc-editor.org/rfc/rfc5746</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5929">[RFC5929]</dt>
        <dd>
<span class="refAuthor">Altman, J.</span>, <span class="refAuthor">Williams, N.</span>, and <span class="refAuthor">L. Zhu</span>, <span class="refTitle">"Channel Bindings for TLS"</span>, <span class="seriesInfo">RFC 5929</span>, <span class="seriesInfo">DOI 10.17487/RFC5929</span>, <time datetime="2010-07" class="refDate">July 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5929">https://www.rfc-editor.org/rfc/rfc5929</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6677">[RFC6677]</dt>
        <dd>
<span class="refAuthor">Hartman, S., Ed.</span>, <span class="refAuthor">Clancy, T.</span>, and <span class="refAuthor">K. Hoeper</span>, <span class="refTitle">"Channel-Binding Support for Extensible Authentication Protocol (EAP) Methods"</span>, <span class="seriesInfo">RFC 6677</span>, <span class="seriesInfo">DOI 10.17487/RFC6677</span>, <time datetime="2012-07" class="refDate">July 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6677">https://www.rfc-editor.org/rfc/rfc6677</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7170">[RFC7170]</dt>
      <dd>
<span class="refAuthor">Zhou, H.</span>, <span class="refAuthor">Cam-Winget, N.</span>, <span class="refAuthor">Salowey, J.</span>, and <span class="refAuthor">S. Hanna</span>, <span class="refTitle">"Tunnel Extensible Authentication Protocol (TEAP) Version 1"</span>, <span class="seriesInfo">RFC 7170</span>, <span class="seriesInfo">DOI 10.17487/RFC7170</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7170">https://www.rfc-editor.org/rfc/rfc7170</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-13.2">
        <h3 id="name-informative-references">
<a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="IEEE.802-1X.2013">[IEEE.802-1X.2013]</dt>
        <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"Local and Metropolitan Area Networks: Port-Based Network Access Control"</span>, <time datetime="2017-12" class="refDate">December 2017</time>. </dd>
<dd class="break"></dd>
<dt id="KAMATH">[KAMATH]</dt>
        <dd>
<span class="refAuthor">Palekar, R. H. and A.</span>, <span class="refTitle">"Microsoft EAP CHAP Extensions"</span>, <time datetime="2007-06" class="refDate">June 2007</time>. </dd>
<dd class="break"></dd>
<dt id="MSCHAP">[MSCHAP]</dt>
        <dd>
<span class="refAuthor">Corporation, M.</span>, <span class="refTitle">"Master Session Key (MSK) Derivation"</span>, <span>n.d.</span>, <span>&lt;<a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-chap/5a860bf5-2aeb-485b-82ee-fac1e8e6b76f">https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-chap/5a860bf5-2aeb-485b-82ee-fac1e8e6b76f</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-SP-800-57">[NIST-SP-800-57]</dt>
        <dd>
<span class="refAuthor">Technology, N. I. of S. and.</span>, <span class="refTitle">"Recommendation for Key Management"</span>, <time datetime="2012-07" class="refDate">July 2012</time>. </dd>
<dd class="break"></dd>
<dt id="PEAP">[PEAP]</dt>
        <dd>
<span class="refAuthor">Corporation, M.</span>, <span class="refTitle">"[MS-PEAP]: Protected Extensible Authentication Protocol (PEAP)"</span>, <time datetime="2014-02" class="refDate">February 2014</time>. </dd>
<dd class="break"></dd>
<dt id="RFC2315">[RFC2315]</dt>
        <dd>
<span class="refAuthor">Kaliski, B.</span>, <span class="refTitle">"PKCS #7: Cryptographic Message Syntax Version 1.5"</span>, <span class="seriesInfo">RFC 2315</span>, <span class="seriesInfo">DOI 10.17487/RFC2315</span>, <time datetime="1998-03" class="refDate">March 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2315">https://www.rfc-editor.org/rfc/rfc2315</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2985">[RFC2985]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #9: Selected Object Classes and Attribute Types Version 2.0"</span>, <span class="seriesInfo">RFC 2985</span>, <span class="seriesInfo">DOI 10.17487/RFC2985</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2985">https://www.rfc-editor.org/rfc/rfc2985</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2986">[RFC2986]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2986">https://www.rfc-editor.org/rfc/rfc2986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3579">[RFC3579]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span> and <span class="refAuthor">P. Calhoun</span>, <span class="refTitle">"RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP)"</span>, <span class="seriesInfo">RFC 3579</span>, <span class="seriesInfo">DOI 10.17487/RFC3579</span>, <time datetime="2003-09" class="refDate">September 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3579">https://www.rfc-editor.org/rfc/rfc3579</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time datetime="2003-11" class="refDate">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3629">https://www.rfc-editor.org/rfc/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3766">[RFC3766]</dt>
        <dd>
<span class="refAuthor">Orman, H.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Determining Strengths For Public Keys Used For Exchanging Symmetric Keys"</span>, <span class="seriesInfo">BCP 86</span>, <span class="seriesInfo">RFC 3766</span>, <span class="seriesInfo">DOI 10.17487/RFC3766</span>, <time datetime="2004-04" class="refDate">April 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3766">https://www.rfc-editor.org/rfc/rfc3766</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4017">[RFC4017]</dt>
        <dd>
<span class="refAuthor">Stanley, D.</span>, <span class="refAuthor">Walker, J.</span>, and <span class="refAuthor">B. Aboba</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs"</span>, <span class="seriesInfo">RFC 4017</span>, <span class="seriesInfo">DOI 10.17487/RFC4017</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4017">https://www.rfc-editor.org/rfc/rfc4017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4072">[RFC4072]</dt>
        <dd>
<span class="refAuthor">Eronen, P., Ed.</span>, <span class="refAuthor">Hiller, T.</span>, and <span class="refAuthor">G. Zorn</span>, <span class="refTitle">"Diameter Extensible Authentication Protocol (EAP) Application"</span>, <span class="seriesInfo">RFC 4072</span>, <span class="seriesInfo">DOI 10.17487/RFC4072</span>, <time datetime="2005-08" class="refDate">August 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4072">https://www.rfc-editor.org/rfc/rfc4072</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4086">https://www.rfc-editor.org/rfc/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4282">[RFC4282]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Beadles, M.</span>, <span class="refAuthor">Arkko, J.</span>, and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"The Network Access Identifier"</span>, <span class="seriesInfo">RFC 4282</span>, <span class="seriesInfo">DOI 10.17487/RFC4282</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4282">https://www.rfc-editor.org/rfc/rfc4282</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4851">[RFC4851]</dt>
        <dd>
<span class="refAuthor">Cam-Winget, N.</span>, <span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Salowey, J.</span>, and <span class="refAuthor">H. Zhou</span>, <span class="refTitle">"The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST)"</span>, <span class="seriesInfo">RFC 4851</span>, <span class="seriesInfo">DOI 10.17487/RFC4851</span>, <time datetime="2007-05" class="refDate">May 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4851">https://www.rfc-editor.org/rfc/rfc4851</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4945">[RFC4945]</dt>
        <dd>
<span class="refAuthor">Korver, B.</span>, <span class="refTitle">"The Internet IP Security PKI Profile of IKEv1/ISAKMP, IKEv2, and PKIX"</span>, <span class="seriesInfo">RFC 4945</span>, <span class="seriesInfo">DOI 10.17487/RFC4945</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4945">https://www.rfc-editor.org/rfc/rfc4945</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4962">[RFC4962]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span> and <span class="refAuthor">B. Aboba</span>, <span class="refTitle">"Guidance for Authentication, Authorization, and Accounting (AAA) Key Management"</span>, <span class="seriesInfo">BCP 132</span>, <span class="seriesInfo">RFC 4962</span>, <span class="seriesInfo">DOI 10.17487/RFC4962</span>, <time datetime="2007-07" class="refDate">July 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4962">https://www.rfc-editor.org/rfc/rfc4962</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5247">[RFC5247]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Simon, D.</span>, and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP) Key Management Framework"</span>, <span class="seriesInfo">RFC 5247</span>, <span class="seriesInfo">DOI 10.17487/RFC5247</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5247">https://www.rfc-editor.org/rfc/rfc5247</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5272">[RFC5272]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">M. Myers</span>, <span class="refTitle">"Certificate Management over CMS (CMC)"</span>, <span class="seriesInfo">RFC 5272</span>, <span class="seriesInfo">DOI 10.17487/RFC5272</span>, <time datetime="2008-06" class="refDate">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5272">https://www.rfc-editor.org/rfc/rfc5272</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5281">[RFC5281]</dt>
        <dd>
<span class="refAuthor">Funk, P.</span> and <span class="refAuthor">S. Blake-Wilson</span>, <span class="refTitle">"Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0)"</span>, <span class="seriesInfo">RFC 5281</span>, <span class="seriesInfo">DOI 10.17487/RFC5281</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5281">https://www.rfc-editor.org/rfc/rfc5281</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5421">[RFC5421]</dt>
        <dd>
<span class="refAuthor">Cam-Winget, N.</span> and <span class="refAuthor">H. Zhou</span>, <span class="refTitle">"Basic Password Exchange within the Flexible Authentication via Secure Tunneling Extensible Authentication Protocol (EAP-FAST)"</span>, <span class="seriesInfo">RFC 5421</span>, <span class="seriesInfo">DOI 10.17487/RFC5421</span>, <time datetime="2009-03" class="refDate">March 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5421">https://www.rfc-editor.org/rfc/rfc5421</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5422">[RFC5422]</dt>
        <dd>
<span class="refAuthor">Cam-Winget, N.</span>, <span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Salowey, J.</span>, and <span class="refAuthor">H. Zhou</span>, <span class="refTitle">"Dynamic Provisioning Using Flexible Authentication via Secure Tunneling Extensible Authentication Protocol (EAP-FAST)"</span>, <span class="seriesInfo">RFC 5422</span>, <span class="seriesInfo">DOI 10.17487/RFC5422</span>, <time datetime="2009-03" class="refDate">March 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5422">https://www.rfc-editor.org/rfc/rfc5422</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5652">[RFC5652]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">STD 70</span>, <span class="seriesInfo">RFC 5652</span>, <span class="seriesInfo">DOI 10.17487/RFC5652</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5652">https://www.rfc-editor.org/rfc/rfc5652</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5931">[RFC5931]</dt>
        <dd>
<span class="refAuthor">Harkins, D.</span> and <span class="refAuthor">G. Zorn</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP) Authentication Using Only a Password"</span>, <span class="seriesInfo">RFC 5931</span>, <span class="seriesInfo">DOI 10.17487/RFC5931</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5931">https://www.rfc-editor.org/rfc/rfc5931</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6066">[RFC6066]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Transport Layer Security (TLS) Extensions: Extension Definitions"</span>, <span class="seriesInfo">RFC 6066</span>, <span class="seriesInfo">DOI 10.17487/RFC6066</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6066">https://www.rfc-editor.org/rfc/rfc6066</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6124">[RFC6124]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Zorn, G.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">S. Fluhrer</span>, <span class="refTitle">"An EAP Authentication Method Based on the Encrypted Key Exchange (EKE) Protocol"</span>, <span class="seriesInfo">RFC 6124</span>, <span class="seriesInfo">DOI 10.17487/RFC6124</span>, <time datetime="2011-02" class="refDate">February 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6124">https://www.rfc-editor.org/rfc/rfc6124</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6678">[RFC6678]</dt>
        <dd>
<span class="refAuthor">Hoeper, K.</span>, <span class="refAuthor">Hanna, S.</span>, <span class="refAuthor">Zhou, H.</span>, and <span class="refAuthor">J. Salowey, Ed.</span>, <span class="refTitle">"Requirements for a Tunnel-Based Extensible Authentication Protocol (EAP) Method"</span>, <span class="seriesInfo">RFC 6678</span>, <span class="seriesInfo">DOI 10.17487/RFC6678</span>, <time datetime="2012-07" class="refDate">July 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6678">https://www.rfc-editor.org/rfc/rfc6678</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6960">[RFC6960]</dt>
        <dd>
<span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Myers, M.</span>, <span class="refAuthor">Ankney, R.</span>, <span class="refAuthor">Malpani, A.</span>, <span class="refAuthor">Galperin, S.</span>, and <span class="refAuthor">C. Adams</span>, <span class="refTitle">"X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP"</span>, <span class="seriesInfo">RFC 6960</span>, <span class="seriesInfo">DOI 10.17487/RFC6960</span>, <time datetime="2013-06" class="refDate">June 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6960">https://www.rfc-editor.org/rfc/rfc6960</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6961">[RFC6961]</dt>
        <dd>
<span class="refAuthor">Pettersen, Y.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Multiple Certificate Status Request Extension"</span>, <span class="seriesInfo">RFC 6961</span>, <span class="seriesInfo">DOI 10.17487/RFC6961</span>, <time datetime="2013-06" class="refDate">June 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6961">https://www.rfc-editor.org/rfc/rfc6961</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7029">[RFC7029]</dt>
        <dd>
<span class="refAuthor">Hartman, S.</span>, <span class="refAuthor">Wasserman, M.</span>, and <span class="refAuthor">D. Zhang</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP) Mutual Cryptographic Binding"</span>, <span class="seriesInfo">RFC 7029</span>, <span class="seriesInfo">DOI 10.17487/RFC7029</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7029">https://www.rfc-editor.org/rfc/rfc7029</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7030">[RFC7030]</dt>
        <dd>
<span class="refAuthor">Pritikin, M., Ed.</span>, <span class="refAuthor">Yee, P., Ed.</span>, and <span class="refAuthor">D. Harkins, Ed.</span>, <span class="refTitle">"Enrollment over Secure Transport"</span>, <span class="seriesInfo">RFC 7030</span>, <span class="seriesInfo">DOI 10.17487/RFC7030</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7030">https://www.rfc-editor.org/rfc/rfc7030</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.690">[X.690]</dt>
      <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"SN.1 encoding rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <time datetime="2008-11" class="refDate">November 2008</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Alan DeKok</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:aland@freeradius.org" class="email">aland@freeradius.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hao Zhou</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hzhou@cisco.com" class="email">hzhou@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Joseph Salowey</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:joe@salowey.net" class="email">joe@salowey.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Nancy Cam-Winget</span></div>
<div dir="auto" class="left"><span class="org">Cisco</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ncamwing@cisco.com" class="email">ncamwing@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Stephen Hanna</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:steve.hanna@infineon.com" class="email">steve.hanna@infineon.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
